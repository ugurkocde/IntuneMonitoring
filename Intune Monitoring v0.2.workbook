{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Org",
        "loadType": "always",
        "items": [
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/beta/organization\",\"urlParams\":[{\"key\":\"$select\",\"value\":\"displayName\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[]}}]}",
              "size": 4,
              "queryType": 14,
              "visualization": "card",
              "textSettings": {
                "style": "header"
              }
            },
            "name": "query - 2"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "64f42491-d240-4a6f-bb2d-8bc4e585c486",
                  "version": "KqlParameterItem/1.0",
                  "name": "paramOrg",
                  "label": "Organization",
                  "type": 1,
                  "isRequired": true,
                  "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/beta/organization\",\"urlParams\":[{\"key\":\"$select\",\"value\":\"displayName\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[]}}]}",
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "queryType": 14
                }
              ],
              "style": "pills",
              "queryType": 14
            },
            "name": "parametersOrg"
          }
        ],
        "exportParameters": true
      },
      "conditionalVisibility": {
        "parameterName": "hide",
        "comparison": "isEqualTo",
        "value": "hide"
      },
      "name": "groupOrg"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "expandable": true,
        "expanded": true,
        "loadType": "always",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "<div style=\"display: flex; justify-content: space-between; align-items: center;\">\r\n  <div style=\"display: flex; align-items: center;\">\r\n    <img src=\"https://adoption.microsoft.com/wp-content/uploads/2025/04/icon-intune.svg\" style=\"height: 42px; margin-right: 10px;\" />\r\n    <span style=\"font-size: 64px;\">Intune Monitoring</span>\r\n    <span style=\"font-size: 20px; color: #888; margin-left: 10px;\"> v0.2 </span>\r\n  </div>\r\n  <img src=\"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSBDXy-6OYK_mlwlHPP9yO1KzCsv7rDCgqAAA&s\" style=\"height: 40px;\" />\r\n</div>\r\n\r\n<p style=\"margin-top: -10px; font-size: 14px; color: #555;\">\r\n  Created by \r\n  <a href=\"https://www.linkedin.com/in/daniel-rung/\" target=\"_blank\" style=\"color: #0078d4; text-decoration: none;\">Daniel</a> and \r\n  <a href=\"https://www.linkedin.com/in/ugurkocde/\" target=\"_blank\" style=\"color: #0078d4; text-decoration: none;\">Ugur</a>\r\n</p>\r\n\r\n### **üß© Connected Tenant:** `{paramOrg}`  \r\n\r\n---\r\n\r\n### üîç Changelog ‚Äì [Check the latest release](https://github.com/ugurkocde/IntuneMonitoring/releases)\r\n\r\n### üìÑ Source Code is available on [GitHub](https://github.com/ugurkocde/IntuneMonitoring)\r\n\r\n### üí¨ Feedback or Issues? [Open on GitHub](https://github.com/ugurkocde/IntuneMonitoring)\r\n"
            },
            "name": "Version",
            "styleSettings": {
              "padding": "10px"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "You can Refresh the Dashboard by clicking on the \"Refresh Icon\" on the top of the Dashboard",
              "style": "info"
            },
            "name": "text - 1"
          }
        ]
      },
      "name": "Header"
    },
    {
      "type": 11,
      "content": {
        "version": "LinkItem/1.0",
        "style": "tabs",
        "tabStyle": "bigger",
        "links": [
          {
            "id": "c21cd99e-8ac1-422f-9acb-e84ad84e7669",
            "cellValue": "tab",
            "linkTarget": "parameter",
            "linkLabel": "Overview",
            "subTarget": "Overview",
            "style": "link"
          },
          {
            "id": "499856a9-ce15-4541-b9e6-cfed22bfe4a1",
            "cellValue": "tab",
            "linkTarget": "parameter",
            "linkLabel": "Device Activities",
            "subTarget": "Devices",
            "style": "link"
          },
          {
            "id": "ac376a0d-a60b-4c88-9ec2-10155a21475e",
            "cellValue": "tab",
            "linkTarget": "parameter",
            "linkLabel": "Compliance & Security",
            "subTarget": "Compliance",
            "style": "link"
          },
          {
            "id": "4bc4cea3-4eb4-497c-8e4c-cd5db72087a1",
            "cellValue": "tab",
            "linkTarget": "parameter",
            "linkLabel": "Application- & Patchmanagement",
            "subTarget": "Application",
            "style": "link"
          },
          {
            "id": "3a67b714-d080-4cea-92ce-afe113108915",
            "cellValue": "tab",
            "linkTarget": "parameter",
            "linkLabel": "User Enrollment & Deployment",
            "subTarget": "Enrollment",
            "style": "link"
          },
          {
            "id": "45d29d6a-99f4-4166-9878-5b92f1bfd1dc",
            "cellValue": "tab",
            "linkTarget": "parameter",
            "linkLabel": "Policies",
            "subTarget": "Policies",
            "style": "link"
          },
          {
            "id": "b905e6ce-44b0-4b04-ba52-bf04e0e0d0fd",
            "cellValue": "tab",
            "linkTarget": "parameter",
            "linkLabel": "Audit",
            "subTarget": "Audit",
            "style": "link"
          },
          {
            "id": "7f8d5e9a-3c2b-4a1f-9d8e-6f5a4b3c2d1e",
            "cellValue": "tab",
            "linkTarget": "parameter",
            "linkLabel": "Browser Extensions",
            "subTarget": "BrowserExtensions",
            "style": "link"
          }
        ]
      },
      "name": "MainTabs"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "5b796597-205c-4b14-9a7c-d9a88ec6eeae",
                  "version": "KqlParameterItem/1.0",
                  "name": "OverviewLast24h",
                  "label": "Time Span",
                  "type": 4,
                  "isRequired": true,
                  "isHiddenWhenLocked": true,
                  "typeSettings": {
                    "selectableValues": [
                      {
                        "durationMs": 86400000
                      }
                    ],
                    "allowCustom": false
                  },
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "value": {
                    "durationMs": 86400000
                  }
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "name": "deviceParameters"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$count\",\"value\":\"true\"},{\"key\":\"$top\",\"value\":\"0\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"\",\"columns\":[{\"path\":\"$..['@odata.count']\",\"columnid\":\"Count\",\"columnType\":\"long\"}]}}]}",
                    "size": 4,
                    "title": "Managed Intune Devices",
                    "exportToExcelOptions": "all",
                    "queryType": 14,
                    "visualization": "stat",
                    "sortBy": [],
                    "tileSettings": {
                      "titleContent": {},
                      "leftContent": {
                        "columnMatch": "JailBrokenCount",
                        "formatter": 8,
                        "formatOptions": {
                          "min": 0,
                          "max": 1,
                          "palette": "red",
                          "linkTarget": "GenericDetails",
                          "linkIsContextBlade": true
                        }
                      },
                      "showBorder": true,
                      "size": "auto",
                      "styleSettings": {
                        "borderStyle": "rounded"
                      }
                    },
                    "statSettings": {
                      "valueAggregation": "None",
                      "colorSettings": {
                        "type": "static",
                        "mode": "foreground",
                        "heatmapPalette": "greenRed",
                        "heatmapMin": 0,
                        "heatmapMax": 1,
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": ">=",
                            "thresholdValue": "0",
                            "representation": "Lateral_Movement"
                          }
                        ]
                      },
                      "tagText": "",
                      "valueFontStyle": "auto",
                      "valueTooltipSettings": {
                        "tooltip": "The number of devices currently in intune of all Platform types."
                      },
                      "linkSettings": {
                        "linkTarget": "GenericDetails",
                        "linkIsContextBlade": true
                      }
                    }
                  },
                  "customWidth": "0",
                  "showPin": false,
                  "name": "ManagedDevices",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"lastSyncDateTime ge {OverviewLast24h:startISO} and lastSyncDateTime le {OverviewLast24h:endISO}\"},{\"key\":\"$count\",\"value\":\"true\"},{\"key\":\"$top\",\"value\":\"0\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"\",\"columns\":[{\"path\":\"$..['@odata.count']\",\"columnid\":\"Count\",\"columnType\":\"long\"}]}}]}",
                    "size": 4,
                    "title": "Active Devices < 24h",
                    "exportToExcelOptions": "all",
                    "queryType": 14,
                    "visualization": "stat",
                    "sortBy": [],
                    "tileSettings": {
                      "titleContent": {},
                      "leftContent": {
                        "columnMatch": "JailBrokenCount",
                        "formatter": 8,
                        "formatOptions": {
                          "min": 0,
                          "max": 1,
                          "palette": "red",
                          "linkTarget": "GenericDetails",
                          "linkIsContextBlade": true
                        }
                      },
                      "showBorder": true,
                      "size": "auto",
                      "styleSettings": {
                        "borderStyle": "rounded"
                      }
                    },
                    "statSettings": {
                      "valueAggregation": "None",
                      "colorSettings": {
                        "type": "static",
                        "mode": "foreground",
                        "heatmapPalette": "greenRed",
                        "heatmapMin": 0,
                        "heatmapMax": 1,
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": ">=",
                            "thresholdValue": "0",
                            "representation": "Discovery"
                          }
                        ]
                      },
                      "tagText": "",
                      "valueFontStyle": "auto",
                      "valueTooltipSettings": {
                        "tooltip": "The number of devices contacted Intune in the last 24 hours."
                      },
                      "linkSettings": {
                        "linkTarget": "GenericDetails",
                        "linkIsContextBlade": true
                      }
                    }
                  },
                  "customWidth": "0",
                  "showPin": false,
                  "name": "ActiveDevices24h",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"ownerType eq 'company'\"},{\"key\":\"$count\",\"value\":\"true\"},{\"key\":\"$top\",\"value\":\"0\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"\",\"columns\":[{\"path\":\"$..['@odata.count']\",\"columnid\":\"Count\",\"columnType\":\"long\"}]}}]}",
                    "size": 4,
                    "title": "Company Owned Devices",
                    "exportToExcelOptions": "all",
                    "queryType": 14,
                    "visualization": "stat",
                    "sortBy": [],
                    "tileSettings": {
                      "titleContent": {},
                      "leftContent": {
                        "columnMatch": "JailBrokenCount",
                        "formatter": 8,
                        "formatOptions": {
                          "min": 0,
                          "max": 1,
                          "palette": "red",
                          "linkTarget": "GenericDetails",
                          "linkIsContextBlade": true
                        }
                      },
                      "showBorder": true,
                      "size": "auto",
                      "styleSettings": {
                        "borderStyle": "rounded"
                      }
                    },
                    "statSettings": {
                      "valueAggregation": "None",
                      "colorSettings": {
                        "type": "static",
                        "mode": "foreground",
                        "heatmapPalette": "greenRed",
                        "heatmapMin": 0,
                        "heatmapMax": 1,
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": ">=",
                            "thresholdValue": "0",
                            "representation": "Lock"
                          }
                        ]
                      },
                      "tagText": "",
                      "valueFontStyle": "auto",
                      "valueTooltipSettings": {
                        "tooltip": "The number of devices in Intune Company-owned."
                      },
                      "linkSettings": {
                        "linkTarget": "GenericDetails",
                        "linkIsContextBlade": true
                      }
                    }
                  },
                  "customWidth": "0",
                  "showPin": false,
                  "name": "Company-owned Devices",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"ownerType eq 'personal'\"},{\"key\":\"$count\",\"value\":\"true\"},{\"key\":\"$top\",\"value\":\"0\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"\",\"columns\":[{\"path\":\"$..['@odata.count']\",\"columnid\":\"Count\",\"columnType\":\"long\"}]}}]}",
                    "size": 4,
                    "title": "Personally-owned Devices",
                    "exportToExcelOptions": "all",
                    "queryType": 14,
                    "visualization": "stat",
                    "sortBy": [],
                    "tileSettings": {
                      "titleContent": {},
                      "leftContent": {
                        "columnMatch": "JailBrokenCount",
                        "formatter": 8,
                        "formatOptions": {
                          "min": 0,
                          "max": 1,
                          "palette": "red",
                          "linkTarget": "GenericDetails",
                          "linkIsContextBlade": true
                        }
                      },
                      "showBorder": true,
                      "size": "auto",
                      "styleSettings": {
                        "borderStyle": "rounded"
                      }
                    },
                    "statSettings": {
                      "valueAggregation": "None",
                      "colorSettings": {
                        "type": "static",
                        "mode": "foreground",
                        "heatmapPalette": "greenRed",
                        "heatmapMin": 0,
                        "heatmapMax": 1,
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": ">=",
                            "thresholdValue": "0",
                            "representation": "Person"
                          }
                        ]
                      },
                      "tagText": "",
                      "valueFontStyle": "auto",
                      "valueTooltipSettings": {
                        "tooltip": "The number of devices in Intune Personally-owned."
                      },
                      "linkSettings": {
                        "linkTarget": "GenericDetails",
                        "linkIsContextBlade": true
                      }
                    }
                  },
                  "customWidth": "0",
                  "showPin": false,
                  "name": "Personally-owned Devices",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"jailBroken eq 'true'\"},{\"key\":\"$count\",\"value\":\"true\"},{\"key\":\"$top\",\"value\":\"0\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"\",\"columns\":[{\"path\":\"$..['@odata.count']\",\"columnid\":\"Count\",\"columnType\":\"long\"}]}}]}",
                    "size": 4,
                    "title": "Jailbroken Devices ",
                    "exportToExcelOptions": "all",
                    "queryType": 14,
                    "visualization": "stat",
                    "sortBy": [],
                    "tileSettings": {
                      "titleContent": {},
                      "leftContent": {
                        "columnMatch": "JailBrokenCount",
                        "formatter": 8,
                        "formatOptions": {
                          "min": 0,
                          "max": 1,
                          "palette": "red",
                          "linkTarget": "GenericDetails",
                          "linkIsContextBlade": true
                        }
                      },
                      "showBorder": true,
                      "size": "auto",
                      "styleSettings": {
                        "borderStyle": "rounded"
                      }
                    },
                    "statSettings": {
                      "valueAggregation": "None",
                      "colorSettings": {
                        "type": "heatmap",
                        "mode": "foreground",
                        "heatmapPalette": "greenRed",
                        "heatmapMin": 0,
                        "heatmapMax": 1,
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": "==",
                            "thresholdValue": "0",
                            "representation": "success"
                          },
                          {
                            "operator": ">",
                            "thresholdValue": "0",
                            "representation": "4"
                          }
                        ]
                      },
                      "tagText": "",
                      "valueFontStyle": "auto",
                      "valueTooltipSettings": {
                        "tooltip": "The number of devices currently in intune flagged with JailBroken"
                      },
                      "linkSettings": {
                        "linkTarget": "GenericDetails",
                        "linkIsContextBlade": true
                      }
                    }
                  },
                  "customWidth": "0",
                  "showPin": false,
                  "name": "JailBrokenDevices ",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"complianceState eq 'noncompliant' and complianceGracePeriodExpirationDateTime ge {OverviewLast24h:startISO}\"},{\"key\":\"$top\",\"value\":\"999\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"\",\"columns\":[{\"path\":\"$..['@odata.count']\",\"columnid\":\"Count\",\"columnType\":\"long\"}]}}]}",
                    "size": 4,
                    "title": "Noncompliant Devices < 24h",
                    "exportToExcelOptions": "all",
                    "queryType": 14,
                    "visualization": "stat",
                    "sortBy": [],
                    "tileSettings": {
                      "titleContent": {},
                      "leftContent": {
                        "columnMatch": "JailBrokenCount",
                        "formatter": 8,
                        "formatOptions": {
                          "min": 0,
                          "max": 1,
                          "palette": "red",
                          "linkTarget": "GenericDetails",
                          "linkIsContextBlade": true
                        }
                      },
                      "showBorder": true,
                      "size": "auto",
                      "styleSettings": {
                        "borderStyle": "rounded"
                      }
                    },
                    "statSettings": {
                      "valueAggregation": "None",
                      "colorSettings": {
                        "type": "heatmap",
                        "mode": "foreground",
                        "heatmapPalette": "greenRed",
                        "heatmapMin": 0,
                        "heatmapMax": 1,
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": "==",
                            "thresholdValue": "0",
                            "representation": "success"
                          },
                          {
                            "operator": ">",
                            "thresholdValue": "0",
                            "representation": "2"
                          }
                        ]
                      },
                      "tagText": "",
                      "valueFontStyle": "auto",
                      "valueTooltipSettings": {
                        "tooltip": "The number of devices got in the last 24 hours non Compliant."
                      },
                      "linkSettings": {
                        "linkTarget": "GenericDetails",
                        "linkIsContextBlade": true
                      }
                    }
                  },
                  "customWidth": "0",
                  "showPin": false,
                  "name": "NonCompliantDevicesLast",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                }
              ]
            },
            "name": "groupOverviewStats"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"operatingSystem eq 'Windows'\"},{\"key\":\"$select\",\"value\":\"operatingSystem\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"\",\"columns\":[{\"path\":\"$['@odata.count']\",\"columnid\":\"Total\",\"columnType\":\"long\"},{\"path\":\"$.value[0].operatingSystem\",\"columnid\":\"Operating_System\",\"columnType\":\"string\",\"substringRegexMatch\":\".*\",\"substringReplace\":\"Windows\"}]}}]}",
                          "size": 4,
                          "title": "Windows",
                          "queryType": 14,
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Total",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20px"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": true
                                  }
                                }
                              },
                              {
                                "columnMatch": "Operating_System",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20px"
                                }
                              },
                              {
                                "columnMatch": "managementAgent",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Compliance_State",
                                "formatter": 5
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Operating_System",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Total",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": false
                          },
                          "statSettings": {
                            "valueField": "Total",
                            "valueAggregation": "None",
                            "colorSettings": {
                              "type": "static",
                              "mode": "background",
                              "heatmapPalette": "greenRed",
                              "thresholdsGrid": []
                            },
                            "iconSettings": {
                              "thresholdsGrid": [
                                {
                                  "sourceColumn": "Total",
                                  "operator": ">",
                                  "thresholdValue": "0",
                                  "representation": "AddTile"
                                },
                                {
                                  "sourceColumn": "Total",
                                  "operator": "==",
                                  "thresholdValue": "0",
                                  "representation": "unknown"
                                }
                              ]
                            },
                            "tagText": "",
                            "valueFontStyle": "auto"
                          }
                        },
                        "customWidth": "10",
                        "conditionalVisibility": {
                          "parameterName": "hide",
                          "comparison": "isEqualTo",
                          "value": "hide"
                        },
                        "showPin": false,
                        "name": "queryWindowsDevices",
                        "styleSettings": {
                          "margin": "2px",
                          "padding": "2px",
                          "maxWidth": "10"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"operatingSystem eq 'macOS'\"},{\"key\":\"$select\",\"value\":\"operatingSystem\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"\",\"columns\":[{\"path\":\"$['@odata.count']\",\"columnid\":\"Total\",\"columnType\":\"long\"},{\"path\":\"$.value[0].operatingSystem\",\"columnid\":\"Operating_System\",\"columnType\":\"string\",\"substringRegexMatch\":\".*\",\"substringReplace\":\"MacOS\"}]}}]}",
                          "size": 4,
                          "title": "MacOS",
                          "queryType": 14,
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Total",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20px"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": true
                                  }
                                }
                              },
                              {
                                "columnMatch": "Operating_System",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20px"
                                }
                              },
                              {
                                "columnMatch": "managementAgent",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Compliance_State",
                                "formatter": 5
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Operating_System",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Total",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": false
                          },
                          "statSettings": {
                            "valueField": "Total",
                            "valueAggregation": "None",
                            "colorSettings": {
                              "type": "static",
                              "mode": "background",
                              "heatmapPalette": "greenRed",
                              "thresholdsGrid": []
                            },
                            "iconSettings": {
                              "thresholdsGrid": [
                                {
                                  "sourceColumn": "Total",
                                  "operator": ">",
                                  "thresholdValue": "0",
                                  "representation": "AddTile"
                                },
                                {
                                  "sourceColumn": "Total",
                                  "operator": "==",
                                  "thresholdValue": "0",
                                  "representation": "unknown"
                                }
                              ]
                            },
                            "tagText": "",
                            "valueFontStyle": "auto"
                          }
                        },
                        "customWidth": "10",
                        "conditionalVisibility": {
                          "parameterName": "hide",
                          "comparison": "isEqualTo",
                          "value": "hide"
                        },
                        "name": "queryMacOSDevices",
                        "styleSettings": {
                          "margin": "2px",
                          "padding": "2px",
                          "maxWidth": "10"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"operatingSystem eq 'iOS'\"},{\"key\":\"$select\",\"value\":\"operatingSystem\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"\",\"columns\":[{\"path\":\"$['@odata.count']\",\"columnid\":\"Total\",\"columnType\":\"long\"},{\"path\":\"$.value[0].operatingSystem\",\"columnid\":\"Operating_System\",\"columnType\":\"string\",\"substringRegexMatch\":\".*\",\"substringReplace\":\"iOS\"}]}}]}",
                          "size": 4,
                          "title": "iOS",
                          "queryType": 14,
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Total",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20px"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": true
                                  }
                                }
                              },
                              {
                                "columnMatch": "Operating_System",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20px"
                                }
                              },
                              {
                                "columnMatch": "managementAgent",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Compliance_State",
                                "formatter": 5
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Operating_System",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Total",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": false
                          },
                          "statSettings": {
                            "valueField": "Total",
                            "valueAggregation": "None",
                            "colorSettings": {
                              "type": "static",
                              "mode": "background",
                              "heatmapPalette": "greenRed",
                              "thresholdsGrid": []
                            },
                            "iconSettings": {
                              "thresholdsGrid": [
                                {
                                  "sourceColumn": "Total",
                                  "operator": ">",
                                  "thresholdValue": "0",
                                  "representation": "AddTile"
                                },
                                {
                                  "sourceColumn": "Total",
                                  "operator": "==",
                                  "thresholdValue": "0",
                                  "representation": "unknown"
                                }
                              ]
                            },
                            "tagText": "",
                            "valueFontStyle": "auto"
                          }
                        },
                        "customWidth": "10",
                        "conditionalVisibility": {
                          "parameterName": "hide",
                          "comparison": "isEqualTo",
                          "value": "hide"
                        },
                        "name": "queryiOSDevices",
                        "styleSettings": {
                          "margin": "2px",
                          "padding": "2px",
                          "maxWidth": "10"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"operatingSystem eq 'Android'\"},{\"key\":\"$select\",\"value\":\"operatingSystem\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"\",\"columns\":[{\"path\":\"$['@odata.count']\",\"columnid\":\"Total\",\"columnType\":\"long\"},{\"path\":\"$.value[0].operatingSystem\",\"columnid\":\"Operating_System\",\"columnType\":\"string\",\"substringRegexMatch\":\".*\",\"substringReplace\":\"Android\"}]}}]}",
                          "size": 4,
                          "title": "Android",
                          "queryType": 14,
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Total",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20px"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": true
                                  }
                                }
                              },
                              {
                                "columnMatch": "Operating_System",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20px"
                                }
                              },
                              {
                                "columnMatch": "managementAgent",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Compliance_State",
                                "formatter": 5
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Operating_System",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Total",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": false
                          },
                          "statSettings": {
                            "valueField": "Total",
                            "valueAggregation": "None",
                            "colorSettings": {
                              "type": "static",
                              "mode": "background",
                              "heatmapPalette": "greenRed",
                              "thresholdsGrid": []
                            },
                            "iconSettings": {
                              "thresholdsGrid": [
                                {
                                  "sourceColumn": "Total",
                                  "operator": ">",
                                  "thresholdValue": "0",
                                  "representation": "AddTile"
                                },
                                {
                                  "sourceColumn": "Total",
                                  "operator": "==",
                                  "thresholdValue": "0",
                                  "representation": "unknown"
                                }
                              ]
                            },
                            "tagText": "",
                            "valueFontStyle": "auto"
                          }
                        },
                        "customWidth": "10",
                        "conditionalVisibility": {
                          "parameterName": "hide",
                          "comparison": "isEqualTo",
                          "value": "hide"
                        },
                        "name": "queryAndroidDevices",
                        "styleSettings": {
                          "margin": "2px",
                          "padding": "2px",
                          "maxWidth": "10"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"deviceType eq 'linux'\"},{\"key\":\"$select\",\"value\":\"operatingSystem,deviceType\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"\",\"columns\":[{\"path\":\"$['@odata.count']\",\"columnid\":\"Total\",\"columnType\":\"long\"},{\"path\":\"$.value[0].operatingSystem\",\"columnid\":\"Operating_System\",\"columnType\":\"string\",\"substringRegexMatch\":\".*\",\"substringReplace\":\"Linux\"}]}}]}",
                          "size": 4,
                          "title": "Linux",
                          "queryType": 14,
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Total",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20px"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": true
                                  }
                                }
                              },
                              {
                                "columnMatch": "Operating_System",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20px"
                                }
                              },
                              {
                                "columnMatch": "managementAgent",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Compliance_State",
                                "formatter": 5
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Operating_System",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Total",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": false
                          },
                          "statSettings": {
                            "valueField": "Total",
                            "valueAggregation": "None",
                            "colorSettings": {
                              "type": "static",
                              "mode": "background",
                              "heatmapPalette": "greenRed",
                              "thresholdsGrid": []
                            },
                            "iconSettings": {
                              "thresholdsGrid": [
                                {
                                  "sourceColumn": "Total",
                                  "operator": ">",
                                  "thresholdValue": "0",
                                  "representation": "AddTile"
                                },
                                {
                                  "sourceColumn": "Total",
                                  "operator": "==",
                                  "thresholdValue": "0",
                                  "representation": "unknown"
                                }
                              ]
                            },
                            "tagText": "",
                            "valueFontStyle": "auto"
                          }
                        },
                        "customWidth": "10",
                        "conditionalVisibility": {
                          "parameterName": "hide",
                          "comparison": "isEqualTo",
                          "value": "hide"
                        },
                        "name": "queryLinuxDevices",
                        "styleSettings": {
                          "margin": "2px",
                          "padding": "2px",
                          "maxWidth": "10"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"1.0.0\",\"content\":\"\\r\\n[\\r\\n\\t{ \\r\\n\\t\\\"Total\\\": \\\"0\\\",\\r\\n\\t\\\"Operating_System\\\": \\\"Windows\\\"\\r\\n    },\\t\\r\\n\\t{ \\r\\n\\t\\\"Total\\\": \\\"0\\\",\\r\\n\\t\\\"Operating_System\\\": \\\"iOS\\\"\\r\\n    },\\t\\r\\n\\t{ \\r\\n\\t\\\"Total\\\": \\\"0\\\",\\r\\n\\t\\\"Operating_System\\\": \\\"Android\\\"\\r\\n    },\\t\\r\\n\\t{ \\r\\n\\t\\\"Total\\\": \\\"0\\\",\\r\\n\\t\\\"Operating_System\\\": \\\"Linux\\\"\\r\\n    },\\t\\r\\n\\t{\\r\\n\\t\\\"Total\\\": \\\"0\\\",\\r\\n\\t\\\"Operating_System\\\": \\\"MacOS\\\"\\r\\n    }\\r\\n]\",\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"columns\":[{\"path\":\"Total\",\"columnid\":\"Total\",\"columnType\":\"long\"},{\"path\":\"Operating_System\",\"columnid\":\"Operating_System\",\"columnType\":\"string\"}]}}]}",
                          "size": 4,
                          "title": "Others",
                          "queryType": 8,
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Total",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20px"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": true
                                  }
                                }
                              },
                              {
                                "columnMatch": "Operating_System",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20px"
                                }
                              },
                              {
                                "columnMatch": "managementAgent",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Compliance_State",
                                "formatter": 5
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Operating_System",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Total",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": false
                          },
                          "statSettings": {
                            "valueField": "Total",
                            "valueAggregation": "None",
                            "colorSettings": {
                              "type": "static",
                              "mode": "background",
                              "heatmapPalette": "greenRed",
                              "thresholdsGrid": []
                            },
                            "iconSettings": {
                              "thresholdsGrid": [
                                {
                                  "sourceColumn": "Total",
                                  "operator": ">",
                                  "thresholdValue": "0",
                                  "representation": "AddTile"
                                },
                                {
                                  "sourceColumn": "Total",
                                  "operator": "==",
                                  "thresholdValue": "0",
                                  "representation": "unknown"
                                }
                              ]
                            },
                            "tagText": "",
                            "valueFontStyle": "auto"
                          }
                        },
                        "customWidth": "10",
                        "conditionalVisibility": {
                          "parameterName": "hide",
                          "comparison": "isEqualTo",
                          "value": "hide"
                        },
                        "name": "queryOthersDevices",
                        "styleSettings": {
                          "margin": "2px",
                          "padding": "2px",
                          "maxWidth": "10"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"67f4df86-c968-477d-900e-cff52f18c1b3\",\"mergeType\":\"union\",\"leftTable\":\"queryOthersDevices\",\"rightTable\":\"queryWindowsDevices\"},{\"id\":\"67f4df86-c968-477d-900e-cff52f18c1b4\",\"mergeType\":\"union\",\"leftTable\":\"queryOthersDevices\",\"rightTable\":\"queryLinuxDevices\"},{\"id\":\"67f4df86-c968-477d-900e-cff52f18c1b5\",\"mergeType\":\"union\",\"leftTable\":\"queryOthersDevices\",\"rightTable\":\"queryMacOSDevices\"},{\"id\":\"67f4df86-c968-477d-900e-cff52f18c1b6\",\"mergeType\":\"union\",\"leftTable\":\"queryOthersDevices\",\"rightTable\":\"queryiOSDevices\"},{\"id\":\"67f4df86-c968-477d-900e-cff52f18c1b7\",\"mergeType\":\"union\",\"leftTable\":\"queryOthersDevices\",\"rightTable\":\"queryAndroidDevices\"}],\"projectRename\":[{\"originalName\":\"Total\",\"mergedName\":\"Total\",\"fromId\":\"unknown\"},{\"originalName\":\"Operating_System\",\"mergedName\":\"Operating_System\",\"fromId\":\"unknown\"},{\"originalName\":\"[queryiOSDevices].@odata.context\",\"mergedName\":\"@odata.context\",\"fromId\":\"unknown\"},{\"originalName\":\"[queryiOSDevices].@odata.count\",\"mergedName\":\"@odata.count\",\"fromId\":\"unknown\"},{\"originalName\":\"[queryiOSDevices].value\",\"mergedName\":\"value\",\"fromId\":\"unknown\"},{\"originalName\":\"[queryiOSDevices].defaultVisualization\",\"mergedName\":\"defaultVisualization\",\"fromId\":\"unknown\"},{\"originalName\":\"[queryAndroidDevices].ddd\",\"mergedName\":\"ddd\",\"fromId\":\"unknown\"},{\"originalName\":\"[queryOthersDevices].Total\",\"mergedName\":\"Total1\",\"fromId\":\"67f4df86-c968-477d-900e-cff52f18c1b3\"},{\"originalName\":\"[queryOthersDevices].Operating_System\",\"mergedName\":\"Operating_System1\",\"fromId\":\"67f4df86-c968-477d-900e-cff52f18c1b3\"},{\"originalName\":\"Windows\",\"mergedName\":\"Windows\",\"fromId\":\"unknown\"},{\"originalName\":\"iOS\",\"mergedName\":\"iOS\",\"fromId\":\"unknown\"},{\"originalName\":\"Android\",\"mergedName\":\"Android\",\"fromId\":\"unknown\"},{\"originalName\":\"Linux\",\"mergedName\":\"Linux\",\"fromId\":\"unknown\"},{\"originalName\":\"MacOS\",\"mergedName\":\"MacOS\",\"fromId\":\"unknown\"},{\"originalName\":\"[queryWindowsDevices].Total\",\"mergedName\":\"Total\",\"fromId\":\"unknown\"},{\"originalName\":\"[queryWindowsDevices].Operating_System\",\"mergedName\":\"Operating_System\",\"fromId\":\"unknown\"},{\"originalName\":\"[queryLinuxDevices].Total\",\"mergedName\":\"Total\",\"fromId\":\"unknown\"},{\"originalName\":\"[queryLinuxDevices].Operating_System\",\"mergedName\":\"Operating_System\",\"fromId\":\"unknown\"},{\"originalName\":\"[queryMacOSDevices].Total\",\"mergedName\":\"Total\",\"fromId\":\"unknown\"},{\"originalName\":\"[queryMacOSDevices].Operating_System\",\"mergedName\":\"Operating_System\",\"fromId\":\"unknown\"},{\"originalName\":\"[queryiOSDevices].Total\",\"mergedName\":\"Total\",\"fromId\":\"unknown\"},{\"originalName\":\"[queryiOSDevices].Operating_System\",\"mergedName\":\"Operating_System\",\"fromId\":\"unknown\"},{\"originalName\":\"[queryAndroidDevices].Total\",\"mergedName\":\"Total\",\"fromId\":\"unknown\"},{\"originalName\":\"[queryAndroidDevices].Operating_System\",\"mergedName\":\"Operating_System\",\"fromId\":\"unknown\"}]}",
                          "size": 3,
                          "title": "Devices by OS",
                          "queryType": 7,
                          "visualization": "piechart",
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Windows",
                                "label": "Windows",
                                "color": "blue"
                              },
                              {
                                "seriesName": "iOS",
                                "label": "iOS",
                                "color": "red"
                              },
                              {
                                "seriesName": "Android",
                                "label": "Android",
                                "color": "green"
                              },
                              {
                                "seriesName": "MacOS",
                                "label": "MacOS",
                                "color": "amethyst"
                              },
                              {
                                "seriesName": "Linux",
                                "label": "Linux",
                                "color": "yellow"
                              }
                            ]
                          }
                        },
                        "customWidth": "0",
                        "showPin": false,
                        "name": "PieChartbyOS",
                        "styleSettings": {
                          "margin": "10px 10px"
                        }
                      }
                    ]
                  },
                  "customWidth": "0",
                  "name": "groupNotCompliant",
                  "styleSettings": {
                    "maxWidth": "33%"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"operatingSystem eq 'Windows' and complianceState eq 'noncompliant'\"},{\"key\":\"$select\",\"value\":\"lastSyncDateTime,complianceState,operatingSystem\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"\",\"columns\":[{\"path\":\"$['@odata.count']\",\"columnid\":\"Total\",\"columnType\":\"long\"},{\"path\":\"$.value[0].operatingSystem\",\"columnid\":\"Operating_System\",\"columnType\":\"string\",\"substringRegexMatch\":\".*\",\"substringReplace\":\"Windows\"}]}}]}",
                          "size": 4,
                          "title": "Windows",
                          "queryType": 14,
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Total",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20px"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": true
                                  }
                                }
                              },
                              {
                                "columnMatch": "Operating_System",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20px"
                                }
                              },
                              {
                                "columnMatch": "managementAgent",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Compliance_State",
                                "formatter": 5
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Operating_System",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Total",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": false
                          },
                          "statSettings": {
                            "valueField": "Total",
                            "valueAggregation": "None",
                            "colorSettings": {
                              "type": "static",
                              "mode": "background",
                              "heatmapPalette": "greenRed",
                              "thresholdsGrid": []
                            },
                            "iconSettings": {
                              "thresholdsGrid": [
                                {
                                  "sourceColumn": "Total",
                                  "operator": ">",
                                  "thresholdValue": "0",
                                  "representation": "AddTile"
                                },
                                {
                                  "sourceColumn": "Total",
                                  "operator": "==",
                                  "thresholdValue": "0",
                                  "representation": "unknown"
                                }
                              ]
                            },
                            "tagText": "",
                            "valueFontStyle": "auto"
                          }
                        },
                        "customWidth": "10",
                        "conditionalVisibility": {
                          "parameterName": "hide",
                          "comparison": "isEqualTo",
                          "value": "hide"
                        },
                        "name": "queryWindowsDevices",
                        "styleSettings": {
                          "margin": "2px",
                          "padding": "2px",
                          "maxWidth": "10"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"operatingSystem eq 'macOS' and complianceState eq 'noncompliant'\"},{\"key\":\"$select\",\"value\":\"lastSyncDateTime,complianceState,operatingSystem\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"\",\"columns\":[{\"path\":\"$['@odata.count']\",\"columnid\":\"Total\",\"columnType\":\"long\"},{\"path\":\"$.value[0].operatingSystem\",\"columnid\":\"Operating_System\",\"columnType\":\"string\",\"substringRegexMatch\":\".*\",\"substringReplace\":\"MacOS\"}]}}]}",
                          "size": 4,
                          "title": "MacOS",
                          "queryType": 14,
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Total",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20px"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": true
                                  }
                                }
                              },
                              {
                                "columnMatch": "Operating_System",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20px"
                                }
                              },
                              {
                                "columnMatch": "managementAgent",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Compliance_State",
                                "formatter": 5
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Operating_System",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Total",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": false
                          },
                          "statSettings": {
                            "valueField": "Total",
                            "valueAggregation": "None",
                            "colorSettings": {
                              "type": "static",
                              "mode": "background",
                              "heatmapPalette": "greenRed",
                              "thresholdsGrid": []
                            },
                            "iconSettings": {
                              "thresholdsGrid": [
                                {
                                  "sourceColumn": "Total",
                                  "operator": ">",
                                  "thresholdValue": "0",
                                  "representation": "AddTile"
                                },
                                {
                                  "sourceColumn": "Total",
                                  "operator": "==",
                                  "thresholdValue": "0",
                                  "representation": "unknown"
                                }
                              ]
                            },
                            "tagText": "",
                            "valueFontStyle": "auto"
                          }
                        },
                        "customWidth": "10",
                        "conditionalVisibility": {
                          "parameterName": "hide",
                          "comparison": "isEqualTo",
                          "value": "hide"
                        },
                        "name": "queryMacOSDevices",
                        "styleSettings": {
                          "margin": "2px",
                          "padding": "2px",
                          "maxWidth": "10"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"operatingSystem eq 'iOS' and complianceState eq 'noncompliant'\"},{\"key\":\"$select\",\"value\":\"lastSyncDateTime,complianceState,operatingSystem\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"\",\"columns\":[{\"path\":\"$['@odata.count']\",\"columnid\":\"Total\",\"columnType\":\"long\"},{\"path\":\"$.value[0].operatingSystem\",\"columnid\":\"Operating_System\",\"columnType\":\"string\",\"substringRegexMatch\":\".*\",\"substringReplace\":\"iOS\"}]}}]}",
                          "size": 4,
                          "title": "iOS",
                          "queryType": 14,
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Total",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20px"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": true
                                  }
                                }
                              },
                              {
                                "columnMatch": "Operating_System",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20px"
                                }
                              },
                              {
                                "columnMatch": "managementAgent",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Compliance_State",
                                "formatter": 5
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Operating_System",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Total",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": false
                          },
                          "statSettings": {
                            "valueField": "Total",
                            "valueAggregation": "None",
                            "colorSettings": {
                              "type": "static",
                              "mode": "background",
                              "heatmapPalette": "greenRed",
                              "thresholdsGrid": []
                            },
                            "iconSettings": {
                              "thresholdsGrid": [
                                {
                                  "sourceColumn": "Total",
                                  "operator": ">",
                                  "thresholdValue": "0",
                                  "representation": "AddTile"
                                },
                                {
                                  "sourceColumn": "Total",
                                  "operator": "==",
                                  "thresholdValue": "0",
                                  "representation": "unknown"
                                }
                              ]
                            },
                            "tagText": "",
                            "valueFontStyle": "auto"
                          }
                        },
                        "customWidth": "10",
                        "conditionalVisibility": {
                          "parameterName": "hide",
                          "comparison": "isEqualTo",
                          "value": "hide"
                        },
                        "name": "queryiOSDevices",
                        "styleSettings": {
                          "margin": "2px",
                          "padding": "2px",
                          "maxWidth": "10"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"operatingSystem eq 'Android' and complianceState eq 'noncompliant'\"},{\"key\":\"$select\",\"value\":\"lastSyncDateTime,complianceState,operatingSystem\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"\",\"columns\":[{\"path\":\"$['@odata.count']\",\"columnid\":\"Total\",\"columnType\":\"long\"},{\"path\":\"$.value[0].operatingSystem\",\"columnid\":\"Operating_System\",\"columnType\":\"string\",\"substringRegexMatch\":\".*\",\"substringReplace\":\"Android\"}]}}]}",
                          "size": 4,
                          "title": "Android",
                          "queryType": 14,
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Total",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20px"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": true
                                  }
                                }
                              },
                              {
                                "columnMatch": "Operating_System",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20px"
                                }
                              },
                              {
                                "columnMatch": "managementAgent",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Compliance_State",
                                "formatter": 5
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Operating_System",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Total",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": false
                          },
                          "statSettings": {
                            "valueField": "Total",
                            "valueAggregation": "None",
                            "colorSettings": {
                              "type": "static",
                              "mode": "background",
                              "heatmapPalette": "greenRed",
                              "thresholdsGrid": []
                            },
                            "iconSettings": {
                              "thresholdsGrid": [
                                {
                                  "sourceColumn": "Total",
                                  "operator": ">",
                                  "thresholdValue": "0",
                                  "representation": "AddTile"
                                },
                                {
                                  "sourceColumn": "Total",
                                  "operator": "==",
                                  "thresholdValue": "0",
                                  "representation": "unknown"
                                }
                              ]
                            },
                            "tagText": "",
                            "valueFontStyle": "auto"
                          }
                        },
                        "customWidth": "10",
                        "conditionalVisibility": {
                          "parameterName": "hide",
                          "comparison": "isEqualTo",
                          "value": "hide"
                        },
                        "name": "queryAndroidDevices",
                        "styleSettings": {
                          "margin": "2px",
                          "padding": "2px",
                          "maxWidth": "10"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"deviceType eq 'linux' and complianceState eq 'noncompliant'\"},{\"key\":\"$select\",\"value\":\"lastSyncDateTime,complianceState,operatingSystem,deviceType\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"\",\"columns\":[{\"path\":\"$['@odata.count']\",\"columnid\":\"Total\",\"columnType\":\"long\"},{\"path\":\"$.value[0].operatingSystem\",\"columnid\":\"Operating_System\",\"columnType\":\"string\",\"substringRegexMatch\":\".*\",\"substringReplace\":\"Linux\"}]}}]}",
                          "size": 4,
                          "title": "Linux",
                          "queryType": 14,
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Total",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20px"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": true
                                  }
                                }
                              },
                              {
                                "columnMatch": "Operating_System",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20px"
                                }
                              },
                              {
                                "columnMatch": "managementAgent",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Compliance_State",
                                "formatter": 5
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Operating_System",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Total",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": false
                          },
                          "statSettings": {
                            "valueField": "Total",
                            "valueAggregation": "None",
                            "colorSettings": {
                              "type": "static",
                              "mode": "background",
                              "heatmapPalette": "greenRed",
                              "thresholdsGrid": []
                            },
                            "iconSettings": {
                              "thresholdsGrid": [
                                {
                                  "sourceColumn": "Total",
                                  "operator": ">",
                                  "thresholdValue": "0",
                                  "representation": "AddTile"
                                },
                                {
                                  "sourceColumn": "Total",
                                  "operator": "==",
                                  "thresholdValue": "0",
                                  "representation": "unknown"
                                }
                              ]
                            },
                            "tagText": "",
                            "valueFontStyle": "auto"
                          }
                        },
                        "customWidth": "10",
                        "conditionalVisibility": {
                          "parameterName": "hide",
                          "comparison": "isEqualTo",
                          "value": "hide"
                        },
                        "name": "queryLinuxDevices",
                        "styleSettings": {
                          "margin": "2px",
                          "padding": "2px",
                          "maxWidth": "10"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"1.0.0\",\"content\":\"[\\r\\n\\t{ \\r\\n\\t\\\"Total\\\": \\\"0\\\",\\r\\n\\t\\\"Operating_System\\\": \\\"Windows\\\"\\r\\n    },\\t\\r\\n\\t{ \\r\\n\\t\\\"Total\\\": \\\"0\\\",\\r\\n\\t\\\"Operating_System\\\": \\\"iOS\\\"\\r\\n    },\\t\\r\\n\\t{ \\r\\n\\t\\\"Total\\\": \\\"0\\\",\\r\\n\\t\\\"Operating_System\\\": \\\"Android\\\"\\r\\n    },\\t\\r\\n\\t{ \\r\\n\\t\\\"Total\\\": \\\"0\\\",\\r\\n\\t\\\"Operating_System\\\": \\\"Linux\\\"\\r\\n    },\\t\\r\\n\\t{ \\r\\n\\t\\\"Total\\\": \\\"0\\\",\\r\\n\\t\\\"Operating_System\\\": \\\"MacOS\\\"\\r\\n    }\\r\\n]\",\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"columns\":[{\"path\":\"Total\",\"columnid\":\"Total\",\"columnType\":\"long\"},{\"path\":\"Operating_System\",\"columnid\":\"Operating_System\",\"columnType\":\"string\"}]}}]}",
                          "size": 4,
                          "title": "Others",
                          "queryType": 8,
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Total",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20px"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": true
                                  }
                                }
                              },
                              {
                                "columnMatch": "Operating_System",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20px"
                                }
                              },
                              {
                                "columnMatch": "managementAgent",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Compliance_State",
                                "formatter": 5
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Operating_System",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Total",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": false
                          },
                          "statSettings": {
                            "valueField": "Total",
                            "valueAggregation": "None",
                            "colorSettings": {
                              "type": "static",
                              "mode": "background",
                              "heatmapPalette": "greenRed",
                              "thresholdsGrid": []
                            },
                            "iconSettings": {
                              "thresholdsGrid": [
                                {
                                  "sourceColumn": "Total",
                                  "operator": ">",
                                  "thresholdValue": "0",
                                  "representation": "AddTile"
                                },
                                {
                                  "sourceColumn": "Total",
                                  "operator": "==",
                                  "thresholdValue": "0",
                                  "representation": "unknown"
                                }
                              ]
                            },
                            "tagText": "",
                            "valueFontStyle": "auto"
                          }
                        },
                        "customWidth": "10",
                        "conditionalVisibility": {
                          "parameterName": "hide",
                          "comparison": "isEqualTo",
                          "value": "hide"
                        },
                        "name": "queryOthersDevices",
                        "styleSettings": {
                          "margin": "2px",
                          "padding": "2px",
                          "maxWidth": "10"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"67f4df86-c968-477d-900e-cff52f18c1c0\",\"mergeType\":\"union\",\"leftTable\":\"queryOthersDevices\",\"rightTable\":\"queryWindowsDevices\"},{\"id\":\"67f4df86-c968-477d-900e-cff52f18c1c1\",\"mergeType\":\"union\",\"leftTable\":\"queryOthersDevices\",\"rightTable\":\"queryLinuxDevices\"},{\"id\":\"67f4df86-c968-477d-900e-cff52f18c1c2\",\"mergeType\":\"union\",\"leftTable\":\"queryOthersDevices\",\"rightTable\":\"queryAndroidDevices\"},{\"id\":\"67f4df86-c968-477d-900e-cff52f18c1c3\",\"mergeType\":\"union\",\"leftTable\":\"queryOthersDevices\",\"rightTable\":\"queryiOSDevices\"},{\"id\":\"67f4df86-c968-477d-900e-cff52f18c1c4\",\"mergeType\":\"union\",\"leftTable\":\"queryOthersDevices\",\"rightTable\":\"queryMacOSDevices\"}],\"projectRename\":[{\"originalName\":\"Total\",\"mergedName\":\"Total\",\"fromId\":\"unknown\"},{\"originalName\":\"Operating_System\",\"mergedName\":\"Operating_System\",\"fromId\":\"unknown\"},{\"originalName\":\"[queryiOSDevices].@odata.context\",\"mergedName\":\"@odata.context\",\"fromId\":\"unknown\"},{\"originalName\":\"[queryiOSDevices].@odata.count\",\"mergedName\":\"@odata.count\",\"fromId\":\"unknown\"},{\"originalName\":\"[queryiOSDevices].value\",\"mergedName\":\"value\",\"fromId\":\"unknown\"},{\"originalName\":\"[queryiOSDevices].defaultVisualization\",\"mergedName\":\"defaultVisualization\",\"fromId\":\"unknown\"},{\"originalName\":\"[queryAndroidDevices].ddd\",\"mergedName\":\"ddd\",\"fromId\":\"unknown\"},{\"originalName\":\"[queryOthersDevices].Total\",\"mergedName\":\"Total1\",\"fromId\":\"67f4df86-c968-477d-900e-cff52f18c1c0\"},{\"originalName\":\"[queryOthersDevices].Operating_System\",\"mergedName\":\"Operating_System1\",\"fromId\":\"67f4df86-c968-477d-900e-cff52f18c1c0\"}]}",
                          "size": 3,
                          "title": "Not Compliant Device",
                          "queryType": 7,
                          "visualization": "piechart",
                          "chartSettings": {
                            "yAxis": [
                              "Total"
                            ],
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Windows",
                                "label": "Windows",
                                "color": "blue"
                              },
                              {
                                "seriesName": "iOS",
                                "label": "iOS",
                                "color": "red"
                              },
                              {
                                "seriesName": "Android",
                                "label": "Android",
                                "color": "green"
                              },
                              {
                                "seriesName": "Others",
                                "color": "gray"
                              },
                              {
                                "seriesName": "Linux",
                                "color": "yellow"
                              },
                              {
                                "seriesName": "MacOS",
                                "color": "amethyst"
                              }
                            ]
                          }
                        },
                        "customWidth": "0",
                        "showPin": false,
                        "name": "PieChartNotCompliant",
                        "styleSettings": {
                          "margin": "10px 10px"
                        }
                      }
                    ]
                  },
                  "customWidth": "0",
                  "name": "groupNotCompliant - Copy",
                  "styleSettings": {
                    "maxWidth": "33%"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"operatingSystem eq 'Windows' and complianceState eq 'inGracePeriod'\"},{\"key\":\"$select\",\"value\":\"lastSyncDateTime,complianceState,operatingSystem\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"\",\"columns\":[{\"path\":\"$['@odata.count']\",\"columnid\":\"Total\",\"columnType\":\"long\"},{\"path\":\"$.value[0].operatingSystem\",\"columnid\":\"Operating_System\",\"columnType\":\"string\",\"substringRegexMatch\":\".*\",\"substringReplace\":\"Windows\"}]}}]}",
                          "size": 4,
                          "title": "Windows",
                          "queryType": 14,
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Total",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20px"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": true
                                  }
                                }
                              },
                              {
                                "columnMatch": "Operating_System",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20px"
                                }
                              },
                              {
                                "columnMatch": "managementAgent",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Compliance_State",
                                "formatter": 5
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Operating_System",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Total",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": false
                          },
                          "statSettings": {
                            "valueField": "Total",
                            "valueAggregation": "None",
                            "colorSettings": {
                              "type": "static",
                              "mode": "background",
                              "heatmapPalette": "greenRed",
                              "thresholdsGrid": []
                            },
                            "iconSettings": {
                              "thresholdsGrid": [
                                {
                                  "sourceColumn": "Total",
                                  "operator": ">",
                                  "thresholdValue": "0",
                                  "representation": "AddTile"
                                },
                                {
                                  "sourceColumn": "Total",
                                  "operator": "==",
                                  "thresholdValue": "0",
                                  "representation": "unknown"
                                }
                              ]
                            },
                            "tagText": "",
                            "valueFontStyle": "auto"
                          }
                        },
                        "customWidth": "10",
                        "conditionalVisibility": {
                          "parameterName": "hide",
                          "comparison": "isEqualTo",
                          "value": "hide"
                        },
                        "name": "queryWindowsDevicesGrace",
                        "styleSettings": {
                          "margin": "2px",
                          "padding": "2px",
                          "maxWidth": "10"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"operatingSystem eq 'macOS' and complianceState eq 'inGracePeriod'\"},{\"key\":\"$select\",\"value\":\"lastSyncDateTime,complianceState,operatingSystem\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"\",\"columns\":[{\"path\":\"$['@odata.count']\",\"columnid\":\"Total\",\"columnType\":\"long\"},{\"path\":\"$.value[0].operatingSystem\",\"columnid\":\"Operating_System\",\"columnType\":\"string\",\"substringRegexMatch\":\".*\",\"substringReplace\":\"MacOS\"}]}}]}",
                          "size": 4,
                          "title": "MacOS",
                          "queryType": 14,
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Total",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20px"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": true
                                  }
                                }
                              },
                              {
                                "columnMatch": "Operating_System",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20px"
                                }
                              },
                              {
                                "columnMatch": "managementAgent",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Compliance_State",
                                "formatter": 5
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Operating_System",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Total",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": false
                          },
                          "statSettings": {
                            "valueField": "Total",
                            "valueAggregation": "None",
                            "colorSettings": {
                              "type": "static",
                              "mode": "background",
                              "heatmapPalette": "greenRed",
                              "thresholdsGrid": []
                            },
                            "iconSettings": {
                              "thresholdsGrid": [
                                {
                                  "sourceColumn": "Total",
                                  "operator": ">",
                                  "thresholdValue": "0",
                                  "representation": "AddTile"
                                },
                                {
                                  "sourceColumn": "Total",
                                  "operator": "==",
                                  "thresholdValue": "0",
                                  "representation": "unknown"
                                }
                              ]
                            },
                            "tagText": "",
                            "valueFontStyle": "auto"
                          }
                        },
                        "customWidth": "10",
                        "conditionalVisibility": {
                          "parameterName": "hide",
                          "comparison": "isEqualTo",
                          "value": "hide"
                        },
                        "name": "queryMacOSDevicesGrace",
                        "styleSettings": {
                          "margin": "2px",
                          "padding": "2px",
                          "maxWidth": "10"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"operatingSystem eq 'iOS' and complianceState eq 'inGracePeriod'\"},{\"key\":\"$select\",\"value\":\"lastSyncDateTime,complianceState,operatingSystem\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"\",\"columns\":[{\"path\":\"$['@odata.count']\",\"columnid\":\"Total\",\"columnType\":\"long\"},{\"path\":\"$.value[0].operatingSystem\",\"columnid\":\"Operating_System\"}]}}]}",
                          "size": 4,
                          "title": "iOS",
                          "queryType": 14,
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Total",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20px"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": true
                                  }
                                }
                              },
                              {
                                "columnMatch": "Operating_System",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20px"
                                }
                              },
                              {
                                "columnMatch": "managementAgent",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Compliance_State",
                                "formatter": 5
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Operating_System",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Total",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": false
                          },
                          "statSettings": {
                            "valueField": "Total",
                            "valueAggregation": "None",
                            "colorSettings": {
                              "type": "static",
                              "mode": "background",
                              "heatmapPalette": "greenRed",
                              "thresholdsGrid": []
                            },
                            "iconSettings": {
                              "thresholdsGrid": [
                                {
                                  "sourceColumn": "Total",
                                  "operator": ">",
                                  "thresholdValue": "0",
                                  "representation": "AddTile"
                                },
                                {
                                  "sourceColumn": "Total",
                                  "operator": "==",
                                  "thresholdValue": "0",
                                  "representation": "unknown"
                                }
                              ]
                            },
                            "tagText": "",
                            "valueFontStyle": "auto"
                          }
                        },
                        "customWidth": "10",
                        "conditionalVisibility": {
                          "parameterName": "hide",
                          "comparison": "isEqualTo",
                          "value": "hide"
                        },
                        "name": "queryiOSDevicesGrace",
                        "styleSettings": {
                          "margin": "2px",
                          "padding": "2px",
                          "maxWidth": "10"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"operatingSystem eq 'Android' and complianceState eq 'inGracePeriod'\"},{\"key\":\"$select\",\"value\":\"lastSyncDateTime,complianceState,operatingSystem\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"\",\"columns\":[{\"path\":\"$['@odata.count']\",\"columnid\":\"Total\",\"columnType\":\"long\"},{\"path\":\"$.value[0].operatingSystem\",\"columnid\":\"Operating_System\",\"columnType\":\"string\",\"substringRegexMatch\":\".*\",\"substringReplace\":\"Android\"}]}}]}",
                          "size": 4,
                          "title": "Android",
                          "queryType": 14,
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Total",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20px"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": true
                                  }
                                }
                              },
                              {
                                "columnMatch": "Operating_System",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20px"
                                }
                              },
                              {
                                "columnMatch": "managementAgent",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Compliance_State",
                                "formatter": 5
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Operating_System",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Total",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": false
                          },
                          "statSettings": {
                            "valueField": "Total",
                            "valueAggregation": "None",
                            "colorSettings": {
                              "type": "static",
                              "mode": "background",
                              "heatmapPalette": "greenRed",
                              "thresholdsGrid": []
                            },
                            "iconSettings": {
                              "thresholdsGrid": [
                                {
                                  "sourceColumn": "Total",
                                  "operator": ">",
                                  "thresholdValue": "0",
                                  "representation": "AddTile"
                                },
                                {
                                  "sourceColumn": "Total",
                                  "operator": "==",
                                  "thresholdValue": "0",
                                  "representation": "unknown"
                                }
                              ]
                            },
                            "tagText": "",
                            "valueFontStyle": "auto"
                          }
                        },
                        "customWidth": "10",
                        "conditionalVisibility": {
                          "parameterName": "hide",
                          "comparison": "isEqualTo",
                          "value": "hide"
                        },
                        "name": "queryAndroidDevicesGrace",
                        "styleSettings": {
                          "margin": "2px",
                          "padding": "2px",
                          "maxWidth": "10"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"deviceType eq 'linux' and complianceState eq 'inGracePeriod'\"},{\"key\":\"$select\",\"value\":\"lastSyncDateTime,complianceState,operatingSystem,deviceType\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"\",\"columns\":[{\"path\":\"$['@odata.count']\",\"columnid\":\"Total\",\"columnType\":\"long\"},{\"path\":\"$.value[0].operatingSystem\",\"columnid\":\"Operating_System\",\"columnType\":\"string\",\"substringRegexMatch\":\".*\",\"substringReplace\":\"Linux\"}]}}]}",
                          "size": 4,
                          "title": "Linux",
                          "queryType": 14,
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Total",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20px"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": true
                                  }
                                }
                              },
                              {
                                "columnMatch": "Operating_System",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20px"
                                }
                              },
                              {
                                "columnMatch": "managementAgent",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Compliance_State",
                                "formatter": 5
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Operating_System",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Total",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": false
                          },
                          "statSettings": {
                            "valueField": "Total",
                            "valueAggregation": "None",
                            "colorSettings": {
                              "type": "static",
                              "mode": "background",
                              "heatmapPalette": "greenRed",
                              "thresholdsGrid": []
                            },
                            "iconSettings": {
                              "thresholdsGrid": [
                                {
                                  "sourceColumn": "Total",
                                  "operator": ">",
                                  "thresholdValue": "0",
                                  "representation": "AddTile"
                                },
                                {
                                  "sourceColumn": "Total",
                                  "operator": "==",
                                  "thresholdValue": "0",
                                  "representation": "unknown"
                                }
                              ]
                            },
                            "tagText": "",
                            "valueFontStyle": "auto"
                          }
                        },
                        "customWidth": "10",
                        "conditionalVisibility": {
                          "parameterName": "hide",
                          "comparison": "isEqualTo",
                          "value": "hide"
                        },
                        "name": "queryLinuxDevicesGrace",
                        "styleSettings": {
                          "margin": "2px",
                          "padding": "2px",
                          "maxWidth": "10"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"1.0.0\",\"content\":\"\\r\\n[\\r\\n\\t{ \\r\\n\\t\\\"Total\\\": \\\"0\\\",\\r\\n\\t\\\"Operating_System\\\": \\\"Windows\\\"\\r\\n    },\\t\\r\\n\\t{ \\r\\n\\t\\\"Total\\\": \\\"0\\\",\\r\\n\\t\\\"Operating_System\\\": \\\"iOS\\\"\\r\\n    },\\t\\r\\n\\t{ \\r\\n\\t\\\"Total\\\": \\\"0\\\",\\r\\n\\t\\\"Operating_System\\\": \\\"Android\\\"\\r\\n    },\\t\\r\\n\\t{ \\r\\n\\t\\\"Total\\\": \\\"0\\\",\\r\\n\\t\\\"Operating_System\\\": \\\"Linux\\\"\\r\\n    },\\t\\r\\n\\t{ \\r\\n\\t\\\"Total\\\": \\\"0\\\",\\r\\n\\t\\\"Operating_System\\\": \\\"MacOS\\\"\\r\\n    }\\r\\n]\",\"transformers\":null}",
                          "size": 4,
                          "title": "Others",
                          "queryType": 8,
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Total",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20px"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": true
                                  }
                                }
                              },
                              {
                                "columnMatch": "Operating_System",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20px"
                                }
                              },
                              {
                                "columnMatch": "managementAgent",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Compliance_State",
                                "formatter": 5
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Operating_System",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Total",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": false
                          },
                          "statSettings": {
                            "valueField": "Total",
                            "valueAggregation": "None",
                            "colorSettings": {
                              "type": "static",
                              "mode": "background",
                              "heatmapPalette": "greenRed",
                              "thresholdsGrid": []
                            },
                            "iconSettings": {
                              "thresholdsGrid": [
                                {
                                  "sourceColumn": "Total",
                                  "operator": ">",
                                  "thresholdValue": "0",
                                  "representation": "AddTile"
                                },
                                {
                                  "sourceColumn": "Total",
                                  "operator": "==",
                                  "thresholdValue": "0",
                                  "representation": "unknown"
                                }
                              ]
                            },
                            "tagText": "",
                            "valueFontStyle": "auto"
                          }
                        },
                        "customWidth": "10",
                        "conditionalVisibility": {
                          "parameterName": "hide",
                          "comparison": "isEqualTo",
                          "value": "hide"
                        },
                        "name": "queryOthersDevicesGrace",
                        "styleSettings": {
                          "margin": "2px",
                          "padding": "2px",
                          "maxWidth": "10"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"67f4df86-c968-477d-900e-cff52f18c194\",\"mergeType\":\"union\",\"leftTable\":\"queryOthersDevicesGrace\",\"rightTable\":\"queryLinuxDevicesGrace\"},{\"id\":\"67f4df86-c968-477d-900e-cff52f18c195\",\"mergeType\":\"union\",\"leftTable\":\"queryOthersDevicesGrace\",\"rightTable\":\"queryMacOSDevicesGrace\"},{\"id\":\"67f4df86-c968-477d-900e-cff52f18c196\",\"mergeType\":\"union\",\"leftTable\":\"queryOthersDevicesGrace\",\"rightTable\":\"queryWindowsDevicesGrace\"},{\"id\":\"67f4df86-c968-477d-900e-cff52f18c197\",\"mergeType\":\"union\",\"leftTable\":\"queryOthersDevicesGrace\",\"rightTable\":\"queryiOSDevicesGrace\"},{\"id\":\"67f4df86-c968-477d-900e-cff52f18c198\",\"mergeType\":\"union\",\"leftTable\":\"queryOthersDevicesGrace\",\"rightTable\":\"queryAndroidDevicesGrace\"}],\"projectRename\":[{\"originalName\":\"@odata.context\",\"mergedName\":\"@odata.context\",\"fromId\":\"unknown\"},{\"originalName\":\"@odata.count\",\"mergedName\":\"@odata.count\",\"fromId\":\"unknown\"},{\"originalName\":\"value\",\"mergedName\":\"value\",\"fromId\":\"unknown\"},{\"originalName\":\"defaultVisualization\",\"mergedName\":\"defaultVisualization\",\"fromId\":\"unknown\"},{\"originalName\":\"[queryMacOSDevicesGrace].Total\",\"mergedName\":\"Total\",\"fromId\":\"unknown\"},{\"originalName\":\"[queryMacOSDevicesGrace].Operating_System\",\"mergedName\":\"Operating_System\",\"fromId\":\"unknown\"},{\"originalName\":\"[queryiOSDevicesGrace].Total\",\"mergedName\":\"Total\",\"fromId\":\"unknown\"},{\"originalName\":\"[queryiOSDevicesGrace].Operating_System\",\"mergedName\":\"Operating_System\",\"fromId\":\"unknown\"},{\"originalName\":\"[queryAndroidDevicesGrace].Total\",\"mergedName\":\"Total\",\"fromId\":\"unknown\"},{\"originalName\":\"[queryAndroidDevicesGrace].Operating_System\",\"mergedName\":\"Operating_System\",\"fromId\":\"unknown\"},{\"originalName\":\"[queryLinuxDevicesGrace].Total\",\"mergedName\":\"Total\",\"fromId\":\"unknown\"},{\"originalName\":\"[queryLinuxDevicesGrace].Operating_System\",\"mergedName\":\"Operating_System\",\"fromId\":\"unknown\"},{\"originalName\":\"Total\",\"mergedName\":\"Total\",\"fromId\":\"unknown\"},{\"originalName\":\"Operating_System\",\"mergedName\":\"Operating_System\",\"fromId\":\"unknown\"},{\"originalName\":\"[queryOthersDevicesGrace].Total\",\"mergedName\":\"Total1\",\"fromId\":\"67f4df86-c968-477d-900e-cff52f18c194\"},{\"originalName\":\"[queryOthersDevicesGrace].Operating_System\",\"mergedName\":\"Operating_System1\",\"fromId\":\"67f4df86-c968-477d-900e-cff52f18c194\"}]}",
                          "size": 3,
                          "title": "In Grace Period Device",
                          "noDataMessage": "No Devices in Grace Period",
                          "queryType": 7,
                          "visualization": "piechart",
                          "tileSettings": {
                            "showBorder": false
                          },
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Windows",
                                "label": "Windows",
                                "color": "blue"
                              },
                              {
                                "seriesName": "iOS",
                                "label": "iOS",
                                "color": "red"
                              },
                              {
                                "seriesName": "Android",
                                "label": "Android",
                                "color": "green"
                              },
                              {
                                "seriesName": "MacOS",
                                "label": "MacOS",
                                "color": "amethyst"
                              },
                              {
                                "seriesName": "Linux",
                                "label": "Linux",
                                "color": "yellow"
                              }
                            ],
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "0",
                        "showPin": false,
                        "name": "PieChartinGracePeriod",
                        "styleSettings": {
                          "margin": "10px 10px"
                        }
                      }
                    ]
                  },
                  "customWidth": "0",
                  "name": "groupinGracePeriod",
                  "styleSettings": {
                    "maxWidth": "33%"
                  }
                }
              ]
            },
            "name": "groupOverviewOS"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"1.0.0\",\"content\":\"[\\r\\n\\t{\\r\\n\\t\\t\\\"Assigned\\\":\\\"Assigned\\\",\\r\\n        \\\"AssignedBool\\\":\\\"0\\\"\\r\\n    }\\r\\n]\",\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"columns\":[{\"path\":\"AssignedBool\",\"columnid\":\"AssignedBool\",\"columnType\":\"long\"},{\"path\":\"Assigned\",\"columnid\":\"Assigned\",\"columnType\":\"string\"}]}}]}",
                          "size": 4,
                          "title": "Assigned0",
                          "queryType": 8
                        },
                        "conditionalVisibility": {
                          "parameterName": "hide",
                          "comparison": "isEqualTo",
                          "value": "*"
                        },
                        "name": "Assigned0"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsitencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceAppManagement/mobileApps\",\"urlParams\":[{\"key\":\"$select\",\"value\":\"isAssigned\"},{\"key\":\"$top\",\"value\":\"999\"},{\"key\":\"$filter\",\"value\":\"isAssigned eq true\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$.isAssigned\",\"columnid\":\"AssignedBool\",\"columnType\":\"long\",\"substringRegexMatch\":\".*\",\"substringReplace\":\"1\"},{\"path\":\"$.isAssigned\",\"columnid\":\"Assigned\",\"columnType\":\"string\",\"substringRegexMatch\":\".*\",\"substringReplace\":\"Assigned\"}]}}]}",
                          "size": 4,
                          "title": "queryAppsAssigned",
                          "exportToExcelOptions": "all",
                          "queryType": 14,
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Assigned",
                                "formatter": 0,
                                "formatOptions": {
                                  "aggregation": "Count"
                                }
                              }
                            ],
                            "sortBy": [
                              {
                                "itemKey": "AssignedBool",
                                "sortOrder": 1
                              }
                            ]
                          },
                          "sortBy": [
                            {
                              "itemKey": "AssignedBool",
                              "sortOrder": 1
                            }
                          ],
                          "tileSettings": {
                            "titleContent": {},
                            "leftContent": {
                              "columnMatch": "JailBrokenCount",
                              "formatter": 8,
                              "formatOptions": {
                                "min": 0,
                                "max": 1,
                                "palette": "red",
                                "linkTarget": "GenericDetails",
                                "linkIsContextBlade": true
                              }
                            },
                            "showBorder": true,
                            "size": "auto",
                            "styleSettings": {
                              "borderStyle": "rounded"
                            }
                          },
                          "statSettings": {
                            "valueAggregation": "Count",
                            "colorSettings": {
                              "type": "static",
                              "mode": "foreground",
                              "heatmapPalette": "greenRed",
                              "heatmapMin": 0,
                              "heatmapMax": 1,
                              "thresholdsGrid": []
                            },
                            "iconSettings": {
                              "thresholdsGrid": [
                                {
                                  "operator": ">=",
                                  "thresholdValue": "0",
                                  "representation": "Canceled"
                                }
                              ]
                            },
                            "tagText": "",
                            "valueFontStyle": "auto",
                            "valueTooltipSettings": {
                              "tooltip": "The number of all Applications which are not assigned."
                            },
                            "valueField": "id"
                          }
                        },
                        "customWidth": "0",
                        "conditionalVisibility": {
                          "parameterName": "hide",
                          "comparison": "isEqualTo",
                          "value": "hide"
                        },
                        "name": "queryAppsAssigned",
                        "styleSettings": {
                          "margin": "10px 10px"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsitencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceAppManagement/mobileApps\",\"urlParams\":[{\"key\":\"$select\",\"value\":\"isAssigned\"},{\"key\":\"$top\",\"value\":\"999\"},{\"key\":\"$filter\",\"value\":\"isAssigned eq false\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$.isAssigned\",\"columnid\":\"AssignedBool\",\"columnType\":\"long\",\"substringRegexMatch\":\".*\",\"substringReplace\":\"1\"},{\"path\":\"$.isAssigned\",\"columnid\":\"Assigned\",\"substringRegexMatch\":\".*\",\"substringReplace\":\"Not Assigned\"}]}}]}",
                          "size": 4,
                          "title": "queryAppsNotAssigned",
                          "exportToExcelOptions": "all",
                          "queryType": 14,
                          "visualization": "table",
                          "sortBy": [],
                          "tileSettings": {
                            "titleContent": {},
                            "leftContent": {
                              "columnMatch": "JailBrokenCount",
                              "formatter": 8,
                              "formatOptions": {
                                "min": 0,
                                "max": 1,
                                "palette": "red",
                                "linkTarget": "GenericDetails",
                                "linkIsContextBlade": true
                              }
                            },
                            "showBorder": true,
                            "size": "auto",
                            "styleSettings": {
                              "borderStyle": "rounded"
                            }
                          },
                          "statSettings": {
                            "valueAggregation": "Count",
                            "colorSettings": {
                              "type": "static",
                              "mode": "foreground",
                              "heatmapPalette": "greenRed",
                              "heatmapMin": 0,
                              "heatmapMax": 1,
                              "thresholdsGrid": []
                            },
                            "iconSettings": {
                              "thresholdsGrid": [
                                {
                                  "operator": ">=",
                                  "thresholdValue": "0",
                                  "representation": "Canceled"
                                }
                              ]
                            },
                            "tagText": "",
                            "valueFontStyle": "auto",
                            "valueTooltipSettings": {
                              "tooltip": "The number of all Applications which are not assigned."
                            },
                            "valueField": "id"
                          }
                        },
                        "customWidth": "0",
                        "conditionalVisibility": {
                          "parameterName": "hide",
                          "comparison": "isEqualTo",
                          "value": "hide"
                        },
                        "name": "queryAppsNotAssigned",
                        "styleSettings": {
                          "margin": "10px 10px"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"82a3fbaa-8e7f-4124-bb7f-1ec9997544b7\",\"mergeType\":\"union\",\"leftTable\":\"Assigned0\",\"rightTable\":\"queryAppsAssigned\"},{\"id\":\"82a3fbaa-8e7f-4124-bb7f-1ec9997544b8\",\"mergeType\":\"union\",\"leftTable\":\"Assigned0\",\"rightTable\":\"queryAppsNotAssigned\"}]}",
                          "size": 3,
                          "title": "Apps by Assignment",
                          "queryType": 7,
                          "visualization": "piechart",
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Assigned",
                                "label": "",
                                "color": "green"
                              },
                              {
                                "seriesName": "Not Assigned",
                                "label": "",
                                "color": "red"
                              }
                            ]
                          }
                        },
                        "customWidth": "0",
                        "name": "PieChartbyAppAssigment",
                        "styleSettings": {
                          "margin": "10px 10px"
                        }
                      }
                    ]
                  },
                  "customWidth": "0",
                  "name": "groupAppAssigned",
                  "styleSettings": {
                    "maxWidth": "33%"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"1.0.0\",\"content\":\"[\\r\\n\\t{\\r\\n\\t\\t\\\"PublishingState\\\":\\\"Processing\\\",\\r\\n        \\\"PublishingStateBool\\\":\\\"0\\\"\\r\\n    }\\r\\n]\",\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"columns\":[{\"path\":\"PublishingStateBool\",\"columnid\":\"PublishingStateBool\",\"columnType\":\"long\"},{\"path\":\"PublishingState\",\"columnid\":\"PublishingState\",\"columnType\":\"string\"}]}}]}",
                          "size": 4,
                          "title": "Publishing0",
                          "queryType": 8,
                          "gridSettings": {
                            "sortBy": [
                              {
                                "itemKey": "PublishingStateBool",
                                "sortOrder": 1
                              }
                            ]
                          },
                          "sortBy": [
                            {
                              "itemKey": "PublishingStateBool",
                              "sortOrder": 1
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "hide",
                          "comparison": "isEqualTo",
                          "value": "*"
                        },
                        "name": "Publishing0"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsitencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceAppManagement/mobileApps\",\"urlParams\":[{\"key\":\"$select\",\"value\":\"publishingState\"},{\"key\":\"$top\",\"value\":\"999\"},{\"key\":\"$filter\",\"value\":\"publishingState eq 'published'\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$.publishingState\",\"columnid\":\"PublishingStateBool\",\"columnType\":\"long\",\"substringRegexMatch\":\".*\",\"substringReplace\":\"1\"},{\"path\":\"$.publishingState\",\"columnid\":\"PublishingState\",\"columnType\":\"string\",\"substringRegexMatch\":\".*\",\"substringReplace\":\"Published\"}]}}]}",
                          "size": 4,
                          "title": "queryAppsPublished",
                          "exportToExcelOptions": "all",
                          "queryType": 14,
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Assigned",
                                "formatter": 0,
                                "formatOptions": {
                                  "aggregation": "Count"
                                }
                              }
                            ],
                            "sortBy": [
                              {
                                "itemKey": "PublishingStateBool",
                                "sortOrder": 1
                              }
                            ]
                          },
                          "sortBy": [
                            {
                              "itemKey": "PublishingStateBool",
                              "sortOrder": 1
                            }
                          ],
                          "tileSettings": {
                            "titleContent": {},
                            "leftContent": {
                              "columnMatch": "JailBrokenCount",
                              "formatter": 8,
                              "formatOptions": {
                                "min": 0,
                                "max": 1,
                                "palette": "red",
                                "linkTarget": "GenericDetails",
                                "linkIsContextBlade": true
                              }
                            },
                            "showBorder": true,
                            "size": "auto",
                            "styleSettings": {
                              "borderStyle": "rounded"
                            }
                          },
                          "statSettings": {
                            "valueAggregation": "Count",
                            "colorSettings": {
                              "type": "static",
                              "mode": "foreground",
                              "heatmapPalette": "greenRed",
                              "heatmapMin": 0,
                              "heatmapMax": 1,
                              "thresholdsGrid": []
                            },
                            "iconSettings": {
                              "thresholdsGrid": [
                                {
                                  "operator": ">=",
                                  "thresholdValue": "0",
                                  "representation": "Canceled"
                                }
                              ]
                            },
                            "tagText": "",
                            "valueFontStyle": "auto",
                            "valueTooltipSettings": {
                              "tooltip": "The number of all Applications which are not assigned."
                            },
                            "valueField": "id"
                          }
                        },
                        "customWidth": "0",
                        "conditionalVisibility": {
                          "parameterName": "hide",
                          "comparison": "isEqualTo",
                          "value": "hide"
                        },
                        "name": "queryAppsPublished",
                        "styleSettings": {
                          "margin": "10px 10px"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsitencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceAppManagement/mobileApps\",\"urlParams\":[{\"key\":\"$select\",\"value\":\"publishingState\"},{\"key\":\"$top\",\"value\":\"999\"},{\"key\":\"$filter\",\"value\":\"publishingState eq 'notPublished'\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$.publishingState\",\"columnid\":\"PublishingStateBool\",\"columnType\":\"long\",\"substringRegexMatch\":\".*\",\"substringReplace\":\"1\"},{\"path\":\"$.publishingState\",\"columnid\":\"PublishingState\",\"columnType\":\"string\",\"substringRegexMatch\":\".*\",\"substringReplace\":\"Not Published\"}]}}]}",
                          "size": 4,
                          "title": "queryAppsNotPublished",
                          "exportToExcelOptions": "all",
                          "queryType": 14,
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Assigned",
                                "formatter": 0,
                                "formatOptions": {
                                  "aggregation": "Count"
                                }
                              }
                            ]
                          },
                          "sortBy": [],
                          "tileSettings": {
                            "titleContent": {},
                            "leftContent": {
                              "columnMatch": "JailBrokenCount",
                              "formatter": 8,
                              "formatOptions": {
                                "min": 0,
                                "max": 1,
                                "palette": "red",
                                "linkTarget": "GenericDetails",
                                "linkIsContextBlade": true
                              }
                            },
                            "showBorder": true,
                            "size": "auto",
                            "styleSettings": {
                              "borderStyle": "rounded"
                            }
                          },
                          "statSettings": {
                            "valueAggregation": "Count",
                            "colorSettings": {
                              "type": "static",
                              "mode": "foreground",
                              "heatmapPalette": "greenRed",
                              "heatmapMin": 0,
                              "heatmapMax": 1,
                              "thresholdsGrid": []
                            },
                            "iconSettings": {
                              "thresholdsGrid": [
                                {
                                  "operator": ">=",
                                  "thresholdValue": "0",
                                  "representation": "Canceled"
                                }
                              ]
                            },
                            "tagText": "",
                            "valueFontStyle": "auto",
                            "valueTooltipSettings": {
                              "tooltip": "The number of all Applications which are not assigned."
                            },
                            "valueField": "id"
                          }
                        },
                        "customWidth": "0",
                        "conditionalVisibility": {
                          "parameterName": "hide",
                          "comparison": "isEqualTo",
                          "value": "hide"
                        },
                        "name": "queryAppsNotPublished",
                        "styleSettings": {
                          "margin": "10px 10px"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsitencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceAppManagement/mobileApps\",\"urlParams\":[{\"key\":\"$select\",\"value\":\"publishingState\"},{\"key\":\"$top\",\"value\":\"999\"},{\"key\":\"$filter\",\"value\":\"publishingState eq 'processing'\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$.publishingState\",\"columnid\":\"PublishingStateBool\",\"columnType\":\"long\",\"substringRegexMatch\":\".*\",\"substringReplace\":\"1\"},{\"path\":\"$.publishingState\",\"columnid\":\"PublishingState\",\"columnType\":\"string\",\"substringRegexMatch\":\".*\",\"substringReplace\":\"Processing\"}]}}]}",
                          "size": 4,
                          "title": "queryAppsPublishedProcessing",
                          "exportToExcelOptions": "all",
                          "queryType": 14,
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Assigned",
                                "formatter": 0,
                                "formatOptions": {
                                  "aggregation": "Count"
                                }
                              }
                            ]
                          },
                          "sortBy": [],
                          "tileSettings": {
                            "titleContent": {},
                            "leftContent": {
                              "columnMatch": "JailBrokenCount",
                              "formatter": 8,
                              "formatOptions": {
                                "min": 0,
                                "max": 1,
                                "palette": "red",
                                "linkTarget": "GenericDetails",
                                "linkIsContextBlade": true
                              }
                            },
                            "showBorder": true,
                            "size": "auto",
                            "styleSettings": {
                              "borderStyle": "rounded"
                            }
                          },
                          "statSettings": {
                            "valueAggregation": "Count",
                            "colorSettings": {
                              "type": "static",
                              "mode": "foreground",
                              "heatmapPalette": "greenRed",
                              "heatmapMin": 0,
                              "heatmapMax": 1,
                              "thresholdsGrid": []
                            },
                            "iconSettings": {
                              "thresholdsGrid": [
                                {
                                  "operator": ">=",
                                  "thresholdValue": "0",
                                  "representation": "Canceled"
                                }
                              ]
                            },
                            "tagText": "",
                            "valueFontStyle": "auto",
                            "valueTooltipSettings": {
                              "tooltip": "The number of all Applications which are not assigned."
                            },
                            "valueField": "id"
                          }
                        },
                        "customWidth": "0",
                        "conditionalVisibility": {
                          "parameterName": "hide",
                          "comparison": "isEqualTo",
                          "value": "hide"
                        },
                        "name": "queryAppsPublishedProcessing",
                        "styleSettings": {
                          "margin": "10px 10px"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"82a3fbaa-8e7f-4124-bb7f-1ec9997544a8\",\"mergeType\":\"union\",\"leftTable\":\"Publishing0\",\"rightTable\":\"queryAppsPublishedProcessing\"},{\"id\":\"82a3fbaa-8e7f-4124-bb7f-1ec9997544a9\",\"mergeType\":\"union\",\"leftTable\":\"Publishing0\",\"rightTable\":\"queryAppsNotPublished\"},{\"id\":\"82a3fbaa-8e7f-4124-bb7f-1ec9997544aa\",\"mergeType\":\"union\",\"leftTable\":\"Publishing0\",\"rightTable\":\"queryAppsPublished\"}],\"projectRename\":[{\"originalName\":\"[Publishing0].PublishingState\",\"mergedName\":\"PublishingState\",\"fromId\":\"82a3fbaa-8e7f-4124-bb7f-1ec9997544a8\"},{\"originalName\":\"[Publishing0].PublishingStateBool\",\"mergedName\":\"PublishingStateBool\",\"fromId\":\"82a3fbaa-8e7f-4124-bb7f-1ec9997544a8\"},{\"originalName\":\"PublishingState\",\"mergedName\":\"PublishingState\",\"fromId\":\"unknown\"},{\"originalName\":\"PublishingStateBool\",\"mergedName\":\"PublishingStateBool\",\"fromId\":\"unknown\"}]}",
                          "size": 3,
                          "title": "Apps by Publishing State",
                          "queryType": 7,
                          "visualization": "piechart",
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Published",
                                "label": "",
                                "color": "green",
                                "comment": "The app cannot be assigned unless the app is published. Possible values are: notPublished, processing, published."
                              },
                              {
                                "seriesName": "Not Published",
                                "label": "",
                                "color": "red",
                                "comment": "The app cannot be assigned unless the app is published. Possible values are: notPublished, processing, published."
                              },
                              {
                                "seriesName": "Processing",
                                "color": "orange",
                                "comment": "The app cannot be assigned unless the app is published. Possible values are: notPublished, processing, published."
                              }
                            ]
                          }
                        },
                        "customWidth": "0",
                        "showPin": false,
                        "name": "PieChartbyAppPublishingState",
                        "styleSettings": {
                          "margin": "10px 10px"
                        }
                      }
                    ]
                  },
                  "customWidth": "0",
                  "name": "groupAppPublished",
                  "styleSettings": {
                    "maxWidth": "33%"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"1.0.0\",\"content\":\"[\\r\\n\\t{\\r\\n\\t\\t\\\"Type\\\":\\\"Windows\\\",\\r\\n        \\\"TypeBool\\\":\\\"0\\\"\\r\\n    },\\t\\r\\n\\t{\\r\\n\\t\\t\\\"Type\\\":\\\"Android\\\",\\r\\n        \\\"TypeBool\\\":\\\"0\\\"\\r\\n    },\\t\\r\\n\\t{\\r\\n\\t\\t\\\"Type\\\":\\\"iOS\\\",\\r\\n        \\\"TypeBool\\\":\\\"0\\\"\\r\\n    },\\t\\r\\n\\t{\\r\\n\\t\\t\\\"Type\\\":\\\"MacOS\\\",\\r\\n        \\\"TypeBool\\\":\\\"0\\\"\\r\\n    }\\r\\n]\",\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"columns\":[{\"path\":\"TypeBool\",\"columnid\":\"TypeBool\",\"columnType\":\"long\"},{\"path\":\"Type\",\"columnid\":\"Type\",\"columnType\":\"string\"}]}}]}",
                          "size": 4,
                          "title": "Apptype0",
                          "queryType": 8,
                          "sortBy": []
                        },
                        "conditionalVisibility": {
                          "parameterName": "hide",
                          "comparison": "isEqualTo",
                          "value": "*"
                        },
                        "name": "Apptype0"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsitencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceAppManagement/mobileApps\",\"urlParams\":[{\"key\":\"$top\",\"value\":\"999\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$['@odata.type']\",\"columnid\":\"TypeBool\",\"columnType\":\"long\",\"substringRegexMatch\":\".*mac.*\",\"substringReplace\":\"1\"},{\"path\":\"$['@odata.type']\",\"columnid\":\"Type\",\"columnType\":\"string\",\"substringRegexMatch\":\".*mac.*\",\"substringReplace\":\"MacOS\"}]}}]}",
                          "size": 4,
                          "title": "queryAppsTypeMac",
                          "exportToExcelOptions": "all",
                          "queryType": 14,
                          "visualization": "table",
                          "sortBy": [],
                          "tileSettings": {
                            "titleContent": {},
                            "leftContent": {
                              "columnMatch": "JailBrokenCount",
                              "formatter": 8,
                              "formatOptions": {
                                "min": 0,
                                "max": 1,
                                "palette": "red",
                                "linkTarget": "GenericDetails",
                                "linkIsContextBlade": true
                              }
                            },
                            "showBorder": true,
                            "size": "auto",
                            "styleSettings": {
                              "borderStyle": "rounded"
                            }
                          },
                          "statSettings": {
                            "valueAggregation": "Count",
                            "colorSettings": {
                              "type": "static",
                              "mode": "foreground",
                              "heatmapPalette": "greenRed",
                              "heatmapMin": 0,
                              "heatmapMax": 1,
                              "thresholdsGrid": []
                            },
                            "iconSettings": {
                              "thresholdsGrid": [
                                {
                                  "operator": ">=",
                                  "thresholdValue": "0",
                                  "representation": "Canceled"
                                }
                              ]
                            },
                            "tagText": "",
                            "valueFontStyle": "auto",
                            "valueTooltipSettings": {
                              "tooltip": "The number of all Applications which are not assigned."
                            },
                            "valueField": "id"
                          }
                        },
                        "customWidth": "0",
                        "conditionalVisibility": {
                          "parameterName": "hide",
                          "comparison": "isEqualTo",
                          "value": "hide"
                        },
                        "name": "queryAppsTypeMac",
                        "styleSettings": {
                          "margin": "10px 10px"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsitencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceAppManagement/mobileApps\",\"urlParams\":[{\"key\":\"$top\",\"value\":\"999\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$['@odata.type']\",\"columnid\":\"Type\",\"columnType\":\"string\",\"substringRegexMatch\":\".*win.*\",\"substringReplace\":\"Windows\"},{\"path\":\"$['@odata.type']\",\"columnid\":\"TypeBool\",\"columnType\":\"long\",\"substringRegexMatch\":\".*win.*\",\"substringReplace\":\"1\"}]}}]}",
                          "size": 4,
                          "title": "queryAppsTypeWindows",
                          "exportToExcelOptions": "all",
                          "queryType": 14,
                          "visualization": "table",
                          "sortBy": [],
                          "tileSettings": {
                            "titleContent": {},
                            "leftContent": {
                              "columnMatch": "JailBrokenCount",
                              "formatter": 8,
                              "formatOptions": {
                                "min": 0,
                                "max": 1,
                                "palette": "red",
                                "linkTarget": "GenericDetails",
                                "linkIsContextBlade": true
                              }
                            },
                            "showBorder": true,
                            "size": "auto",
                            "styleSettings": {
                              "borderStyle": "rounded"
                            }
                          },
                          "statSettings": {
                            "valueAggregation": "Count",
                            "colorSettings": {
                              "type": "static",
                              "mode": "foreground",
                              "heatmapPalette": "greenRed",
                              "heatmapMin": 0,
                              "heatmapMax": 1,
                              "thresholdsGrid": []
                            },
                            "iconSettings": {
                              "thresholdsGrid": [
                                {
                                  "operator": ">=",
                                  "thresholdValue": "0",
                                  "representation": "Canceled"
                                }
                              ]
                            },
                            "tagText": "",
                            "valueFontStyle": "auto",
                            "valueTooltipSettings": {
                              "tooltip": "The number of all Applications which are not assigned."
                            },
                            "valueField": "id"
                          }
                        },
                        "customWidth": "0",
                        "conditionalVisibility": {
                          "parameterName": "hide",
                          "comparison": "isEqualTo",
                          "value": "hide"
                        },
                        "name": "queryAppsTypeWindows",
                        "styleSettings": {
                          "margin": "10px 10px"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsitencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceAppManagement/mobileApps\",\"urlParams\":[{\"key\":\"$top\",\"value\":\"999\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$['@odata.type']\",\"columnid\":\"Type\",\"columnType\":\"string\",\"substringRegexMatch\":\".*ios.*\",\"substringReplace\":\"iOS\"},{\"path\":\"$['@odata.type']\",\"columnid\":\"TypeBool\",\"columnType\":\"long\",\"substringRegexMatch\":\".*ios.*\",\"substringReplace\":\"1\"}]}}]}",
                          "size": 4,
                          "title": "queryAppsTypeios",
                          "exportToExcelOptions": "all",
                          "queryType": 14,
                          "visualization": "table",
                          "sortBy": [],
                          "tileSettings": {
                            "titleContent": {},
                            "leftContent": {
                              "columnMatch": "JailBrokenCount",
                              "formatter": 8,
                              "formatOptions": {
                                "min": 0,
                                "max": 1,
                                "palette": "red",
                                "linkTarget": "GenericDetails",
                                "linkIsContextBlade": true
                              }
                            },
                            "showBorder": true,
                            "size": "auto",
                            "styleSettings": {
                              "borderStyle": "rounded"
                            }
                          },
                          "statSettings": {
                            "valueAggregation": "Count",
                            "colorSettings": {
                              "type": "static",
                              "mode": "foreground",
                              "heatmapPalette": "greenRed",
                              "heatmapMin": 0,
                              "heatmapMax": 1,
                              "thresholdsGrid": []
                            },
                            "iconSettings": {
                              "thresholdsGrid": [
                                {
                                  "operator": ">=",
                                  "thresholdValue": "0",
                                  "representation": "Canceled"
                                }
                              ]
                            },
                            "tagText": "",
                            "valueFontStyle": "auto",
                            "valueTooltipSettings": {
                              "tooltip": "The number of all Applications which are not assigned."
                            },
                            "valueField": "id"
                          }
                        },
                        "customWidth": "0",
                        "conditionalVisibility": {
                          "parameterName": "hide",
                          "comparison": "isEqualTo",
                          "value": "hide"
                        },
                        "name": "queryAppsTypeios",
                        "styleSettings": {
                          "margin": "10px 10px"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsitencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceAppManagement/mobileApps\",\"urlParams\":[{\"key\":\"$top\",\"value\":\"999\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$['@odata.type']\",\"columnid\":\"Type\",\"columnType\":\"string\",\"substringRegexMatch\":\".*android.*\",\"substringReplace\":\"android\"},{\"path\":\"$['@odata.type']\",\"columnid\":\"TypeBool\",\"columnType\":\"long\",\"substringRegexMatch\":\".*android.*\",\"substringReplace\":\"1\"}]}}]}",
                          "size": 4,
                          "title": "queryAppsTypeAndroid",
                          "exportToExcelOptions": "all",
                          "queryType": 14,
                          "visualization": "table",
                          "sortBy": [],
                          "tileSettings": {
                            "titleContent": {},
                            "leftContent": {
                              "columnMatch": "JailBrokenCount",
                              "formatter": 8,
                              "formatOptions": {
                                "min": 0,
                                "max": 1,
                                "palette": "red",
                                "linkTarget": "GenericDetails",
                                "linkIsContextBlade": true
                              }
                            },
                            "showBorder": true,
                            "size": "auto",
                            "styleSettings": {
                              "borderStyle": "rounded"
                            }
                          },
                          "statSettings": {
                            "valueAggregation": "Count",
                            "colorSettings": {
                              "type": "static",
                              "mode": "foreground",
                              "heatmapPalette": "greenRed",
                              "heatmapMin": 0,
                              "heatmapMax": 1,
                              "thresholdsGrid": []
                            },
                            "iconSettings": {
                              "thresholdsGrid": [
                                {
                                  "operator": ">=",
                                  "thresholdValue": "0",
                                  "representation": "Canceled"
                                }
                              ]
                            },
                            "tagText": "",
                            "valueFontStyle": "auto",
                            "valueTooltipSettings": {
                              "tooltip": "The number of all Applications which are not assigned."
                            },
                            "valueField": "id"
                          }
                        },
                        "customWidth": "0",
                        "conditionalVisibility": {
                          "parameterName": "hide",
                          "comparison": "isEqualTo",
                          "value": "hide"
                        },
                        "name": "queryAppsTypeAndroid",
                        "styleSettings": {
                          "margin": "10px 10px"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsitencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceAppManagement/mobileApps\",\"urlParams\":[{\"key\":\"$top\",\"value\":\"999\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$['@odata.type']\",\"columnid\":\"Type\",\"columnType\":\"string\",\"substringRegexMatch\":\".*officeSuiteApp.*\",\"substringReplace\":\"officeSuiteApp\"},{\"path\":\"$['@odata.type']\",\"columnid\":\"TypeBool\",\"columnType\":\"long\",\"substringRegexMatch\":\".*officeSuiteApp.*\",\"substringReplace\":\"1\"}]}}]}",
                          "size": 4,
                          "title": "queryAppsTypeOfficeSuite",
                          "exportToExcelOptions": "all",
                          "queryType": 14,
                          "visualization": "table",
                          "sortBy": [],
                          "tileSettings": {
                            "titleContent": {},
                            "leftContent": {
                              "columnMatch": "JailBrokenCount",
                              "formatter": 8,
                              "formatOptions": {
                                "min": 0,
                                "max": 1,
                                "palette": "red",
                                "linkTarget": "GenericDetails",
                                "linkIsContextBlade": true
                              }
                            },
                            "showBorder": true,
                            "size": "auto",
                            "styleSettings": {
                              "borderStyle": "rounded"
                            }
                          },
                          "statSettings": {
                            "valueAggregation": "Count",
                            "colorSettings": {
                              "type": "static",
                              "mode": "foreground",
                              "heatmapPalette": "greenRed",
                              "heatmapMin": 0,
                              "heatmapMax": 1,
                              "thresholdsGrid": []
                            },
                            "iconSettings": {
                              "thresholdsGrid": [
                                {
                                  "operator": ">=",
                                  "thresholdValue": "0",
                                  "representation": "Canceled"
                                }
                              ]
                            },
                            "tagText": "",
                            "valueFontStyle": "auto",
                            "valueTooltipSettings": {
                              "tooltip": "The number of all Applications which are not assigned."
                            },
                            "valueField": "id"
                          }
                        },
                        "customWidth": "0",
                        "conditionalVisibility": {
                          "parameterName": "hide",
                          "comparison": "isEqualTo",
                          "value": "hide"
                        },
                        "name": "queryAppsTypeOfficeSuite",
                        "styleSettings": {
                          "margin": "10px 10px"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"82a3fbaa-8e7f-4124-bb7f-1ec9997544a9\",\"mergeType\":\"union\",\"leftTable\":\"Apptype0\",\"rightTable\":\"queryAppsTypeMac\"},{\"id\":\"82a3fbaa-8e7f-4124-bb7f-1ec9997544aa\",\"mergeType\":\"union\",\"leftTable\":\"Apptype0\",\"rightTable\":\"queryAppsTypeWindows\"},{\"id\":\"82a3fbaa-8e7f-4124-bb7f-1ec999754591\",\"mergeType\":\"union\",\"leftTable\":\"Apptype0\",\"rightTable\":\"queryAppsTypeios\"},{\"id\":\"82a3fbaa-8e7f-4124-bb7f-1ec99975459c\",\"mergeType\":\"union\",\"leftTable\":\"Apptype0\",\"rightTable\":\"queryAppsTypeAndroid\"},{\"id\":\"82a3fbaa-8e7f-4124-bb7f-1ec99975459d\",\"mergeType\":\"union\",\"leftTable\":\"Apptype0\",\"rightTable\":\"queryAppsTypeOfficeSuite\"}],\"projectRename\":[{\"originalName\":\"PublishingState\",\"mergedName\":\"PublishingState\",\"fromId\":\"unknown\"},{\"originalName\":\"PublishingStateBool\",\"mergedName\":\"PublishingStateBool\",\"fromId\":\"unknown\"},{\"originalName\":\"[queryAppsPublished].@odata.context\",\"mergedName\":\"@odata.context\",\"fromId\":\"unknown\"},{\"originalName\":\"[queryAppsPublished].@odata.count\",\"mergedName\":\"@odata.count\",\"fromId\":\"unknown\"},{\"originalName\":\"[queryAppsPublished].value\",\"mergedName\":\"value\",\"fromId\":\"unknown\"},{\"originalName\":\"[queryAppsPublished].defaultVisualization\",\"mergedName\":\"defaultVisualization\",\"fromId\":\"unknown\"},{\"originalName\":\"[Apptype0].TypeBool\",\"mergedName\":\"TypeBool\",\"fromId\":\"82a3fbaa-8e7f-4124-bb7f-1ec9997544a9\"},{\"originalName\":\"[Apptype0].Type\",\"mergedName\":\"Type\",\"fromId\":\"82a3fbaa-8e7f-4124-bb7f-1ec9997544a9\"},{\"originalName\":\"TypeBool\",\"mergedName\":\"TypeBool\",\"fromId\":\"unknown\"},{\"originalName\":\"Type\",\"mergedName\":\"Type\",\"fromId\":\"unknown\"}]}",
                          "size": 3,
                          "title": "Apps by Operating System",
                          "queryType": 7,
                          "visualization": "piechart",
                          "chartSettings": {
                            "group": "Type",
                            "createOtherGroup": 4,
                            "seriesLabelSettings": [
                              {
                                "seriesName": "MacOS",
                                "color": "amethyst"
                              },
                              {
                                "seriesName": "Windows",
                                "color": "blue"
                              },
                              {
                                "seriesName": "iOS",
                                "color": "red"
                              },
                              {
                                "seriesName": "Android",
                                "color": "green"
                              },
                              {
                                "seriesName": "officeSuiteApp",
                                "color": "orange"
                              }
                            ]
                          }
                        },
                        "customWidth": "0",
                        "showPin": false,
                        "name": "PieChartbyAppOperatingSystem",
                        "styleSettings": {
                          "margin": "10px 10px"
                        }
                      }
                    ]
                  },
                  "customWidth": "0",
                  "name": "groupAppPublished - Copy",
                  "styleSettings": {
                    "maxWidth": "33%"
                  }
                }
              ]
            },
            "name": "groupOverviewApp"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "tab",
        "comparison": "isEqualTo",
        "value": "Overview"
      },
      "name": "OverviewGroup"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "parameters": [
                      {
                        "id": "5b796597-205c-4b14-9a7c-d9a88ec6eeae",
                        "version": "KqlParameterItem/1.0",
                        "name": "OverviewLast1h",
                        "label": "1h",
                        "type": 4,
                        "isRequired": true,
                        "isHiddenWhenLocked": true,
                        "typeSettings": {
                          "selectableValues": [
                            {
                              "durationMs": 3600000
                            }
                          ],
                          "allowCustom": false
                        },
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "value": {
                          "durationMs": 3600000
                        }
                      },
                      {
                        "version": "KqlParameterItem/1.0",
                        "name": "OverviewLast12h",
                        "label": "12h",
                        "type": 4,
                        "isRequired": true,
                        "isHiddenWhenLocked": true,
                        "typeSettings": {
                          "selectableValues": [
                            {
                              "durationMs": 43200000
                            }
                          ],
                          "allowCustom": false
                        },
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "value": {
                          "durationMs": 43200000
                        },
                        "id": "44263ba2-da58-4963-b49d-28a5b498a231"
                      },
                      {
                        "version": "KqlParameterItem/1.0",
                        "name": "OverviewLast7d",
                        "label": "7d",
                        "type": 4,
                        "isRequired": true,
                        "isHiddenWhenLocked": true,
                        "typeSettings": {
                          "selectableValues": [
                            {
                              "durationMs": 604800000
                            },
                            {
                              "durationMs": 7776000000
                            }
                          ],
                          "allowCustom": false
                        },
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "value": {
                          "durationMs": 604800000
                        },
                        "id": "4cf95ade-ed58-40b1-aef8-e90c25f7c63b"
                      }
                    ],
                    "style": "pills",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "name": "deviceParameters"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"lastSyncDateTime ge {OverviewLast1h:startISO} and lastSyncDateTime le {OverviewLast1h:endISO}\"},{\"key\":\"$count\",\"value\":\"true\"},{\"key\":\"$top\",\"value\":\"0\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"\",\"columns\":[{\"path\":\"$..['@odata.count']\",\"columnid\":\"Count\",\"columnType\":\"long\"}]}}]}",
                    "size": 4,
                    "title": "Active Devices < 1h",
                    "exportToExcelOptions": "all",
                    "queryType": 14,
                    "visualization": "stat",
                    "sortBy": [],
                    "tileSettings": {
                      "titleContent": {},
                      "leftContent": {
                        "columnMatch": "JailBrokenCount",
                        "formatter": 8,
                        "formatOptions": {
                          "min": 0,
                          "max": 1,
                          "palette": "red",
                          "linkTarget": "GenericDetails",
                          "linkIsContextBlade": true
                        }
                      },
                      "showBorder": true,
                      "size": "auto",
                      "styleSettings": {
                        "borderStyle": "rounded"
                      }
                    },
                    "statSettings": {
                      "valueAggregation": "None",
                      "colorSettings": {
                        "type": "static",
                        "mode": "foreground",
                        "heatmapPalette": "greenRed",
                        "heatmapMin": 0,
                        "heatmapMax": 1,
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": ">=",
                            "thresholdValue": "0",
                            "representation": "Discovery"
                          }
                        ]
                      },
                      "tagText": "",
                      "valueFontStyle": "auto",
                      "valueTooltipSettings": {
                        "tooltip": "The number of devices contacted Intune in the last 24 hours."
                      },
                      "linkSettings": {
                        "linkTarget": "GenericDetails",
                        "linkIsContextBlade": true
                      }
                    }
                  },
                  "customWidth": "0",
                  "showPin": false,
                  "name": "ActiveDevices1h",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"lastSyncDateTime ge {OverviewLast12h:startISO} and lastSyncDateTime le {OverviewLast12h:endISO}\"},{\"key\":\"$count\",\"value\":\"true\"},{\"key\":\"$top\",\"value\":\"0\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"\",\"columns\":[{\"path\":\"$..['@odata.count']\",\"columnid\":\"Count\",\"columnType\":\"long\"}]}}]}",
                    "size": 4,
                    "title": "Active Devices < 12h",
                    "exportToExcelOptions": "all",
                    "queryType": 14,
                    "visualization": "stat",
                    "sortBy": [],
                    "tileSettings": {
                      "titleContent": {},
                      "leftContent": {
                        "columnMatch": "JailBrokenCount",
                        "formatter": 8,
                        "formatOptions": {
                          "min": 0,
                          "max": 1,
                          "palette": "red",
                          "linkTarget": "GenericDetails",
                          "linkIsContextBlade": true
                        }
                      },
                      "showBorder": true,
                      "size": "auto",
                      "styleSettings": {
                        "borderStyle": "rounded"
                      }
                    },
                    "statSettings": {
                      "valueAggregation": "None",
                      "colorSettings": {
                        "type": "static",
                        "mode": "foreground",
                        "heatmapPalette": "greenRed",
                        "heatmapMin": 0,
                        "heatmapMax": 1,
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": ">=",
                            "thresholdValue": "0",
                            "representation": "Discovery"
                          }
                        ]
                      },
                      "tagText": "",
                      "valueFontStyle": "auto",
                      "valueTooltipSettings": {
                        "tooltip": "The number of devices contacted Intune in the last 24 hours."
                      },
                      "linkSettings": {
                        "linkTarget": "GenericDetails",
                        "linkIsContextBlade": true
                      }
                    }
                  },
                  "customWidth": "0",
                  "showPin": false,
                  "name": "ActiveDevices12h",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"managementState eq 'wipePending'\"},{\"key\":\"$count\",\"value\":\"true\"},{\"key\":\"$top\",\"value\":\"0\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"\",\"columns\":[{\"path\":\"$..['@odata.count']\",\"columnid\":\"Count\",\"columnType\":\"long\"}]}}]}",
                    "size": 4,
                    "title": "Device Wipe Pending",
                    "exportToExcelOptions": "all",
                    "queryType": 14,
                    "visualization": "stat",
                    "sortBy": [],
                    "tileSettings": {
                      "titleContent": {},
                      "leftContent": {
                        "columnMatch": "JailBrokenCount",
                        "formatter": 8,
                        "formatOptions": {
                          "min": 0,
                          "max": 1,
                          "palette": "red",
                          "linkTarget": "GenericDetails",
                          "linkIsContextBlade": true
                        }
                      },
                      "showBorder": true,
                      "size": "auto",
                      "styleSettings": {
                        "borderStyle": "rounded"
                      }
                    },
                    "statSettings": {
                      "valueAggregation": "None",
                      "colorSettings": {
                        "type": "static",
                        "mode": "foreground",
                        "heatmapPalette": "greenRed",
                        "heatmapMin": 0,
                        "heatmapMax": 1,
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": ">=",
                            "thresholdValue": "0",
                            "representation": "pending"
                          }
                        ]
                      },
                      "tagText": "",
                      "valueFontStyle": "auto",
                      "valueTooltipSettings": {
                        "tooltip": "The number of devices with pending device wipe."
                      },
                      "linkSettings": {
                        "linkTarget": "GenericDetails",
                        "linkIsContextBlade": true
                      }
                    }
                  },
                  "customWidth": "0",
                  "showPin": false,
                  "name": "Device Wipe Pending",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"ownerType eq 'personal' and operatingSystem eq 'Windows'\"},{\"key\":\"$count\",\"value\":\"true\"},{\"key\":\"$top\",\"value\":\"0\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"\",\"columns\":[{\"path\":\"$..['@odata.count']\",\"columnid\":\"Count\",\"columnType\":\"long\"}]}}]}",
                    "size": 4,
                    "title": "Personal Devices",
                    "exportToExcelOptions": "all",
                    "queryType": 14,
                    "visualization": "stat",
                    "sortBy": [],
                    "tileSettings": {
                      "titleContent": {},
                      "leftContent": {
                        "columnMatch": "JailBrokenCount",
                        "formatter": 8,
                        "formatOptions": {
                          "min": 0,
                          "max": 1,
                          "palette": "red",
                          "linkTarget": "GenericDetails",
                          "linkIsContextBlade": true
                        }
                      },
                      "showBorder": true,
                      "size": "auto",
                      "styleSettings": {
                        "borderStyle": "rounded"
                      }
                    },
                    "statSettings": {
                      "valueAggregation": "None",
                      "colorSettings": {
                        "type": "static",
                        "mode": "foreground",
                        "heatmapPalette": "greenRed",
                        "heatmapMin": 0,
                        "heatmapMax": 1,
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": ">=",
                            "thresholdValue": "0",
                            "representation": "Person"
                          }
                        ]
                      },
                      "tagText": "Windows",
                      "valueFontStyle": "auto",
                      "valueTooltipSettings": {
                        "tooltip": "The number of devices in Intune Personally-owned."
                      },
                      "linkSettings": {
                        "linkTarget": "GenericDetails",
                        "linkIsContextBlade": true
                      }
                    }
                  },
                  "customWidth": "0",
                  "showPin": false,
                  "name": "Windows Personal-owned Devices",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"ownerType eq 'personal' and operatingSystem eq 'macOS'\"},{\"key\":\"$count\",\"value\":\"true\"},{\"key\":\"$top\",\"value\":\"0\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"\",\"columns\":[{\"path\":\"$..['@odata.count']\",\"columnid\":\"Count\",\"columnType\":\"long\"}]}}]}",
                    "size": 4,
                    "title": "Personal Devices",
                    "exportToExcelOptions": "all",
                    "queryType": 14,
                    "visualization": "stat",
                    "sortBy": [],
                    "tileSettings": {
                      "titleContent": {},
                      "leftContent": {
                        "columnMatch": "JailBrokenCount",
                        "formatter": 8,
                        "formatOptions": {
                          "min": 0,
                          "max": 1,
                          "palette": "red",
                          "linkTarget": "GenericDetails",
                          "linkIsContextBlade": true
                        }
                      },
                      "showBorder": true,
                      "size": "auto",
                      "styleSettings": {
                        "borderStyle": "rounded"
                      }
                    },
                    "statSettings": {
                      "valueAggregation": "None",
                      "colorSettings": {
                        "type": "static",
                        "mode": "foreground",
                        "heatmapPalette": "greenRed",
                        "heatmapMin": 0,
                        "heatmapMax": 1,
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": ">=",
                            "thresholdValue": "0",
                            "representation": "Person"
                          }
                        ]
                      },
                      "tagText": "MacOS",
                      "valueFontStyle": "auto",
                      "valueTooltipSettings": {
                        "tooltip": "The number of devices in Intune Personally-owned."
                      },
                      "linkSettings": {
                        "linkTarget": "GenericDetails",
                        "linkIsContextBlade": true
                      }
                    }
                  },
                  "customWidth": "0",
                  "showPin": false,
                  "name": "MacOS Personal-owned Devices",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"ownerType eq 'personal' and operatingSystem eq 'iOS'\"},{\"key\":\"$count\",\"value\":\"true\"},{\"key\":\"$top\",\"value\":\"0\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"\",\"columns\":[{\"path\":\"$..['@odata.count']\",\"columnid\":\"Count\",\"columnType\":\"long\"}]}}]}",
                    "size": 4,
                    "title": "Personal Devices",
                    "exportToExcelOptions": "all",
                    "queryType": 14,
                    "visualization": "stat",
                    "sortBy": [],
                    "tileSettings": {
                      "titleContent": {},
                      "leftContent": {
                        "columnMatch": "JailBrokenCount",
                        "formatter": 8,
                        "formatOptions": {
                          "min": 0,
                          "max": 1,
                          "palette": "red",
                          "linkTarget": "GenericDetails",
                          "linkIsContextBlade": true
                        }
                      },
                      "showBorder": true,
                      "size": "auto",
                      "styleSettings": {
                        "borderStyle": "rounded"
                      }
                    },
                    "statSettings": {
                      "valueAggregation": "None",
                      "colorSettings": {
                        "type": "static",
                        "mode": "foreground",
                        "heatmapPalette": "greenRed",
                        "heatmapMin": 0,
                        "heatmapMax": 1,
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": ">=",
                            "thresholdValue": "0",
                            "representation": "Person"
                          }
                        ]
                      },
                      "tagText": "iOS",
                      "valueFontStyle": "auto",
                      "valueTooltipSettings": {
                        "tooltip": "The number of devices in Intune Personally-owned."
                      },
                      "linkSettings": {
                        "linkTarget": "GenericDetails",
                        "linkIsContextBlade": true
                      }
                    }
                  },
                  "customWidth": "0",
                  "showPin": false,
                  "name": "iOS Personal-owned Devices",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"ownerType eq 'personal' and operatingSystem eq 'Android'\"},{\"key\":\"$count\",\"value\":\"true\"},{\"key\":\"$top\",\"value\":\"0\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"\",\"columns\":[{\"path\":\"$..['@odata.count']\",\"columnid\":\"Count\",\"columnType\":\"long\"}]}}]}",
                    "size": 4,
                    "title": "Personal Devices",
                    "exportToExcelOptions": "all",
                    "queryType": 14,
                    "visualization": "stat",
                    "sortBy": [],
                    "tileSettings": {
                      "titleContent": {},
                      "leftContent": {
                        "columnMatch": "JailBrokenCount",
                        "formatter": 8,
                        "formatOptions": {
                          "min": 0,
                          "max": 1,
                          "palette": "red",
                          "linkTarget": "GenericDetails",
                          "linkIsContextBlade": true
                        }
                      },
                      "showBorder": true,
                      "size": "auto",
                      "styleSettings": {
                        "borderStyle": "rounded"
                      }
                    },
                    "statSettings": {
                      "valueAggregation": "None",
                      "colorSettings": {
                        "type": "static",
                        "mode": "foreground",
                        "heatmapPalette": "greenRed",
                        "heatmapMin": 0,
                        "heatmapMax": 1,
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": ">=",
                            "thresholdValue": "0",
                            "representation": "Person"
                          }
                        ]
                      },
                      "tagText": "Android",
                      "valueFontStyle": "auto",
                      "valueTooltipSettings": {
                        "tooltip": "The number of devices in Intune Personally-owned."
                      },
                      "linkSettings": {
                        "linkTarget": "GenericDetails",
                        "linkIsContextBlade": true
                      }
                    }
                  },
                  "customWidth": "0",
                  "showPin": false,
                  "name": "Android Personal-owned Devices",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                }
              ]
            },
            "name": "DeivceStatGroup"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Checked In Devices to Intune",
              "expandable": true,
              "expanded": true,
              "items": [
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "parameters": [
                      {
                        "id": "5b796597-205c-4b14-9a7c-d9a88ec6eeae",
                        "version": "KqlParameterItem/1.0",
                        "name": "Last",
                        "label": "Time Span",
                        "type": 4,
                        "isRequired": true,
                        "typeSettings": {
                          "selectableValues": [
                            {
                              "durationMs": 300000
                            },
                            {
                              "durationMs": 900000
                            },
                            {
                              "durationMs": 1800000
                            },
                            {
                              "durationMs": 3600000
                            },
                            {
                              "durationMs": 14400000
                            },
                            {
                              "durationMs": 43200000
                            },
                            {
                              "durationMs": 86400000
                            },
                            {
                              "durationMs": 172800000
                            },
                            {
                              "durationMs": 259200000
                            },
                            {
                              "durationMs": 604800000
                            },
                            {
                              "durationMs": 1209600000
                            },
                            {
                              "durationMs": 2419200000
                            },
                            {
                              "durationMs": 2592000000
                            },
                            {
                              "durationMs": 5184000000
                            },
                            {
                              "durationMs": 7776000000
                            }
                          ],
                          "allowCustom": true
                        },
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "value": {
                          "durationMs": 86400000
                        },
                        "description": "Select the time range for which you want to display device data (e.g. last 24 hours, 7 days, 30 days, etc.)."
                      },
                      {
                        "id": "6d0a9d93-6513-4e60-8f28-928dbae763cb",
                        "version": "KqlParameterItem/1.0",
                        "name": "ownerType",
                        "label": "Owner Type",
                        "type": 2,
                        "isRequired": true,
                        "typeSettings": {
                          "additionalResourceOptions": [],
                          "showDefault": false
                        },
                        "jsonData": "[\r\n    {\r\n         \"value\": \"and (ownerType eq 'company' and ownerType eq 'personal')\",\r\n         \"label\": \"Any\",\r\n         \"selected\": \"true\"\r\n    },\r\n    {\r\n         \"value\": \"and (ownerType eq 'personal')\",\r\n         \"label\": \"Personal\"\r\n    },\r\n    {\r\n         \"value\": \"and (ownerType eq 'company')\",\r\n         \"label\": \"Company\"\r\n    }\r\n]",
                        "description": "Filter the devices based on their ownership type: company-owned, personally owned, or both.",
                        "timeContext": {
                          "durationMs": 86400000
                        }
                      },
                      {
                        "version": "KqlParameterItem/1.0",
                        "name": "deviceOS",
                        "label": "OS",
                        "type": 11,
                        "isRequired": true,
                        "typeSettings": {
                          "additionalResourceOptions": [],
                          "showDefault": false
                        },
                        "jsonData": "[\r\n    {\r\n         \"value\": \"managementAgent eq 'mdm'\",\r\n         \"label\": \"Any\",\r\n         \"selected\": \"true\"\r\n    },\r\n    {\r\n         \"value\": \"operatingSystem eq 'Windows'\",\r\n         \"label\": \"Windows\"\r\n    },\r\n    {\r\n         \"value\": \"operatingSystem eq 'iOS'\",\r\n         \"label\": \"iOS\"\r\n    },\r\n    {\r\n         \"value\": \"operatingSystem eq 'Android'\",\r\n         \"label\": \"Android\"\r\n    },\r\n    {\r\n         \"value\": \"operatingSystem eq 'macOS'\",\r\n         \"label\": \"Mac OS\"\r\n    },\r\n    {\r\n         \"value\": \"deviceType eq 'linux'\",\r\n         \"label\": \"Linux\"\r\n    }\r\n]",
                        "description": "Choose which device operating system to filter by, such as Windows, macOS, iOS, Android, or Linux.",
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "id": "8aa1fab0-b453-4b66-9898-1c14b2a2dec9"
                      }
                    ],
                    "style": "pills",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "name": "deviceParameters"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsitencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"{deviceOS:value} and lastSyncDateTime ge {Last:startISO} and lastSyncDateTime le {Last:endISO} {ownerType:value}\"},{\"key\":\"$select\",\"value\":\"deviceName,userPrincipalName,lastSyncDateTime,complianceState,operatingSystem,ownerType,Id\"},{\"key\":\"$top\",\"value\":\"999\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$.deviceName\",\"columnid\":\"Device_Name\",\"columnType\":\"string\"},{\"path\":\"$.userPrincipalName\",\"columnid\":\"User_Principal_Name\",\"columnType\":\"string\"},{\"path\":\"$.lastSyncDateTime\",\"columnid\":\"Last_Sync_Date_Time\",\"columnType\":\"datetime\"},{\"path\":\"$.complianceState\",\"columnid\":\"Compliance_State\",\"columnType\":\"string\"},{\"path\":\"$.operatingSystem\",\"columnid\":\"Operating_System\",\"columnType\":\"string\"},{\"path\":\"$.ownerType\",\"columnid\":\"Owner_Type\",\"columnType\":\"string\"},{\"path\":\"$.id\",\"columnid\":\"ID\"}]}}]}",
                    "size": 1,
                    "title": "Devices check in to Intune | {Last:startISO} - {Last:endISO}",
                    "showExportToExcel": true,
                    "queryType": 14,
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Device_Name",
                          "formatter": 1,
                          "formatOptions": {
                            "workbookContext": {
                              "componentIdSource": "workbook",
                              "resourceIdsSource": "workbook",
                              "templateIdSource": "cell",
                              "typeSource": "workbook",
                              "gallerySource": "workbook",
                              "locationSource": "default",
                              "viewerMode": true
                            }
                          }
                        },
                        {
                          "columnMatch": "Compliance_State",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "noncompliant",
                                "representation": "4",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "success",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "ID",
                          "formatter": 5
                        }
                      ],
                      "rowLimit": 1000,
                      "filter": true,
                      "labelSettings": [
                        {
                          "columnId": "Device_Name",
                          "label": "Device Name"
                        },
                        {
                          "columnId": "User_Principal_Name",
                          "label": "User Principal Name"
                        },
                        {
                          "columnId": "Last_Sync_Date_Time",
                          "label": "Last Sync Date Time"
                        },
                        {
                          "columnId": "Compliance_State",
                          "label": "Compliance State"
                        },
                        {
                          "columnId": "Operating_System",
                          "label": "Operating System"
                        },
                        {
                          "columnId": "Owner_Type",
                          "label": "Owner Type"
                        }
                      ]
                    },
                    "sortBy": []
                  },
                  "name": "queryDeviceCheckIn"
                }
              ]
            },
            "name": "groupCurrentlyCheckIn"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Remote Actions Audit",
              "expandable": true,
              "expanded": true,
              "items": [
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "parameters": [
                      {
                        "id": "52d009f0-49e6-4866-a7dc-2d77bd0f1364",
                        "version": "KqlParameterItem/1.0",
                        "name": "ActionState",
                        "label": "Action State",
                        "type": 10,
                        "isRequired": true,
                        "typeSettings": {
                          "additionalResourceOptions": [],
                          "showDefault": false
                        },
                        "jsonData": "[\r\n   { \r\n        \"value\": \"actionState has 'done' and actionState has 'pending'\",\r\n        \"label\": \"All\",\r\n        \"selected\":true \r\n   },\r\n   { \r\n        \"value\": \"actionState has 'pending'\",\r\n        \"label\": \"Pending\" \r\n   },\r\n   { \r\n        \"value\": \"actionState has 'done'\",\r\n        \"label\": \"Success\"\r\n   }\r\n]",
                        "description": "Filter actions based on their state: show all actions, only those that are still pending, or only those that were successfully completed.",
                        "timeContext": {
                          "durationMs": 86400000
                        }
                      },
                      {
                        "id": "d3c2f147-1bee-4e12-9974-1682af3aad7f",
                        "version": "KqlParameterItem/1.0",
                        "name": "LastActions",
                        "label": "Last Actions",
                        "type": 2,
                        "description": "Choose how many of the most recent actions should be displayed in the results (e.g. last 20, 50, 100, etc.).",
                        "isRequired": true,
                        "typeSettings": {
                          "additionalResourceOptions": [],
                          "showDefault": false
                        },
                        "jsonData": "[\r\n    {\r\n        \"value\": \"20\",\r\n        \"label\": \"20\"\r\n        },\r\n        {\r\n             \"value\": \"50\",\r\n              \"label\": \"50\"\r\n        },\r\n        {\r\n             \"value\": \"100\",\r\n              \"label\": \"100\",\r\n        \"selected\":true \r\n        },\r\n        {\r\n             \"value\": \"200\",\r\n              \"label\": \"200\"\r\n        },\r\n        {\r\n             \"value\": \"1000\",\r\n              \"label\": \"1000\"\r\n        }\r\n]",
                        "value": "50"
                      }
                    ],
                    "style": "pills",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "name": "parameters - 3"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$select\",\"value\":\"deviceName,operatingSystem,userPrincipalName\"},{\"key\":\"$top\",\"value\":\"999\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[]}}]}",
                    "size": 4,
                    "queryType": 14,
                    "gridSettings": {
                      "rowLimit": 1000,
                      "filter": true
                    },
                    "sortBy": []
                  },
                  "conditionalVisibility": {
                    "parameterName": "hide",
                    "comparison": "isEqualTo",
                    "value": "hide"
                  },
                  "name": "RemoteActionsAuditAllDevicesToMerge "
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/remoteActionAudits\",\"urlParams\":[{\"key\":\"$select\",\"value\":\"deviceDisplayName,userName,action,actionState,initiatedByUserPrincipalName,requestDateTime\"},{\"key\":\"$filter\",\"value\":\"{ActionState}\"},{\"key\":\"$top\",\"value\":\"{LastActions}\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$.deviceDisplayName\",\"columnid\":\"Device_Display_Name\",\"columnType\":\"string\"},{\"path\":\"$.userName\",\"columnid\":\"User_Name\",\"columnType\":\"string\"},{\"path\":\"$.action\",\"columnid\":\"Action\",\"columnType\":\"string\"},{\"path\":\"$.actionState\",\"columnid\":\"Action_State\",\"columnType\":\"string\"},{\"path\":\"$.initiatedByUserPrincipalName\",\"columnid\":\"InitiatedBy\",\"columnType\":\"string\"},{\"path\":\"$.requestDateTime\",\"columnid\":\"RequestDateTime\",\"columnType\":\"datetime\"}]}}]}",
                    "size": 1,
                    "queryType": 14,
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RequestDateTime",
                          "formatter": 6,
                          "dateFormat": {
                            "formatName": "shortDateTimeNoMsPattern"
                          }
                        }
                      ],
                      "rowLimit": 1000,
                      "filter": true
                    },
                    "sortBy": []
                  },
                  "conditionalVisibility": {
                    "parameterName": "hide",
                    "comparison": "isEqualTo",
                    "value": "hide"
                  },
                  "name": "RemoteActionsAudit"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"68e4f758-c957-4baf-9a2b-93282588e0f3\",\"mergeType\":\"leftouter\",\"leftTable\":\"RemoteActionsAudit\",\"rightTable\":\"RemoteActionsAuditAllDevicesToMerge \",\"leftColumn\":\"Device_Display_Name\",\"rightColumn\":\"deviceName\"}],\"projectRename\":[{\"originalName\":\"Device_Display_Name\",\"mergedName\":\"Device Name\",\"fromId\":\"unknown\"},{\"originalName\":\"User_Name\",\"mergedName\":\"User Name\",\"fromId\":\"unknown\"},{\"originalName\":\"Action_State\",\"mergedName\":\"Action State\",\"fromId\":\"unknown\"},{\"originalName\":\"InitiatedBy\",\"mergedName\":\"InitiatedBy\",\"fromId\":\"unknown\"},{\"originalName\":\"RequestDateTime\",\"mergedName\":\"Request Date Time\",\"fromId\":\"unknown\"},{\"originalName\":\"[RemoteActionsAudit].Action_State\",\"mergedName\":\"Action State\",\"fromId\":\"68e4f758-c957-4baf-9a2b-93282588e0f3\"},{\"originalName\":\"[RemoteActionsAudit].Device_Display_Name\",\"mergedName\":\"Device Name\",\"fromId\":\"68e4f758-c957-4baf-9a2b-93282588e0f3\"},{\"originalName\":\"[RemoteActionsAuditAllDevicesToMerge ].userPrincipalName\",\"mergedName\":\"User Principal Name\",\"fromId\":\"unknown\"},{\"originalName\":\"[RemoteActionsAudit].InitiatedBy\",\"mergedName\":\"InitiatedBy\",\"fromId\":\"68e4f758-c957-4baf-9a2b-93282588e0f3\"},{\"originalName\":\"[RemoteActionsAudit].User_Name\",\"mergedName\":\"User Name\",\"fromId\":\"68e4f758-c957-4baf-9a2b-93282588e0f3\"},{\"originalName\":\"[RemoteActionsAudit].RequestDateTime\",\"mergedName\":\"Request Date Time \",\"fromId\":\"68e4f758-c957-4baf-9a2b-93282588e0f3\"},{\"originalName\":\"Action\",\"mergedName\":\"Action\",\"fromId\":\"unknown\"},{\"originalName\":\"[RemoteActionsAudit].Action\",\"mergedName\":\"Action\",\"fromId\":\"68e4f758-c957-4baf-9a2b-93282588e0f3\"},{\"originalName\":\"[RemoteActionsAuditAllDevicesToMerge ].operatingSystem\",\"mergedName\":\"Operating System\",\"fromId\":\"68e4f758-c957-4baf-9a2b-93282588e0f3\"},{\"originalName\":\"[RemoteActionsAuditAllDevicesToMerge ].deviceName\"}]}",
                    "size": 1,
                    "title": "Remote Actions Devices - Last {LastActions}",
                    "showExportToExcel": true,
                    "queryType": 7,
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "State",
                          "formatter": 11
                        },
                        {
                          "columnMatch": "Action State",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "done",
                                "representation": "Resolved",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "pending",
                                "representation": "pending",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Important",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "User Name",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "Request Date Time",
                          "formatter": 6,
                          "dateFormat": {
                            "showUtcTime": null,
                            "formatName": "shortDateTimeNoMsPattern"
                          }
                        },
                        {
                          "columnMatch": "Action",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "_ActionState",
                          "formatter": 5
                        }
                      ],
                      "rowLimit": 1000,
                      "filter": true,
                      "hierarchySettings": {
                        "treeType": 1,
                        "groupBy": [
                          "Action"
                        ],
                        "expandTopLevel": false,
                        "finalBy": "Action"
                      },
                      "sortBy": [
                        {
                          "itemKey": "$gen_date_Request Date Time_6",
                          "sortOrder": 2
                        }
                      ]
                    },
                    "sortBy": [
                      {
                        "itemKey": "$gen_date_Request Date Time_6",
                        "sortOrder": 2
                      }
                    ]
                  },
                  "name": "Remote Actions on Devices"
                }
              ]
            },
            "name": "groupRemoteActionsAudit"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Last Logged On User",
              "expandable": true,
              "expanded": true,
              "items": [
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "parameters": [
                      {
                        "id": "6d0a9d93-6513-4e60-8f28-928dbae763cb",
                        "version": "KqlParameterItem/1.0",
                        "name": "deviceOS",
                        "label": "OS",
                        "type": 11,
                        "isRequired": true,
                        "typeSettings": {
                          "additionalResourceOptions": [],
                          "showDefault": false
                        },
                        "jsonData": "[\r\n    {\r\n         \"value\": \"managementAgent eq 'mdm'\",\r\n         \"label\": \"Any\",\r\n         \"selected\": \"true\"\r\n    },\r\n    {\r\n         \"value\": \"operatingSystem eq 'Windows'\",\r\n         \"label\": \"Windows\"\r\n    },\r\n    {\r\n         \"value\": \"operatingSystem eq 'iOS'\",\r\n         \"label\": \"iOS\"\r\n    },\r\n    {\r\n         \"value\": \"operatingSystem eq 'Android'\",\r\n         \"label\": \"Android\"\r\n    },\r\n    {\r\n         \"value\": \"operatingSystem eq 'macOS'\",\r\n         \"label\": \"Mac OS\"\r\n    },\r\n    {\r\n         \"value\": \"deviceType eq 'linux'\",\r\n         \"label\": \"Linux\"\r\n    }\r\n]",
                        "description": "Select the operating system of the devices you want to include in the query (e.g. Windows, iOS, Android, macOS, or Linux).",
                        "timeContext": {
                          "durationMs": 86400000
                        }
                      }
                    ],
                    "style": "pills",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "name": "deviceParameters"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"{deviceOS}\"},{\"key\":\"$top\",\"value\":\"999\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$.usersLoggedOn[*].userId\",\"columnid\":\"UserId\"},{\"path\":\"$.usersLoggedOn[*].lastLogOnDateTime\",\"columnid\":\"LastLogOnDateTime\"},{\"path\":\"$.deviceName\",\"columnid\":\"deviceName\"},{\"path\":\"$.lastSyncDateTime\",\"columnid\":\"lastSyncDateTime\"},{\"path\":\"$.operatingSystem\",\"columnid\":\"operatingSystem\"},{\"path\":\"$.userPrincipalName\",\"columnid\":\"userPrincipalName\"}]}}]}",
                    "size": 0,
                    "queryType": 14,
                    "gridSettings": {
                      "rowLimit": 1000
                    },
                    "sortBy": []
                  },
                  "conditionalVisibility": {
                    "parameterName": "hide",
                    "comparison": "isEqualTo",
                    "value": "hide"
                  },
                  "name": "LoggedOnUsers"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/beta/users\",\"urlParams\":[{\"key\":\"$select\",\"value\":\"id,displayName,userPrincipalName\"},{\"key\":\"$top\",\"value\":\"999\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[]}}]}",
                    "size": 0,
                    "queryType": 14,
                    "gridSettings": {
                      "rowLimit": 1000
                    }
                  },
                  "conditionalVisibility": {
                    "parameterName": "hide",
                    "comparison": "isEqualTo",
                    "value": "hide"
                  },
                  "name": "EntraUsers"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"660639bc-8e0c-4d88-acc0-70310df380d3\",\"mergeType\":\"leftouter\",\"leftTable\":\"LoggedOnUsers\",\"rightTable\":\"EntraUsers\",\"leftColumn\":\"UserId\",\"rightColumn\":\"id\"}],\"projectRename\":[{\"originalName\":\"[LoggedOnUsers].deviceName\",\"mergedName\":\"Device Name\",\"fromId\":\"660639bc-8e0c-4d88-acc0-70310df380d3\"},{\"originalName\":\"[LoggedOnUsers].LastLogOnDateTime\",\"mergedName\":\"Last Logon\",\"fromId\":\"660639bc-8e0c-4d88-acc0-70310df380d3\"},{\"originalName\":\"[EntraUsers].displayName\",\"mergedName\":\"Last User Logged On \",\"fromId\":\"660639bc-8e0c-4d88-acc0-70310df380d3\"},{\"originalName\":\"[EntraUsers].userPrincipalName\",\"mergedName\":\"Last UPN Logged On\",\"fromId\":\"660639bc-8e0c-4d88-acc0-70310df380d3\"},{\"originalName\":\"[LoggedOnUsers].userPrincipalName\",\"mergedName\":\"Primary User\",\"fromId\":\"660639bc-8e0c-4d88-acc0-70310df380d3\"},{\"originalName\":\"[LoggedOnUsers].lastSyncDateTime\",\"mergedName\":\"Last Device Sync\",\"fromId\":\"660639bc-8e0c-4d88-acc0-70310df380d3\"},{\"originalName\":\"[LoggedOnUsers].operatingSystem\",\"mergedName\":\"Operating System\",\"fromId\":\"660639bc-8e0c-4d88-acc0-70310df380d3\"},{\"originalName\":\"[EntraUsers].id\",\"mergedName\":\"Last User Id Logged On\",\"fromId\":\"660639bc-8e0c-4d88-acc0-70310df380d3\"},{\"originalName\":\"[LoggedOnUsers].UserId\",\"mergedName\":\"UserId\",\"fromId\":\"660639bc-8e0c-4d88-acc0-70310df380d3\"}]}",
                    "size": 1,
                    "title": "Last LoggedOn User | On {deviceOS:label} Devices ",
                    "showExportToExcel": true,
                    "queryType": 7,
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "UserId",
                          "formatter": 5
                        }
                      ],
                      "rowLimit": 1000,
                      "filter": true
                    }
                  },
                  "showPin": false,
                  "name": "MergeLastLoggedOnUser"
                }
              ]
            },
            "name": "groupLastLoggedOnUser"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "tab",
        "comparison": "isEqualTo",
        "value": "Devices"
      },
      "name": "DevicesGroup"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "parameters": [
                      {
                        "id": "5b796597-205c-4b14-9a7c-d9a88ec6eeae",
                        "version": "KqlParameterItem/1.0",
                        "name": "OverviewLast1h",
                        "label": "1h",
                        "type": 4,
                        "isRequired": true,
                        "isHiddenWhenLocked": true,
                        "typeSettings": {
                          "selectableValues": [
                            {
                              "durationMs": 3600000
                            }
                          ],
                          "allowCustom": false
                        },
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "value": {
                          "durationMs": 3600000
                        }
                      },
                      {
                        "id": "44263ba2-da58-4963-b49d-28a5b498a231",
                        "version": "KqlParameterItem/1.0",
                        "name": "OverviewLast12h",
                        "label": "12h",
                        "type": 4,
                        "isRequired": true,
                        "isHiddenWhenLocked": true,
                        "typeSettings": {
                          "selectableValues": [
                            {
                              "durationMs": 43200000
                            }
                          ],
                          "allowCustom": false
                        },
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "value": {
                          "durationMs": 43200000
                        }
                      },
                      {
                        "id": "4cf95ade-ed58-40b1-aef8-e90c25f7c63b",
                        "version": "KqlParameterItem/1.0",
                        "name": "OverviewLast7d",
                        "label": "7d",
                        "type": 4,
                        "isRequired": true,
                        "isHiddenWhenLocked": true,
                        "typeSettings": {
                          "selectableValues": [
                            {
                              "durationMs": 604800000
                            },
                            {
                              "durationMs": 7776000000
                            }
                          ],
                          "allowCustom": false
                        },
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "value": {
                          "durationMs": 604800000
                        }
                      }
                    ],
                    "style": "pills",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "conditionalVisibility": {
                    "parameterName": "hide",
                    "comparison": "isEqualTo",
                    "value": "hide"
                  },
                  "name": "ParameterComplianceTime"
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "parameters": [
                      {
                        "id": "3bb9902d-2147-4533-a118-b4a2ee67316c",
                        "version": "KqlParameterItem/1.0",
                        "name": "deviceManagementStats",
                        "type": 1,
                        "query": "{\"version\":\"1.0.0\",\"content\":\"{\\\"value\\\":\\\"/beta/deviceManagement\\\"}\",\"transformers\":null}",
                        "isHiddenWhenLocked": true,
                        "queryType": 8
                      },
                      {
                        "id": "9a56d2cf-59b6-48c8-9153-bdbe99ecefeb",
                        "version": "KqlParameterItem/1.0",
                        "name": "managedDevices1Stats",
                        "type": 1,
                        "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$expand\",\"value\":\"windowsProtectionState\"},{\"key\":\"$filter\",\"value\":\"operatingSystem eq 'windows'\"},{\"key\":\"$top\",\"value\":\"999\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"columns\":[{\"path\":\"$..['@odata.nextLink']\",\"columnid\":\"nextLink\",\"substringRegexMatch\":\"^https://graph\\\\.microsoft\\\\.com/beta/deviceManagement/\",\"substringReplace\":\"/\"},{\"path\":\"$.value\",\"columnid\":\"value\"}]}}]}",
                        "isHiddenWhenLocked": true,
                        "queryType": 14
                      },
                      {
                        "id": "6e136b4c-7d3a-48e1-92cd-8d7a640bb8d4",
                        "version": "KqlParameterItem/1.0",
                        "name": "managedDevices2Stats",
                        "type": 1,
                        "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"{deviceManagement}{managedDevices1}\",\"urlParams\":[],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"columns\":[{\"path\":\"$..['@odata.nextLink']\",\"columnid\":\"nextLink\",\"substringRegexMatch\":\"^https://graph\\\\.microsoft\\\\.com/beta/deviceManagement/\",\"substringReplace\":\"/\"},{\"path\":\"$.value\",\"columnid\":\"value\"}]}}]}",
                        "isHiddenWhenLocked": true,
                        "queryType": 14
                      },
                      {
                        "id": "0fb802b5-8006-4434-a5d7-32f23974e1cc",
                        "version": "KqlParameterItem/1.0",
                        "name": "managedDevices3Stats",
                        "type": 1,
                        "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"{deviceManagement}{managedDevices2}\",\"urlParams\":[],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"columns\":[{\"path\":\"$..['@odata.nextLink']\",\"columnid\":\"nextLink\",\"substringRegexMatch\":\"^https://graph\\\\.microsoft\\\\.com/beta/deviceManagement/\",\"substringReplace\":\"/\"},{\"path\":\"$.value\",\"columnid\":\"value\"}]}}]}",
                        "isHiddenWhenLocked": true,
                        "queryType": 14
                      },
                      {
                        "id": "0524111c-adaf-4f0e-a0bc-4638c45fc733",
                        "version": "KqlParameterItem/1.0",
                        "name": "managedDevices4Stats",
                        "type": 1,
                        "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"{deviceManagement}{managedDevices3}\",\"urlParams\":[],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"columns\":[{\"path\":\"$..['@odata.nextLink']\",\"columnid\":\"nextLink\",\"substringRegexMatch\":\"^https://graph\\\\.microsoft\\\\.com/beta/deviceManagement/\",\"substringReplace\":\"/\"},{\"path\":\"$.value\",\"columnid\":\"value\"}]}}]}",
                        "isHiddenWhenLocked": true,
                        "queryType": 14
                      }
                    ],
                    "style": "pills",
                    "queryType": 14
                  },
                  "conditionalVisibility": {
                    "parameterName": "hide",
                    "comparison": "isEqualTo",
                    "value": "hide"
                  },
                  "name": "deviceParameterManagedDevicesMulti"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"complianceState eq 'compliant'\"},{\"key\":\"$top\",\"value\":\"999\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"\",\"columns\":[{\"path\":\"$..['@odata.count']\",\"columnid\":\"Count\",\"columnType\":\"long\"}]}}]}",
                    "size": 4,
                    "title": "Compliant Devices",
                    "exportToExcelOptions": "all",
                    "queryType": 14,
                    "visualization": "stat",
                    "sortBy": [],
                    "tileSettings": {
                      "titleContent": {},
                      "leftContent": {
                        "columnMatch": "JailBrokenCount",
                        "formatter": 8,
                        "formatOptions": {
                          "min": 0,
                          "max": 1,
                          "palette": "red",
                          "linkTarget": "GenericDetails",
                          "linkIsContextBlade": true
                        }
                      },
                      "showBorder": true,
                      "size": "auto",
                      "styleSettings": {
                        "borderStyle": "rounded"
                      }
                    },
                    "statSettings": {
                      "valueAggregation": "None",
                      "colorSettings": {
                        "type": "static",
                        "mode": "foreground",
                        "heatmapPalette": "greenRed",
                        "heatmapMin": 0,
                        "heatmapMax": 1,
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": ">=",
                            "thresholdValue": "0",
                            "representation": "Lateral_Movement"
                          }
                        ]
                      },
                      "tagText": "",
                      "valueFontStyle": "auto",
                      "valueTooltipSettings": {
                        "tooltip": "The number of devices currently in intune of all Platform types."
                      },
                      "linkSettings": {
                        "linkTarget": "GenericDetails",
                        "linkIsContextBlade": true
                      }
                    }
                  },
                  "customWidth": "0",
                  "showPin": false,
                  "name": "CompliantDevices",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"complianceState eq 'inGracePeriod'\"},{\"key\":\"$top\",\"value\":\"999\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"\",\"columns\":[{\"path\":\"$..['@odata.count']\",\"columnid\":\"Count\",\"columnType\":\"long\"}]}}]}",
                    "size": 4,
                    "title": "Devices in Grace Period",
                    "exportToExcelOptions": "all",
                    "queryType": 14,
                    "visualization": "stat",
                    "sortBy": [],
                    "tileSettings": {
                      "titleContent": {},
                      "leftContent": {
                        "columnMatch": "JailBrokenCount",
                        "formatter": 8,
                        "formatOptions": {
                          "min": 0,
                          "max": 1,
                          "palette": "red",
                          "linkTarget": "GenericDetails",
                          "linkIsContextBlade": true
                        }
                      },
                      "showBorder": true,
                      "size": "auto",
                      "styleSettings": {
                        "borderStyle": "rounded"
                      }
                    },
                    "statSettings": {
                      "valueAggregation": "None",
                      "colorSettings": {
                        "type": "static",
                        "mode": "foreground",
                        "heatmapPalette": "greenRed",
                        "heatmapMin": 0,
                        "heatmapMax": 1,
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": ">=",
                            "thresholdValue": "0",
                            "representation": "Lateral_Movement"
                          }
                        ]
                      },
                      "tagText": "",
                      "valueFontStyle": "auto",
                      "valueTooltipSettings": {
                        "tooltip": "The number of devices currently in intune of all Platform types."
                      },
                      "linkSettings": {
                        "linkTarget": "GenericDetails",
                        "linkIsContextBlade": true
                      }
                    }
                  },
                  "customWidth": "0",
                  "showPin": false,
                  "name": "InGracePeriod",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"complianceState eq 'noncompliant'\"},{\"key\":\"$top\",\"value\":\"999\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"\",\"columns\":[{\"path\":\"$..['@odata.count']\",\"columnid\":\"Count\",\"columnType\":\"long\"}]}}]}",
                    "size": 4,
                    "title": "Noncompliant Devices",
                    "exportToExcelOptions": "all",
                    "queryType": 14,
                    "visualization": "stat",
                    "sortBy": [],
                    "tileSettings": {
                      "titleContent": {},
                      "leftContent": {
                        "columnMatch": "JailBrokenCount",
                        "formatter": 8,
                        "formatOptions": {
                          "min": 0,
                          "max": 1,
                          "palette": "red",
                          "linkTarget": "GenericDetails",
                          "linkIsContextBlade": true
                        }
                      },
                      "showBorder": true,
                      "size": "auto",
                      "styleSettings": {
                        "borderStyle": "rounded"
                      }
                    },
                    "statSettings": {
                      "valueAggregation": "None",
                      "colorSettings": {
                        "type": "static",
                        "mode": "foreground",
                        "heatmapPalette": "greenRed",
                        "heatmapMin": 0,
                        "heatmapMax": 1,
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": ">=",
                            "thresholdValue": "0",
                            "representation": "Lateral_Movement"
                          }
                        ]
                      },
                      "tagText": "",
                      "valueFontStyle": "auto",
                      "valueTooltipSettings": {
                        "tooltip": "The number of devices currently in intune of all Platform types."
                      },
                      "linkSettings": {
                        "linkTarget": "GenericDetails",
                        "linkIsContextBlade": true
                      }
                    }
                  },
                  "customWidth": "0",
                  "showPin": false,
                  "name": "NonCompliantDevices",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"complianceState eq 'noncompliant' and complianceGracePeriodExpirationDateTime ge {OverviewLast1h:startISO}\"},{\"key\":\"$top\",\"value\":\"999\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"\",\"columns\":[{\"path\":\"$..['@odata.count']\",\"columnid\":\"Count\",\"columnType\":\"long\"}]}}]}",
                    "size": 4,
                    "title": "Noncompliant Devices < 1h",
                    "exportToExcelOptions": "all",
                    "queryType": 14,
                    "visualization": "stat",
                    "sortBy": [],
                    "tileSettings": {
                      "titleContent": {},
                      "leftContent": {
                        "columnMatch": "JailBrokenCount",
                        "formatter": 8,
                        "formatOptions": {
                          "min": 0,
                          "max": 1,
                          "palette": "red",
                          "linkTarget": "GenericDetails",
                          "linkIsContextBlade": true
                        }
                      },
                      "showBorder": true,
                      "size": "auto",
                      "styleSettings": {
                        "borderStyle": "rounded"
                      }
                    },
                    "statSettings": {
                      "valueAggregation": "None",
                      "colorSettings": {
                        "type": "heatmap",
                        "mode": "foreground",
                        "heatmapPalette": "greenRed",
                        "heatmapMin": 0,
                        "heatmapMax": 1,
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": "==",
                            "thresholdValue": "0",
                            "representation": "success"
                          },
                          {
                            "operator": ">",
                            "thresholdValue": "0",
                            "representation": "2"
                          }
                        ]
                      },
                      "tagText": "",
                      "valueFontStyle": "auto",
                      "valueTooltipSettings": {
                        "tooltip": "The number of devices got in the last 24 hours non Compliant."
                      },
                      "linkSettings": {
                        "linkTarget": "GenericDetails",
                        "linkIsContextBlade": true
                      }
                    }
                  },
                  "customWidth": "0",
                  "showPin": false,
                  "name": "NonCompliantDevicesLast1",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"complianceState eq 'noncompliant' and complianceGracePeriodExpirationDateTime ge {OverviewLast1h:startISO}\"},{\"key\":\"$top\",\"value\":\"999\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"\",\"columns\":[{\"path\":\"$..['@odata.count']\",\"columnid\":\"Count\",\"columnType\":\"long\"}]}}]}",
                    "size": 4,
                    "title": "Noncompliant Devices < 12h",
                    "exportToExcelOptions": "all",
                    "queryType": 14,
                    "visualization": "stat",
                    "sortBy": [],
                    "tileSettings": {
                      "titleContent": {},
                      "leftContent": {
                        "columnMatch": "JailBrokenCount",
                        "formatter": 8,
                        "formatOptions": {
                          "min": 0,
                          "max": 1,
                          "palette": "red",
                          "linkTarget": "GenericDetails",
                          "linkIsContextBlade": true
                        }
                      },
                      "showBorder": true,
                      "size": "auto",
                      "styleSettings": {
                        "borderStyle": "rounded"
                      }
                    },
                    "statSettings": {
                      "valueAggregation": "None",
                      "colorSettings": {
                        "type": "heatmap",
                        "mode": "foreground",
                        "heatmapPalette": "greenRed",
                        "heatmapMin": 0,
                        "heatmapMax": 1,
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": "==",
                            "thresholdValue": "0",
                            "representation": "success"
                          },
                          {
                            "operator": ">",
                            "thresholdValue": "0",
                            "representation": "2"
                          }
                        ]
                      },
                      "tagText": "",
                      "valueFontStyle": "auto",
                      "valueTooltipSettings": {
                        "tooltip": "The number of devices got in the last 24 hours non Compliant."
                      },
                      "linkSettings": {
                        "linkTarget": "GenericDetails",
                        "linkIsContextBlade": true
                      }
                    }
                  },
                  "customWidth": "0",
                  "showPin": false,
                  "name": "NonCompliantDevicesLast12",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"jailBroken eq 'true'\"},{\"key\":\"$count\",\"value\":\"true\"},{\"key\":\"$top\",\"value\":\"0\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"\",\"columns\":[{\"path\":\"$..['@odata.count']\",\"columnid\":\"Count\",\"columnType\":\"long\"}]}}]}",
                    "size": 4,
                    "title": "Jailbroken Devices ",
                    "exportToExcelOptions": "all",
                    "queryType": 14,
                    "visualization": "stat",
                    "sortBy": [],
                    "tileSettings": {
                      "titleContent": {},
                      "leftContent": {
                        "columnMatch": "JailBrokenCount",
                        "formatter": 8,
                        "formatOptions": {
                          "min": 0,
                          "max": 1,
                          "palette": "red",
                          "linkTarget": "GenericDetails",
                          "linkIsContextBlade": true
                        }
                      },
                      "showBorder": true,
                      "size": "auto",
                      "styleSettings": {
                        "borderStyle": "rounded"
                      }
                    },
                    "statSettings": {
                      "valueAggregation": "None",
                      "colorSettings": {
                        "type": "heatmap",
                        "mode": "foreground",
                        "heatmapPalette": "greenRed",
                        "heatmapMin": 0,
                        "heatmapMax": 1,
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": "==",
                            "thresholdValue": "0",
                            "representation": "success"
                          },
                          {
                            "operator": ">",
                            "thresholdValue": "0",
                            "representation": "4"
                          }
                        ]
                      },
                      "tagText": "",
                      "valueFontStyle": "auto",
                      "valueTooltipSettings": {
                        "tooltip": "The number of devices currently in intune flagged with JailBroken"
                      },
                      "linkSettings": {
                        "linkTarget": "GenericDetails",
                        "linkIsContextBlade": true
                      }
                    }
                  },
                  "customWidth": "0",
                  "showPin": false,
                  "name": "JailBrokenDevices ",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                }
              ],
              "exportParameters": true
            },
            "name": "ComplianceStatGroup"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Device Compliance State by Last Contact",
              "expandable": true,
              "expanded": true,
              "items": [
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "parameters": [
                      {
                        "id": "5b796597-205c-4b14-9a7c-d9a88ec6eeae",
                        "version": "KqlParameterItem/1.0",
                        "name": "Last",
                        "label": "Last Contact",
                        "type": 4,
                        "isRequired": true,
                        "typeSettings": {
                          "selectableValues": [
                            {
                              "durationMs": 300000
                            },
                            {
                              "durationMs": 900000
                            },
                            {
                              "durationMs": 1800000
                            },
                            {
                              "durationMs": 3600000
                            },
                            {
                              "durationMs": 14400000
                            },
                            {
                              "durationMs": 43200000
                            },
                            {
                              "durationMs": 86400000
                            },
                            {
                              "durationMs": 172800000
                            },
                            {
                              "durationMs": 259200000
                            },
                            {
                              "durationMs": 604800000
                            },
                            {
                              "durationMs": 1209600000
                            },
                            {
                              "durationMs": 2419200000
                            },
                            {
                              "durationMs": 2592000000
                            },
                            {
                              "durationMs": 5184000000
                            },
                            {
                              "durationMs": 7776000000
                            }
                          ],
                          "allowCustom": true
                        },
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "value": {
                          "durationMs": 604800000
                        },
                        "description": "Select the maximum time since the last device check-in (e.g. 5 min, 1 hour, 7 days, etc.). Devices inactive longer than this will be excluded."
                      },
                      {
                        "id": "b0ed6e3b-3e8d-4cf8-99ec-cca433f8719f",
                        "version": "KqlParameterItem/1.0",
                        "name": "paramCompliance",
                        "label": "Compliance State",
                        "type": 2,
                        "isRequired": true,
                        "typeSettings": {
                          "additionalResourceOptions": [],
                          "showDefault": false
                        },
                        "jsonData": "[\r\n    {\r\n         \"value\": \"complianceState eq 'noncompliant'\",\r\n         \"label\": \"Not Compliant\"\r\n    },\r\n    {\r\n         \"value\": \"complianceState eq 'inGracePeriod'\",\r\n         \"label\": \"Grace Period\"\r\n    },\r\n    {\r\n         \"value\": \"complianceState eq 'compliant'\",\r\n         \"label\": \"Compliant\"\r\n    },\r\n    {\r\n         \"value\": \"complianceState eq 'noncompliant' and complianceState eq 'compliant' and complianceState eq 'inGracePeriod'\",\r\n         \"label\": \"Any Compliance State\",\r\n         \"selected\": \"true\"\r\n    }\r\n]",
                        "description": "Filter devices based on their compliance state: compliant, non-compliant, in grace period, or all states."
                      },
                      {
                        "id": "6d0a9d93-6513-4e60-8f28-928dbae763cb",
                        "version": "KqlParameterItem/1.0",
                        "name": "ownerType",
                        "label": "Owner Type",
                        "type": 2,
                        "isRequired": true,
                        "typeSettings": {
                          "additionalResourceOptions": [],
                          "showDefault": false
                        },
                        "jsonData": "[\r\n    {\r\n         \"value\": \"and (ownerType eq 'company' and ownerType eq 'personal')\",\r\n         \"label\": \"Any\",\r\n         \"selected\": \"true\"\r\n    },\r\n    {\r\n         \"value\": \"and (ownerType eq 'personal')\",\r\n         \"label\": \"Personal\"\r\n    },\r\n    {\r\n         \"value\": \"and (ownerType eq 'company')\",\r\n         \"label\": \"Company\"\r\n    }\r\n]",
                        "description": "Filter based on who owns the device: company-owned, personally owned, or all."
                      },
                      {
                        "version": "KqlParameterItem/1.0",
                        "name": "deviceOS",
                        "label": "OS",
                        "type": 11,
                        "isRequired": true,
                        "typeSettings": {
                          "additionalResourceOptions": [],
                          "showDefault": false
                        },
                        "jsonData": "[\r\n    {\r\n         \"value\": \"managementAgent eq 'mdm'\",\r\n         \"label\": \"All\",\r\n         \"selected\": \"true\"\r\n    },\r\n    {\r\n         \"value\": \"operatingSystem eq 'Windows'\",\r\n         \"label\": \"Windows\"\r\n    },\r\n    {\r\n         \"value\": \"operatingSystem eq 'iOS'\",\r\n         \"label\": \"iOS\"\r\n    },\r\n    {\r\n         \"value\": \"operatingSystem eq 'Android'\",\r\n         \"label\": \"Android\"\r\n    },\r\n    {\r\n         \"value\": \"operatingSystem eq 'macOS'\",\r\n         \"label\": \"MacOS\"\r\n    },\r\n    {\r\n         \"value\": \"deviceType eq 'linux'\",\r\n         \"label\": \"Linux\"\r\n    }\r\n]",
                        "description": "Select the operating system of the devices to include in the query: Windows, macOS, iOS, Android, Linux, or all.",
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "id": "59b1487c-1f3f-49c7-b136-fb3e21d978e8"
                      }
                    ],
                    "style": "pills",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "name": "deviceParameter"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"{paramCompliance} and lastSyncDateTime ge {Last:startISO} and lastSyncDateTime le {Last:endISO} and {deviceOS} {ownerType:value}\"},{\"key\":\"$select\",\"value\":\"deviceName,userPrincipalName,lastSyncDateTime,complianceState,operatingSystem,complianceGracePeriodExpirationDateTime\"},{\"key\":\"$top\",\"value\":\"999\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$.deviceName\",\"columnid\":\"Device_Name\",\"columnType\":\"string\"},{\"path\":\"$.userPrincipalName\",\"columnid\":\"User_Principal_Name\",\"columnType\":\"string\"},{\"path\":\"$.lastSyncDateTime\",\"columnid\":\"Last_Sync_Date_Time\",\"columnType\":\"datetime\"},{\"path\":\"$.operatingSystem\",\"columnid\":\"Operating_System\",\"columnType\":\"string\"},{\"path\":\"$.complianceState\",\"columnid\":\"Compliance_State\",\"columnType\":\"string\"},{\"path\":\"$.complianceGracePeriodExpirationDateTime\",\"columnid\":\"Date_Not_Compliant\",\"columnType\":\"datetime\"}]}}]}",
                    "size": 1,
                    "title": "Devices: {paramCompliance:label} by Last Contact | {Last:label}",
                    "showExportToExcel": true,
                    "queryType": 14,
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "$gen_group",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "sourceColumn": "Compliance_State",
                                "operator": "==",
                                "thresholdValue": "compliant",
                                "representation": "success",
                                "text": "{0}{1}"
                              },
                              {
                                "sourceColumn": "Compliance_State",
                                "operator": "==",
                                "thresholdValue": "noncompliant",
                                "representation": "4",
                                "text": "{0}{1}"
                              },
                              {
                                "sourceColumn": "Compliance_State",
                                "operator": "==",
                                "thresholdValue": "inGracePeriod",
                                "representation": "2",
                                "text": "{0}{1}"
                              },
                              {
                                "sourceColumn": "Compliance_State",
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "warning",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Compliance_State",
                          "formatter": 5
                        }
                      ],
                      "rowLimit": 1000,
                      "filter": true,
                      "hierarchySettings": {
                        "treeType": 1,
                        "groupBy": [
                          "Compliance_State"
                        ],
                        "finalBy": "Compliance_State"
                      },
                      "sortBy": [
                        {
                          "itemKey": "Last_Sync_Date_Time",
                          "sortOrder": 2
                        }
                      ],
                      "labelSettings": [
                        {
                          "columnId": "Device_Name",
                          "label": "Device Name"
                        },
                        {
                          "columnId": "User_Principal_Name",
                          "label": "User Principal Name"
                        },
                        {
                          "columnId": "Last_Sync_Date_Time",
                          "label": "Last Sync Date Time"
                        },
                        {
                          "columnId": "Operating_System",
                          "label": "Operating System"
                        },
                        {
                          "columnId": "Compliance_State",
                          "label": "Compliance State"
                        },
                        {
                          "columnId": "Date_Not_Compliant",
                          "label": "Date Not Compliant"
                        }
                      ]
                    },
                    "sortBy": [
                      {
                        "itemKey": "Last_Sync_Date_Time",
                        "sortOrder": 2
                      }
                    ]
                  },
                  "name": "queryNonCompliantDevices"
                }
              ]
            },
            "name": "groupComplianceState"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Windows Devices Protection State",
              "expandable": true,
              "expanded": true,
              "items": [
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "parameters": [
                      {
                        "id": "864e05eb-a995-4a80-93d4-8b4266009cd5",
                        "version": "KqlParameterItem/1.0",
                        "name": "ParameterWindowsProtectionStateTime",
                        "label": "Last Contact",
                        "type": 4,
                        "isRequired": true,
                        "typeSettings": {
                          "selectableValues": [
                            {
                              "durationMs": 300000
                            },
                            {
                              "durationMs": 900000
                            },
                            {
                              "durationMs": 1800000
                            },
                            {
                              "durationMs": 3600000
                            },
                            {
                              "durationMs": 14400000
                            },
                            {
                              "durationMs": 43200000
                            },
                            {
                              "durationMs": 86400000
                            },
                            {
                              "durationMs": 172800000
                            },
                            {
                              "durationMs": 259200000
                            },
                            {
                              "durationMs": 604800000
                            },
                            {
                              "durationMs": 1209600000
                            },
                            {
                              "durationMs": 2419200000
                            },
                            {
                              "durationMs": 2592000000
                            },
                            {
                              "durationMs": 5184000000
                            },
                            {
                              "durationMs": 7776000000
                            }
                          ],
                          "allowCustom": true
                        },
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "value": {
                          "durationMs": 7776000000
                        },
                        "description": "Select the time range to filter devices based on their last check-in. Devices that haven‚Äôt contacted the service within this time window will be excluded."
                      },
                      {
                        "id": "6d0a9d93-6513-4e60-8f28-928dbae763cb",
                        "version": "KqlParameterItem/1.0",
                        "name": "ownerType",
                        "label": "Owner Type",
                        "type": 2,
                        "isRequired": true,
                        "typeSettings": {
                          "additionalResourceOptions": [],
                          "showDefault": false
                        },
                        "jsonData": "[\r\n    {\r\n         \"value\": \"and (ownerType eq 'company' and ownerType eq 'personal')\",\r\n         \"label\": \"Any\",\r\n         \"selected\": \"true\"\r\n    },\r\n    {\r\n         \"value\": \"and (ownerType eq 'personal')\",\r\n         \"label\": \"Personal\"\r\n    },\r\n    {\r\n         \"value\": \"and (ownerType eq 'company')\",\r\n         \"label\": \"Company\"\r\n    }\r\n]",
                        "description": "Filter devices by ownership: company-owned, personally owned, or both.",
                        "timeContext": {
                          "durationMs": 86400000
                        }
                      }
                    ],
                    "style": "pills",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "name": "ParameterWindowsProtectionState"
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "parameters": [
                      {
                        "id": "e8ce4ef6-f54e-4676-8af8-805b5d2d0541",
                        "version": "KqlParameterItem/1.0",
                        "name": "deviceManagement",
                        "type": 1,
                        "query": "{\"version\":\"1.0.0\",\"content\":\"{\\\"value\\\":\\\"/beta/deviceManagement\\\"}\",\"transformers\":null}",
                        "isHiddenWhenLocked": true,
                        "queryType": 8
                      },
                      {
                        "id": "bb52a8d1-1dbd-4988-b178-c665446869ac",
                        "version": "KqlParameterItem/1.0",
                        "name": "managedDevices1",
                        "type": 1,
                        "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$expand\",\"value\":\"windowsProtectionState\"},{\"key\":\"$filter\",\"value\":\"operatingSystem eq 'windows' and lastSyncDateTime ge {ParameterWindowsProtectionStateTime:startISO} and lastSyncDateTime le {ParameterWindowsProtectionStateTime:endISO} {ownerType:value}\"},{\"key\":\"$top\",\"value\":\"999\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"columns\":[{\"path\":\"$..['@odata.nextLink']\",\"columnid\":\"nextLink\",\"substringRegexMatch\":\"^https://graph\\\\.microsoft\\\\.com/beta/deviceManagement/\",\"substringReplace\":\"/\"},{\"path\":\"$.value\",\"columnid\":\"value\"}]}}]}",
                        "isHiddenWhenLocked": true,
                        "queryType": 14
                      },
                      {
                        "id": "ada351e8-3834-48fd-872e-1d59543fd522",
                        "version": "KqlParameterItem/1.0",
                        "name": "managedDevices2",
                        "type": 1,
                        "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"{deviceManagement}{managedDevices1}\",\"urlParams\":[],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"columns\":[{\"path\":\"$..['@odata.nextLink']\",\"columnid\":\"nextLink\",\"substringRegexMatch\":\"^https://graph\\\\.microsoft\\\\.com/beta/deviceManagement/\",\"substringReplace\":\"/\"},{\"path\":\"$.value\",\"columnid\":\"value\"}]}}]}",
                        "isHiddenWhenLocked": true,
                        "queryType": 14
                      },
                      {
                        "id": "b7544bc0-2de3-4f6e-840c-2dc2627532b0",
                        "version": "KqlParameterItem/1.0",
                        "name": "managedDevices3",
                        "type": 1,
                        "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"{deviceManagement}{managedDevices2}\",\"urlParams\":[],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"columns\":[{\"path\":\"$..['@odata.nextLink']\",\"columnid\":\"nextLink\",\"substringRegexMatch\":\"^https://graph\\\\.microsoft\\\\.com/beta/deviceManagement/\",\"substringReplace\":\"/\"},{\"path\":\"$.value\",\"columnid\":\"value\"}]}}]}",
                        "isHiddenWhenLocked": true,
                        "queryType": 14
                      },
                      {
                        "id": "9d0f6c65-0067-4b18-9439-8f64c45b5d73",
                        "version": "KqlParameterItem/1.0",
                        "name": "managedDevices4",
                        "type": 1,
                        "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"{deviceManagement}{managedDevices3}\",\"urlParams\":[],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"columns\":[{\"path\":\"$..['@odata.nextLink']\",\"columnid\":\"nextLink\",\"substringRegexMatch\":\"^https://graph\\\\.microsoft\\\\.com/beta/deviceManagement/\",\"substringReplace\":\"/\"},{\"path\":\"$.value\",\"columnid\":\"value\"}]}}]}",
                        "isHiddenWhenLocked": true,
                        "queryType": 14
                      }
                    ],
                    "style": "pills",
                    "queryType": 14
                  },
                  "conditionalVisibility": {
                    "parameterName": "hide",
                    "comparison": "isEqualTo",
                    "value": "hide"
                  },
                  "name": "deviceParameterManagedDevicesMulti"
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "parameters": [
                      {
                        "id": "3918b94d-c73c-4b1b-82f4-1ccbdf9b3219",
                        "version": "KqlParameterItem/1.0",
                        "name": "ParameterWindowsProtectionStates",
                        "label": "Windows Protection States",
                        "type": 11,
                        "typeSettings": {
                          "additionalResourceOptions": [],
                          "showDefault": false
                        },
                        "jsonData": "[\r\n    {\r\n        \"label\":\"Malware Protection\",\r\n        \"value\":\"MalwareProtectionEnabled\"\r\n    },\r\n    {\r\n        \"label\":\"Real Time Protection\",\r\n        \"value\":\"RealTimeProtectionEnabled\"\r\n    },\r\n    {\r\n        \"label\":\"Network Inspection System\",\r\n        \"value\":\"NetworkInspectionSystemEnabled\"\r\n    },\r\n    {\r\n        \"label\":\"Tamper Protection\",\r\n        \"value\":\"TamperProtectionEnabled\"\r\n    },\r\n    {\r\n        \"label\":\"Device State\",\r\n        \"value\":\"DeviceState\"\r\n    }\r\n]",
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "value": "MalwareProtectionEnabled",
                        "description": "Choose which Windows security component or protection feature you want to analyze, such as real-time protection, malware defense, or tamper protection."
                      }
                    ],
                    "style": "pills",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "name": "ParameterWindowsProtectionStates"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$expand\",\"value\":\"windowsProtectionState\"},{\"key\":\"$filter\",\"value\":\"operatingSystem eq 'windows' and lastSyncDateTime ge {ParameterWindowsProtectionStateTime:startISO} and lastSyncDateTime le {ParameterWindowsProtectionStateTime:endISO} {ownerType:value}\"},{\"key\":\"$top\",\"value\":\"999\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value[*]\",\"columns\":[{\"path\":\"$.deviceName\",\"columnid\":\"DeviceName\",\"columnType\":\"string\"},{\"path\":\"$.userPrincipalName\",\"columnid\":\"UserPrincipalName\",\"columnType\":\"string\"},{\"path\":\"$.windowsProtectionState.malwareProtectionEnabled\",\"columnid\":\"MalwareProtectionEnabled\",\"columnType\":\"string\"},{\"path\":\"$.windowsProtectionState.realTimeProtectionEnabled\",\"columnid\":\"RealTimeProtectionEnabled\",\"columnType\":\"string\"},{\"path\":\"$.windowsProtectionState.networkInspectionSystemEnabled\",\"columnid\":\"NetworkInspectionSystemEnabled\",\"columnType\":\"string\"},{\"path\":\"$.windowsProtectionState.tamperProtectionEnabled\",\"columnid\":\"TamperProtectionEnabled\",\"columnType\":\"string\"},{\"path\":\"$.windowsProtectionState.deviceState\",\"columnid\":\"DeviceState\",\"columnType\":\"string\"},{\"path\":\"$.windowsProtectionState.quickScanOverdue\",\"columnid\":\"quickScanOverdue\",\"columnType\":\"string\"},{\"path\":\"$.lastSyncDateTime\",\"columnid\":\"LastSyncDateTime\",\"columnType\":\"datetime\"},{\"path\":\"$.windowsProtectionState.lastReportedDateTime\",\"columnid\":\"LastReportedDateTime\",\"columnType\":\"datetime\"}]}}]}",
                    "size": 1,
                    "queryType": 14,
                    "visualization": "table",
                    "gridSettings": {
                      "labelSettings": [
                        {
                          "columnId": "DeviceName",
                          "label": "Device Name"
                        },
                        {
                          "columnId": "UserPrincipalName",
                          "label": "User Principal Name"
                        },
                        {
                          "columnId": "MalwareProtectionEnabled",
                          "label": "Malware Protection Enabled"
                        },
                        {
                          "columnId": "RealTimeProtectionEnabled",
                          "label": "Real Time Protection Enabled"
                        },
                        {
                          "columnId": "NetworkInspectionSystemEnabled",
                          "label": "Network Inspection System Enabled"
                        },
                        {
                          "columnId": "TamperProtectionEnabled",
                          "label": "Tamper Protection Enabled"
                        },
                        {
                          "columnId": "DeviceState",
                          "label": "Device State"
                        },
                        {
                          "columnId": "LastSyncDateTime",
                          "label": "Last Sync Date Time"
                        },
                        {
                          "columnId": "LastReportedDateTime",
                          "label": "Last Reported Date Time"
                        }
                      ]
                    },
                    "sortBy": []
                  },
                  "conditionalVisibility": {
                    "parameterName": "hide",
                    "comparison": "isEqualTo",
                    "value": "hide"
                  },
                  "name": "querymanagedDevices1"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/{managedDevices1}\",\"urlParams\":[],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value[*]\",\"columns\":[{\"path\":\"$.deviceName\",\"columnid\":\"DeviceName\",\"columnType\":\"string\"},{\"path\":\"$.userPrincipalName\",\"columnid\":\"UserPrincipalName\",\"columnType\":\"string\"},{\"path\":\"$.windowsProtectionState.malwareProtectionEnabled\",\"columnid\":\"MalwareProtectionEnabled\",\"columnType\":\"string\"},{\"path\":\"$.windowsProtectionState.realTimeProtectionEnabled\",\"columnid\":\"RealTimeProtectionEnabled\",\"columnType\":\"string\"},{\"path\":\"$.windowsProtectionState.networkInspectionSystemEnabled\",\"columnid\":\"NetworkInspectionSystemEnabled\",\"columnType\":\"string\"},{\"path\":\"$.windowsProtectionState.tamperProtectionEnabled\",\"columnid\":\"TamperProtectionEnabled\",\"columnType\":\"string\"},{\"path\":\"$.windowsProtectionState.deviceState\",\"columnid\":\"DeviceState\",\"columnType\":\"string\"},{\"path\":\"$.windowsProtectionState.quickScanOverdue\",\"columnid\":\"quickScanOverdue\",\"columnType\":\"string\"},{\"path\":\"$.lastSyncDateTime\",\"columnid\":\"LastSyncDateTime\",\"columnType\":\"datetime\"},{\"path\":\"$.windowsProtectionState.lastReportedDateTime\",\"columnid\":\"LastReportedDateTime\",\"columnType\":\"datetime\"}]}}]}",
                    "size": 1,
                    "queryType": 14
                  },
                  "conditionalVisibility": {
                    "parameterName": "hide",
                    "comparison": "isEqualTo",
                    "value": "hide"
                  },
                  "name": "querymanagedDevices2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/{managedDevices2}\",\"urlParams\":[],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value[*]\",\"columns\":[{\"path\":\"$.deviceName\",\"columnid\":\"DeviceName\",\"columnType\":\"string\"},{\"path\":\"$.userPrincipalName\",\"columnid\":\"UserPrincipalName\",\"columnType\":\"string\"},{\"path\":\"$.windowsProtectionState.malwareProtectionEnabled\",\"columnid\":\"MalwareProtectionEnabled\",\"columnType\":\"string\"},{\"path\":\"$.windowsProtectionState.realTimeProtectionEnabled\",\"columnid\":\"RealTimeProtectionEnabled\",\"columnType\":\"string\"},{\"path\":\"$.windowsProtectionState.networkInspectionSystemEnabled\",\"columnid\":\"NetworkInspectionSystemEnabled\",\"columnType\":\"string\"},{\"path\":\"$.windowsProtectionState.tamperProtectionEnabled\",\"columnid\":\"TamperProtectionEnabled\",\"columnType\":\"string\"},{\"path\":\"$.windowsProtectionState.deviceState\",\"columnid\":\"DeviceState\",\"columnType\":\"string\"},{\"path\":\"$.windowsProtectionState.quickScanOverdue\",\"columnid\":\"quickScanOverdue\",\"columnType\":\"string\"},{\"path\":\"$.lastSyncDateTime\",\"columnid\":\"LastSyncDateTime\",\"columnType\":\"datetime\"},{\"path\":\"$.windowsProtectionState.lastReportedDateTime\",\"columnid\":\"LastReportedDateTime\",\"columnType\":\"datetime\"}]}}]}",
                    "size": 1,
                    "queryType": 14
                  },
                  "conditionalVisibility": {
                    "parameterName": "hide",
                    "comparison": "isEqualTo",
                    "value": "hide"
                  },
                  "name": "querymanagedDevices3"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/{managedDevices3}\",\"urlParams\":[],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value[*]\",\"columns\":[{\"path\":\"$.deviceName\",\"columnid\":\"DeviceName\",\"columnType\":\"string\"},{\"path\":\"$.userPrincipalName\",\"columnid\":\"UserPrincipalName\",\"columnType\":\"string\"},{\"path\":\"$.windowsProtectionState.malwareProtectionEnabled\",\"columnid\":\"MalwareProtectionEnabled\",\"columnType\":\"string\"},{\"path\":\"$.windowsProtectionState.realTimeProtectionEnabled\",\"columnid\":\"RealTimeProtectionEnabled\",\"columnType\":\"string\"},{\"path\":\"$.windowsProtectionState.networkInspectionSystemEnabled\",\"columnid\":\"NetworkInspectionSystemEnabled\",\"columnType\":\"string\"},{\"path\":\"$.windowsProtectionState.tamperProtectionEnabled\",\"columnid\":\"TamperProtectionEnabled\",\"columnType\":\"string\"},{\"path\":\"$.windowsProtectionState.deviceState\",\"columnid\":\"DeviceState\",\"columnType\":\"string\"},{\"path\":\"$.windowsProtectionState.quickScanOverdue\",\"columnid\":\"quickScanOverdue\",\"columnType\":\"string\"},{\"path\":\"$.lastSyncDateTime\",\"columnid\":\"LastSyncDateTime\",\"columnType\":\"datetime\"},{\"path\":\"$.windowsProtectionState.lastReportedDateTime\",\"columnid\":\"LastReportedDateTime\",\"columnType\":\"datetime\"}]}}]}",
                    "size": 1,
                    "queryType": 14
                  },
                  "conditionalVisibility": {
                    "parameterName": "hide",
                    "comparison": "isEqualTo",
                    "value": "hide"
                  },
                  "name": "querymanagedDevices4"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/{managedDevices4}\",\"urlParams\":[],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value[*]\",\"columns\":[{\"path\":\"$.deviceName\",\"columnid\":\"DeviceName\",\"columnType\":\"string\"},{\"path\":\"$.userPrincipalName\",\"columnid\":\"UserPrincipalName\",\"columnType\":\"string\"},{\"path\":\"$.windowsProtectionState.malwareProtectionEnabled\",\"columnid\":\"MalwareProtectionEnabled\",\"columnType\":\"string\"},{\"path\":\"$.windowsProtectionState.realTimeProtectionEnabled\",\"columnid\":\"RealTimeProtectionEnabled\",\"columnType\":\"string\"},{\"path\":\"$.windowsProtectionState.networkInspectionSystemEnabled\",\"columnid\":\"NetworkInspectionSystemEnabled\",\"columnType\":\"string\"},{\"path\":\"$.windowsProtectionState.tamperProtectionEnabled\",\"columnid\":\"TamperProtectionEnabled\",\"columnType\":\"string\"},{\"path\":\"$.windowsProtectionState.deviceState\",\"columnid\":\"DeviceState\",\"columnType\":\"string\"},{\"path\":\"$.windowsProtectionState.quickScanOverdue\",\"columnid\":\"quickScanOverdue\",\"columnType\":\"string\"},{\"path\":\"$.lastSyncDateTime\",\"columnid\":\"LastSyncDateTime\",\"columnType\":\"datetime\"},{\"path\":\"$.windowsProtectionState.lastReportedDateTime\",\"columnid\":\"LastReportedDateTime\",\"columnType\":\"datetime\"}]}}]}",
                    "size": 1,
                    "queryType": 14
                  },
                  "conditionalVisibility": {
                    "parameterName": "hide",
                    "comparison": "isEqualTo",
                    "value": "hide"
                  },
                  "name": "querymanagedDevices5"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\",\"mergeType\":\"union\",\"leftTable\":\"querymanagedDevices1\",\"rightTable\":\"querymanagedDevices2\"},{\"id\":\"8c7e3267-b021-4029-b4c8-b509199730f8\",\"mergeType\":\"union\",\"leftTable\":\"querymanagedDevices1\",\"rightTable\":\"querymanagedDevices3\"},{\"id\":\"8c7e3267-b021-4029-b4c8-b50919973104\",\"mergeType\":\"union\",\"leftTable\":\"querymanagedDevices1\",\"rightTable\":\"querymanagedDevices4\"},{\"id\":\"8c7e3267-b021-4029-b4c8-b50919973127\",\"mergeType\":\"union\",\"leftTable\":\"querymanagedDevices1\",\"rightTable\":\"querymanagedDevices5\"}],\"projectRename\":[{\"originalName\":\"[querymanagedDevices1].DeviceName\",\"mergedName\":\"DeviceName\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].UserPrincipalName\",\"mergedName\":\"UserPrincipalName\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].LastSyncDateTime\",\"mergedName\":\"LastSyncDateTime\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].LastReportedDateTime\",\"mergedName\":\"LastReportedDateTime\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].MalwareProtectionEnabled\",\"mergedName\":\"MalwareProtectionEnabled\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].RealTimeProtectionEnabled\",\"mergedName\":\"RealTimeProtectionEnabled\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].NetworkInspectionSystemEnabled\",\"mergedName\":\"NetworkInspectionSystemEnabled\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].TamperProtectionEnabled\",\"mergedName\":\"TamperProtectionEnabled\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].DeviceState\",\"mergedName\":\"DeviceState\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"DeviceName\",\"mergedName\":\"DeviceName\",\"fromId\":\"unknown\"},{\"originalName\":\"UserPrincipalName\",\"mergedName\":\"UserPrincipalName\",\"fromId\":\"unknown\"},{\"originalName\":\"MalwareProtectionEnabled\",\"mergedName\":\"MalwareProtectionEnabled\",\"fromId\":\"unknown\"},{\"originalName\":\"RealTimeProtectionEnabled\",\"mergedName\":\"RealTimeProtectionEnabled\",\"fromId\":\"unknown\"},{\"originalName\":\"NetworkInspectionSystemEnabled\",\"mergedName\":\"NetworkInspectionSystemEnabled\",\"fromId\":\"unknown\"},{\"originalName\":\"TamperProtectionEnabled\",\"mergedName\":\"TamperProtectionEnabled\",\"fromId\":\"unknown\"},{\"originalName\":\"DeviceState\",\"mergedName\":\"DeviceState\",\"fromId\":\"unknown\"},{\"originalName\":\"LastSyncDateTime\",\"mergedName\":\"LastSyncDateTime\",\"fromId\":\"unknown\"},{\"originalName\":\"LastReportedDateTime\",\"mergedName\":\"LastReportedDateTime\",\"fromId\":\"unknown\"},{\"originalName\":\"@odata.context\",\"mergedName\":\"@odata.context\",\"fromId\":\"unknown\"},{\"originalName\":\"@odata.count\",\"mergedName\":\"@odata.count\",\"fromId\":\"unknown\"},{\"originalName\":\"value\",\"mergedName\":\"value\",\"fromId\":\"unknown\"},{\"originalName\":\"defaultVisualization\",\"mergedName\":\"defaultVisualization\",\"fromId\":\"unknown\"},{\"originalName\":\"[querymanagedDevices1].quickScanOverdue\"},{\"originalName\":\"quickScanOverdue\"}]}",
                    "size": 1,
                    "title": "Windows Malware Protection | {ParameterWindowsProtectionStateTime:label}",
                    "showExportToExcel": true,
                    "queryType": 7,
                    "visualization": "table",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "$gen_group",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "sourceColumn": "MalwareProtectionEnabled",
                                "operator": "==",
                                "thresholdValue": "true",
                                "representation": "success",
                                "text": "MalwareProtectionEnabled",
                                "tooltipFormat": {
                                  "tooltip": "When TRUE indicates anti malware is enabled when FALSE indicates anti malware is not enabled."
                                }
                              },
                              {
                                "sourceColumn": "MalwareProtectionEnabled",
                                "thresholdValue": "false",
                                "representation": "4",
                                "text": "MalwareProtectionEnabled",
                                "tooltipFormat": {
                                  "tooltip": "When TRUE indicates anti malware is enabled when FALSE indicates anti malware is not enabled."
                                }
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{0}{1}",
                                "tooltipFormat": {
                                  "tooltip": "When TRUE indicates anti malware is enabled when FALSE indicates anti malware is not enabled."
                                }
                              }
                            ],
                            "customColumnWidthSetting": "34ch"
                          }
                        },
                        {
                          "columnMatch": "MalwareProtectionEnabled",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "true",
                                "representation": "success",
                                "text": "true"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "false",
                                "representation": "4",
                                "text": "false"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "question",
                                "text": "unknown"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RealTimeProtectionEnabled",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "true",
                                "representation": "success",
                                "text": "true"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "false",
                                "representation": "4",
                                "text": "false"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "NetworkInspectionSystemEnabled",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "true",
                                "representation": "success",
                                "text": "true"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "false",
                                "representation": "4",
                                "text": "false"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "TamperProtectionEnabled",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "true",
                                "representation": "success",
                                "text": "true"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "false",
                                "representation": "4",
                                "text": "false"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "rowLimit": 1000,
                      "filter": true,
                      "hierarchySettings": {
                        "treeType": 1,
                        "groupBy": [
                          "MalwareProtectionEnabled"
                        ],
                        "finalBy": "MalwareProtectionEnabled"
                      },
                      "labelSettings": [
                        {
                          "columnId": "DeviceName",
                          "label": "Device Name"
                        },
                        {
                          "columnId": "UserPrincipalName",
                          "label": "User Principal Name"
                        },
                        {
                          "columnId": "MalwareProtectionEnabled",
                          "label": "Malware Protection Enabled"
                        },
                        {
                          "columnId": "RealTimeProtectionEnabled",
                          "label": "Real Time Protection Enabled"
                        },
                        {
                          "columnId": "NetworkInspectionSystemEnabled",
                          "label": "Network Inspection System Enabled"
                        },
                        {
                          "columnId": "TamperProtectionEnabled",
                          "label": "Tamper Protection Enabled"
                        },
                        {
                          "columnId": "DeviceState",
                          "label": "Device State"
                        },
                        {
                          "columnId": "LastSyncDateTime",
                          "label": "Last Sync Date Time"
                        },
                        {
                          "columnId": "LastReportedDateTime",
                          "label": "Last Reported Date Time"
                        }
                      ]
                    },
                    "sortBy": [],
                    "statSettings": {
                      "valueAggregation": "Sum",
                      "colorSettings": {
                        "type": "static",
                        "mode": "background",
                        "heatmapPalette": "greenRed",
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": []
                      },
                      "tagText": "",
                      "valueFontStyle": "auto"
                    }
                  },
                  "conditionalVisibility": {
                    "parameterName": "ParameterWindowsProtectionStates",
                    "comparison": "isEqualTo",
                    "value": "MalwareProtectionEnabled"
                  },
                  "name": "QueryMalwareProtectionEnabled"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\",\"mergeType\":\"union\",\"leftTable\":\"querymanagedDevices1\",\"rightTable\":\"querymanagedDevices2\"},{\"id\":\"8c7e3267-b021-4029-b4c8-b509199730f8\",\"mergeType\":\"union\",\"leftTable\":\"querymanagedDevices1\",\"rightTable\":\"querymanagedDevices3\"},{\"id\":\"8c7e3267-b021-4029-b4c8-b50919973104\",\"mergeType\":\"union\",\"leftTable\":\"querymanagedDevices1\",\"rightTable\":\"querymanagedDevices4\"},{\"id\":\"8c7e3267-b021-4029-b4c8-b50919973127\",\"mergeType\":\"union\",\"leftTable\":\"querymanagedDevices1\",\"rightTable\":\"querymanagedDevices5\"}],\"projectRename\":[{\"originalName\":\"[querymanagedDevices1].DeviceName\",\"mergedName\":\"DeviceName\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].UserPrincipalName\",\"mergedName\":\"UserPrincipalName\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].LastSyncDateTime\",\"mergedName\":\"LastSyncDateTime\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].LastReportedDateTime\",\"mergedName\":\"LastReportedDateTime\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].MalwareProtectionEnabled\",\"mergedName\":\"MalwareProtectionEnabled\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].RealTimeProtectionEnabled\",\"mergedName\":\"RealTimeProtectionEnabled\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].NetworkInspectionSystemEnabled\",\"mergedName\":\"NetworkInspectionSystemEnabled\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].TamperProtectionEnabled\",\"mergedName\":\"TamperProtectionEnabled\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].DeviceState\",\"mergedName\":\"DeviceState\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"DeviceName\",\"mergedName\":\"DeviceName\",\"fromId\":\"unknown\"},{\"originalName\":\"UserPrincipalName\",\"mergedName\":\"UserPrincipalName\",\"fromId\":\"unknown\"},{\"originalName\":\"MalwareProtectionEnabled\",\"mergedName\":\"MalwareProtectionEnabled\",\"fromId\":\"unknown\"},{\"originalName\":\"RealTimeProtectionEnabled\",\"mergedName\":\"RealTimeProtectionEnabled\",\"fromId\":\"unknown\"},{\"originalName\":\"NetworkInspectionSystemEnabled\",\"mergedName\":\"NetworkInspectionSystemEnabled\",\"fromId\":\"unknown\"},{\"originalName\":\"TamperProtectionEnabled\",\"mergedName\":\"TamperProtectionEnabled\",\"fromId\":\"unknown\"},{\"originalName\":\"DeviceState\",\"mergedName\":\"DeviceState\",\"fromId\":\"unknown\"},{\"originalName\":\"LastSyncDateTime\",\"mergedName\":\"LastSyncDateTime\",\"fromId\":\"unknown\"},{\"originalName\":\"LastReportedDateTime\",\"mergedName\":\"LastReportedDateTime\",\"fromId\":\"unknown\"},{\"originalName\":\"@odata.context\",\"mergedName\":\"@odata.context\",\"fromId\":\"unknown\"},{\"originalName\":\"@odata.count\",\"mergedName\":\"@odata.count\",\"fromId\":\"unknown\"},{\"originalName\":\"value\",\"mergedName\":\"value\",\"fromId\":\"unknown\"},{\"originalName\":\"defaultVisualization\",\"mergedName\":\"defaultVisualization\",\"fromId\":\"unknown\"},{\"originalName\":\"[querymanagedDevices1].quickScanOverdue\"},{\"originalName\":\"quickScanOverdue\"}]}",
                    "size": 1,
                    "title": "Windows Real Time Protection | {ParameterWindowsProtectionStateTime:label}",
                    "showExportToExcel": true,
                    "queryType": 7,
                    "visualization": "table",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "$gen_group",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "sourceColumn": "RealTimeProtectionEnabled",
                                "operator": "==",
                                "thresholdValue": "true",
                                "representation": "success",
                                "text": "RealTimeProtectionEnabled",
                                "tooltipFormat": {
                                  "tooltip": "When TRUE indicates real time protection is enabled, when FALSE indicates real time protection is not enabled. Defaults to setting on client device."
                                }
                              },
                              {
                                "sourceColumn": "RealTimeProtectionEnabled",
                                "thresholdValue": "false",
                                "representation": "4",
                                "text": "RealTimeProtectionEnabled",
                                "tooltipFormat": {
                                  "tooltip": "When TRUE indicates real time protection is enabled, when FALSE indicates real time protection is not enabled. Defaults to setting on client device."
                                }
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{0}{1}",
                                "tooltipFormat": {
                                  "tooltip": "When TRUE indicates real time protection is enabled, when FALSE indicates real time protection is not enabled. Defaults to setting on client device."
                                }
                              }
                            ],
                            "customColumnWidthSetting": "34ch"
                          }
                        },
                        {
                          "columnMatch": "MalwareProtectionEnabled",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "true",
                                "representation": "success",
                                "text": "true"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "false",
                                "representation": "4",
                                "text": "false"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "question",
                                "text": "unknown"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RealTimeProtectionEnabled",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "true",
                                "representation": "success",
                                "text": "true"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "false",
                                "representation": "4",
                                "text": "false"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "NetworkInspectionSystemEnabled",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "true",
                                "representation": "success",
                                "text": "true"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "false",
                                "representation": "4",
                                "text": "false"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "TamperProtectionEnabled",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "true",
                                "representation": "success",
                                "text": "true"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "false",
                                "representation": "4",
                                "text": "false"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "rowLimit": 1000,
                      "filter": true,
                      "hierarchySettings": {
                        "treeType": 1,
                        "groupBy": [
                          "RealTimeProtectionEnabled"
                        ],
                        "finalBy": "RealTimeProtectionEnabled"
                      },
                      "labelSettings": [
                        {
                          "columnId": "DeviceName",
                          "label": "Device Name"
                        },
                        {
                          "columnId": "UserPrincipalName",
                          "label": "User Principal Name"
                        },
                        {
                          "columnId": "MalwareProtectionEnabled",
                          "label": "Malware Protection Enabled"
                        },
                        {
                          "columnId": "RealTimeProtectionEnabled",
                          "label": "Real Time Protection Enabled"
                        },
                        {
                          "columnId": "NetworkInspectionSystemEnabled",
                          "label": "Network Inspection System Enabled"
                        },
                        {
                          "columnId": "TamperProtectionEnabled",
                          "label": "Tamper Protection Enabled"
                        },
                        {
                          "columnId": "DeviceState",
                          "label": "Device State"
                        },
                        {
                          "columnId": "LastSyncDateTime",
                          "label": "Last Sync Date Time"
                        },
                        {
                          "columnId": "LastReportedDateTime",
                          "label": "Last Reported Date Time"
                        }
                      ]
                    },
                    "sortBy": [],
                    "statSettings": {
                      "valueAggregation": "Sum",
                      "colorSettings": {
                        "type": "static",
                        "mode": "background",
                        "heatmapPalette": "greenRed",
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": []
                      },
                      "tagText": "",
                      "valueFontStyle": "auto"
                    }
                  },
                  "conditionalVisibility": {
                    "parameterName": "ParameterWindowsProtectionStates",
                    "comparison": "isEqualTo",
                    "value": "RealTimeProtectionEnabled"
                  },
                  "name": "QueryRealTimeProtectionEnabled"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\",\"mergeType\":\"union\",\"leftTable\":\"querymanagedDevices1\",\"rightTable\":\"querymanagedDevices2\"},{\"id\":\"8c7e3267-b021-4029-b4c8-b509199730f8\",\"mergeType\":\"union\",\"leftTable\":\"querymanagedDevices1\",\"rightTable\":\"querymanagedDevices3\"},{\"id\":\"8c7e3267-b021-4029-b4c8-b50919973104\",\"mergeType\":\"union\",\"leftTable\":\"querymanagedDevices1\",\"rightTable\":\"querymanagedDevices4\"},{\"id\":\"8c7e3267-b021-4029-b4c8-b50919973127\",\"mergeType\":\"union\",\"leftTable\":\"querymanagedDevices1\",\"rightTable\":\"querymanagedDevices5\"}],\"projectRename\":[{\"originalName\":\"[querymanagedDevices1].DeviceName\",\"mergedName\":\"DeviceName\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].UserPrincipalName\",\"mergedName\":\"UserPrincipalName\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].LastSyncDateTime\",\"mergedName\":\"LastSyncDateTime\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].LastReportedDateTime\",\"mergedName\":\"LastReportedDateTime\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].MalwareProtectionEnabled\",\"mergedName\":\"MalwareProtectionEnabled\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].RealTimeProtectionEnabled\",\"mergedName\":\"RealTimeProtectionEnabled\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].NetworkInspectionSystemEnabled\",\"mergedName\":\"NetworkInspectionSystemEnabled\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].TamperProtectionEnabled\",\"mergedName\":\"TamperProtectionEnabled\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].DeviceState\",\"mergedName\":\"DeviceState\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"DeviceName\",\"mergedName\":\"DeviceName\",\"fromId\":\"unknown\"},{\"originalName\":\"UserPrincipalName\",\"mergedName\":\"UserPrincipalName\",\"fromId\":\"unknown\"},{\"originalName\":\"MalwareProtectionEnabled\",\"mergedName\":\"MalwareProtectionEnabled\",\"fromId\":\"unknown\"},{\"originalName\":\"RealTimeProtectionEnabled\",\"mergedName\":\"RealTimeProtectionEnabled\",\"fromId\":\"unknown\"},{\"originalName\":\"NetworkInspectionSystemEnabled\",\"mergedName\":\"NetworkInspectionSystemEnabled\",\"fromId\":\"unknown\"},{\"originalName\":\"TamperProtectionEnabled\",\"mergedName\":\"TamperProtectionEnabled\",\"fromId\":\"unknown\"},{\"originalName\":\"DeviceState\",\"mergedName\":\"DeviceState\",\"fromId\":\"unknown\"},{\"originalName\":\"LastSyncDateTime\",\"mergedName\":\"LastSyncDateTime\",\"fromId\":\"unknown\"},{\"originalName\":\"LastReportedDateTime\",\"mergedName\":\"LastReportedDateTime\",\"fromId\":\"unknown\"},{\"originalName\":\"@odata.context\",\"mergedName\":\"@odata.context\",\"fromId\":\"unknown\"},{\"originalName\":\"@odata.count\",\"mergedName\":\"@odata.count\",\"fromId\":\"unknown\"},{\"originalName\":\"value\",\"mergedName\":\"value\",\"fromId\":\"unknown\"},{\"originalName\":\"defaultVisualization\",\"mergedName\":\"defaultVisualization\",\"fromId\":\"unknown\"},{\"originalName\":\"[querymanagedDevices1].quickScanOverdue\"},{\"originalName\":\"quickScanOverdue\"}]}",
                    "size": 1,
                    "title": "Windows Network Inspection System | {ParameterWindowsProtectionStateTime:label}",
                    "showExportToExcel": true,
                    "queryType": 7,
                    "visualization": "table",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "$gen_group",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "sourceColumn": "NetworkInspectionSystemEnabled",
                                "operator": "==",
                                "thresholdValue": "true",
                                "representation": "success",
                                "text": "NetworkInspectionSystemEnabled"
                              },
                              {
                                "sourceColumn": "NetworkInspectionSystemEnabled",
                                "thresholdValue": "false",
                                "representation": "4",
                                "text": "NetworkInspectionSystemEnabled"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{0}{1}"
                              }
                            ],
                            "customColumnWidthSetting": "38ch"
                          }
                        },
                        {
                          "columnMatch": "MalwareProtectionEnabled",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "true",
                                "representation": "success",
                                "text": "true"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "false",
                                "representation": "4",
                                "text": "false"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "question",
                                "text": "unknown"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RealTimeProtectionEnabled",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "true",
                                "representation": "success",
                                "text": "true"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "false",
                                "representation": "4",
                                "text": "false"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "NetworkInspectionSystemEnabled",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "true",
                                "representation": "success",
                                "text": "true"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "false",
                                "representation": "4",
                                "text": "false"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "TamperProtectionEnabled",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "true",
                                "representation": "success",
                                "text": "true"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "false",
                                "representation": "4",
                                "text": "false"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "rowLimit": 1000,
                      "filter": true,
                      "hierarchySettings": {
                        "treeType": 1,
                        "groupBy": [
                          "NetworkInspectionSystemEnabled"
                        ],
                        "finalBy": "NetworkInspectionSystemEnabled"
                      },
                      "sortBy": [
                        {
                          "itemKey": "$gen_thresholds_$gen_group_0",
                          "sortOrder": 1
                        }
                      ],
                      "labelSettings": [
                        {
                          "columnId": "DeviceName",
                          "label": "Device Name"
                        },
                        {
                          "columnId": "UserPrincipalName",
                          "label": "User Principal Name"
                        },
                        {
                          "columnId": "MalwareProtectionEnabled",
                          "label": "Malware Protection Enabled"
                        },
                        {
                          "columnId": "RealTimeProtectionEnabled",
                          "label": "Real Time Protection Enabled"
                        },
                        {
                          "columnId": "NetworkInspectionSystemEnabled",
                          "label": "Network Inspection System Enabled"
                        },
                        {
                          "columnId": "TamperProtectionEnabled",
                          "label": "Tamper Protection Enabled"
                        },
                        {
                          "columnId": "DeviceState",
                          "label": "Device State"
                        },
                        {
                          "columnId": "LastSyncDateTime",
                          "label": "Last Sync Date Time"
                        },
                        {
                          "columnId": "LastReportedDateTime",
                          "label": "Last Reported Date Time"
                        }
                      ]
                    },
                    "sortBy": [
                      {
                        "itemKey": "$gen_thresholds_$gen_group_0",
                        "sortOrder": 1
                      }
                    ],
                    "statSettings": {
                      "valueAggregation": "Sum",
                      "colorSettings": {
                        "type": "static",
                        "mode": "background",
                        "heatmapPalette": "greenRed",
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": []
                      },
                      "tagText": "",
                      "valueFontStyle": "auto"
                    }
                  },
                  "conditionalVisibility": {
                    "parameterName": "ParameterWindowsProtectionStates",
                    "comparison": "isEqualTo",
                    "value": "NetworkInspectionSystemEnabled"
                  },
                  "name": "QueryNetworkInspectionSystemEnabled"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\",\"mergeType\":\"union\",\"leftTable\":\"querymanagedDevices1\",\"rightTable\":\"querymanagedDevices2\"},{\"id\":\"8c7e3267-b021-4029-b4c8-b509199730f8\",\"mergeType\":\"union\",\"leftTable\":\"querymanagedDevices1\",\"rightTable\":\"querymanagedDevices3\"},{\"id\":\"8c7e3267-b021-4029-b4c8-b50919973104\",\"mergeType\":\"union\",\"leftTable\":\"querymanagedDevices1\",\"rightTable\":\"querymanagedDevices4\"},{\"id\":\"8c7e3267-b021-4029-b4c8-b50919973127\",\"mergeType\":\"union\",\"leftTable\":\"querymanagedDevices1\",\"rightTable\":\"querymanagedDevices5\"}],\"projectRename\":[{\"originalName\":\"[querymanagedDevices1].DeviceName\",\"mergedName\":\"DeviceName\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].UserPrincipalName\",\"mergedName\":\"UserPrincipalName\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].LastSyncDateTime\",\"mergedName\":\"LastSyncDateTime\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].LastReportedDateTime\",\"mergedName\":\"LastReportedDateTime\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].MalwareProtectionEnabled\",\"mergedName\":\"MalwareProtectionEnabled\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].RealTimeProtectionEnabled\",\"mergedName\":\"RealTimeProtectionEnabled\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].NetworkInspectionSystemEnabled\",\"mergedName\":\"NetworkInspectionSystemEnabled\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].TamperProtectionEnabled\",\"mergedName\":\"TamperProtectionEnabled\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].DeviceState\",\"mergedName\":\"DeviceState\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"DeviceName\",\"mergedName\":\"DeviceName\",\"fromId\":\"unknown\"},{\"originalName\":\"UserPrincipalName\",\"mergedName\":\"UserPrincipalName\",\"fromId\":\"unknown\"},{\"originalName\":\"MalwareProtectionEnabled\",\"mergedName\":\"MalwareProtectionEnabled\",\"fromId\":\"unknown\"},{\"originalName\":\"RealTimeProtectionEnabled\",\"mergedName\":\"RealTimeProtectionEnabled\",\"fromId\":\"unknown\"},{\"originalName\":\"NetworkInspectionSystemEnabled\",\"mergedName\":\"NetworkInspectionSystemEnabled\",\"fromId\":\"unknown\"},{\"originalName\":\"TamperProtectionEnabled\",\"mergedName\":\"TamperProtectionEnabled\",\"fromId\":\"unknown\"},{\"originalName\":\"DeviceState\",\"mergedName\":\"DeviceState\",\"fromId\":\"unknown\"},{\"originalName\":\"LastSyncDateTime\",\"mergedName\":\"LastSyncDateTime\",\"fromId\":\"unknown\"},{\"originalName\":\"LastReportedDateTime\",\"mergedName\":\"LastReportedDateTime\",\"fromId\":\"unknown\"},{\"originalName\":\"@odata.context\",\"mergedName\":\"@odata.context\",\"fromId\":\"unknown\"},{\"originalName\":\"@odata.count\",\"mergedName\":\"@odata.count\",\"fromId\":\"unknown\"},{\"originalName\":\"value\",\"mergedName\":\"value\",\"fromId\":\"unknown\"},{\"originalName\":\"defaultVisualization\",\"mergedName\":\"defaultVisualization\",\"fromId\":\"unknown\"},{\"originalName\":\"[querymanagedDevices1].quickScanOverdue\"},{\"originalName\":\"quickScanOverdue\"}]}",
                    "size": 1,
                    "title": "Windows Tamper Protection | {ParameterWindowsProtectionStateTime:label}",
                    "showExportToExcel": true,
                    "queryType": 7,
                    "visualization": "table",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "$gen_group",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "sourceColumn": "TamperProtectionEnabled",
                                "operator": "==",
                                "thresholdValue": "true",
                                "representation": "success",
                                "text": "TamperProtectionEnabled",
                                "tooltipFormat": {
                                  "tooltip": "\tWhen TRUE indicates the Windows Defender tamper protection feature is enabled, when FALSE indicates the Windows Defender tamper protection feature is not enabled. Defaults to setting on client device."
                                }
                              },
                              {
                                "sourceColumn": "TamperProtectionEnabled",
                                "thresholdValue": "false",
                                "representation": "4",
                                "text": "TamperProtectionEnabled",
                                "tooltipFormat": {
                                  "tooltip": "\tWhen TRUE indicates the Windows Defender tamper protection feature is enabled, when FALSE indicates the Windows Defender tamper protection feature is not enabled. Defaults to setting on client device."
                                }
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{0}{1}",
                                "tooltipFormat": {
                                  "tooltip": "\tWhen TRUE indicates the Windows Defender tamper protection feature is enabled, when FALSE indicates the Windows Defender tamper protection feature is not enabled. Defaults to setting on client device."
                                }
                              }
                            ],
                            "customColumnWidthSetting": "34ch"
                          }
                        },
                        {
                          "columnMatch": "MalwareProtectionEnabled",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "true",
                                "representation": "success",
                                "text": "true"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "false",
                                "representation": "4",
                                "text": "false"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "question",
                                "text": "unknown"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RealTimeProtectionEnabled",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "true",
                                "representation": "success",
                                "text": "true"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "false",
                                "representation": "4",
                                "text": "false"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "NetworkInspectionSystemEnabled",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "true",
                                "representation": "success",
                                "text": "true"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "false",
                                "representation": "4",
                                "text": "false"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "TamperProtectionEnabled",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "true",
                                "representation": "success",
                                "text": "true"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "false",
                                "representation": "4",
                                "text": "false"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "rowLimit": 1000,
                      "filter": true,
                      "hierarchySettings": {
                        "treeType": 1,
                        "groupBy": [
                          "TamperProtectionEnabled"
                        ],
                        "finalBy": "TamperProtectionEnabled"
                      },
                      "labelSettings": [
                        {
                          "columnId": "DeviceName",
                          "label": "Device Name"
                        },
                        {
                          "columnId": "UserPrincipalName",
                          "label": "User Principal Name"
                        },
                        {
                          "columnId": "MalwareProtectionEnabled",
                          "label": "Malware Protection Enabled"
                        },
                        {
                          "columnId": "RealTimeProtectionEnabled",
                          "label": "Real Time Protection Enabled"
                        },
                        {
                          "columnId": "NetworkInspectionSystemEnabled",
                          "label": "Network Inspection System Enabled"
                        },
                        {
                          "columnId": "TamperProtectionEnabled",
                          "label": "Tamper Protection Enabled"
                        },
                        {
                          "columnId": "DeviceState",
                          "label": "Device State"
                        },
                        {
                          "columnId": "LastSyncDateTime",
                          "label": "Last Sync Date Time"
                        },
                        {
                          "columnId": "LastReportedDateTime",
                          "label": "Last Reported Date Time"
                        }
                      ]
                    },
                    "sortBy": [],
                    "statSettings": {
                      "valueAggregation": "Sum",
                      "colorSettings": {
                        "type": "static",
                        "mode": "background",
                        "heatmapPalette": "greenRed",
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": []
                      },
                      "tagText": "",
                      "valueFontStyle": "auto"
                    }
                  },
                  "conditionalVisibility": {
                    "parameterName": "ParameterWindowsProtectionStates",
                    "comparison": "isEqualTo",
                    "value": "TamperProtectionEnabled"
                  },
                  "name": "QueryTamperProtectionEnabled"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\",\"mergeType\":\"union\",\"leftTable\":\"querymanagedDevices1\",\"rightTable\":\"querymanagedDevices2\"},{\"id\":\"8c7e3267-b021-4029-b4c8-b509199730f8\",\"mergeType\":\"union\",\"leftTable\":\"querymanagedDevices1\",\"rightTable\":\"querymanagedDevices3\"},{\"id\":\"8c7e3267-b021-4029-b4c8-b50919973104\",\"mergeType\":\"union\",\"leftTable\":\"querymanagedDevices1\",\"rightTable\":\"querymanagedDevices4\"},{\"id\":\"8c7e3267-b021-4029-b4c8-b50919973127\",\"mergeType\":\"union\",\"leftTable\":\"querymanagedDevices1\",\"rightTable\":\"querymanagedDevices5\"}],\"projectRename\":[{\"originalName\":\"[querymanagedDevices1].DeviceName\",\"mergedName\":\"DeviceName\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].UserPrincipalName\",\"mergedName\":\"UserPrincipalName\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].LastSyncDateTime\",\"mergedName\":\"LastSyncDateTime\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].LastReportedDateTime\",\"mergedName\":\"LastReportedDateTime\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].DeviceState\",\"mergedName\":\"DeviceState\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].MalwareProtectionEnabled\",\"mergedName\":\"MalwareProtectionEnabled\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].RealTimeProtectionEnabled\",\"mergedName\":\"RealTimeProtectionEnabled\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].NetworkInspectionSystemEnabled\",\"mergedName\":\"NetworkInspectionSystemEnabled\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"[querymanagedDevices1].TamperProtectionEnabled\",\"mergedName\":\"TamperProtectionEnabled\",\"fromId\":\"7590b62b-7983-4e09-9d6b-f97fc4dcb2f6\"},{\"originalName\":\"DeviceName\",\"mergedName\":\"DeviceName\",\"fromId\":\"unknown\"},{\"originalName\":\"UserPrincipalName\",\"mergedName\":\"UserPrincipalName\",\"fromId\":\"unknown\"},{\"originalName\":\"MalwareProtectionEnabled\",\"mergedName\":\"MalwareProtectionEnabled\",\"fromId\":\"unknown\"},{\"originalName\":\"RealTimeProtectionEnabled\",\"mergedName\":\"RealTimeProtectionEnabled\",\"fromId\":\"unknown\"},{\"originalName\":\"NetworkInspectionSystemEnabled\",\"mergedName\":\"NetworkInspectionSystemEnabled\",\"fromId\":\"unknown\"},{\"originalName\":\"TamperProtectionEnabled\",\"mergedName\":\"TamperProtectionEnabled\",\"fromId\":\"unknown\"},{\"originalName\":\"DeviceState\",\"mergedName\":\"DeviceState\",\"fromId\":\"unknown\"},{\"originalName\":\"LastSyncDateTime\",\"mergedName\":\"LastSyncDateTime\",\"fromId\":\"unknown\"},{\"originalName\":\"LastReportedDateTime\",\"mergedName\":\"LastReportedDateTime\",\"fromId\":\"unknown\"},{\"originalName\":\"@odata.context\",\"mergedName\":\"@odata.context\",\"fromId\":\"unknown\"},{\"originalName\":\"@odata.count\",\"mergedName\":\"@odata.count\",\"fromId\":\"unknown\"},{\"originalName\":\"value\",\"mergedName\":\"value\",\"fromId\":\"unknown\"},{\"originalName\":\"defaultVisualization\",\"mergedName\":\"defaultVisualization\",\"fromId\":\"unknown\"},{\"originalName\":\"[querymanagedDevices1].quickScanOverdue\"},{\"originalName\":\"quickScanOverdue\"}]}",
                    "size": 1,
                    "title": "Windows Protection Device State | {ParameterWindowsProtectionStateTime:label}",
                    "showExportToExcel": true,
                    "queryType": 7,
                    "visualization": "table",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "$gen_group",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Triangle",
                                "text": "{0}{1}",
                                "tooltipFormat": {
                                  "tooltip": "\tIndicates device's health state. Possible values are: clean, fullScanPending, rebootPending, manualStepsPending, offlineScanPending, critical."
                                }
                              }
                            ],
                            "customColumnWidthSetting": "34ch"
                          }
                        },
                        {
                          "columnMatch": "MalwareProtectionEnabled",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "true",
                                "representation": "success",
                                "text": "true"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "false",
                                "representation": "4",
                                "text": "false"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "question",
                                "text": "unknown"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RealTimeProtectionEnabled",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "true",
                                "representation": "success",
                                "text": "true"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "false",
                                "representation": "4",
                                "text": "false"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "NetworkInspectionSystemEnabled",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "true",
                                "representation": "success",
                                "text": "true"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "false",
                                "representation": "4",
                                "text": "false"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "TamperProtectionEnabled",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "true",
                                "representation": "success",
                                "text": "true"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "false",
                                "representation": "4",
                                "text": "false"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "rowLimit": 1000,
                      "filter": true,
                      "hierarchySettings": {
                        "treeType": 1,
                        "groupBy": [
                          "DeviceState"
                        ],
                        "finalBy": "DeviceState"
                      },
                      "labelSettings": [
                        {
                          "columnId": "DeviceName",
                          "label": "Device Name"
                        },
                        {
                          "columnId": "UserPrincipalName",
                          "label": "User Principal Name"
                        },
                        {
                          "columnId": "MalwareProtectionEnabled",
                          "label": "Malware Protection Enabled"
                        },
                        {
                          "columnId": "RealTimeProtectionEnabled",
                          "label": "Real Time Protection Enabled"
                        },
                        {
                          "columnId": "NetworkInspectionSystemEnabled",
                          "label": "Network Inspection System Enabled"
                        },
                        {
                          "columnId": "TamperProtectionEnabled",
                          "label": "Tamper Protection Enabled"
                        },
                        {
                          "columnId": "DeviceState",
                          "label": "Device State"
                        },
                        {
                          "columnId": "LastSyncDateTime",
                          "label": "Last Sync Date Time"
                        },
                        {
                          "columnId": "LastReportedDateTime",
                          "label": "Last Reported Date Time"
                        }
                      ]
                    },
                    "sortBy": [],
                    "statSettings": {
                      "valueAggregation": "Sum",
                      "colorSettings": {
                        "type": "static",
                        "mode": "background",
                        "heatmapPalette": "greenRed",
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": []
                      },
                      "tagText": "",
                      "valueFontStyle": "auto"
                    }
                  },
                  "conditionalVisibility": {
                    "parameterName": "ParameterWindowsProtectionStates",
                    "comparison": "isEqualTo",
                    "value": "DeviceState"
                  },
                  "name": "QueryDeviceState"
                }
              ]
            },
            "name": "groupwindowsProtectionState"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Jailbroken Devices",
              "expandable": true,
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceManagement/managedDevices\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"jailBroken eq 'true'\"},{\"key\":\"$select\",\"value\":\"jailBroken,deviceName,userPrincipalName,usersLoggedOn,complianceState,managementState,ownerType,lastSyncDateTime,isSupervised\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$.jailBroken\",\"columnid\":\"Jail_Broken\",\"columnType\":\"string\"},{\"path\":\"$.deviceName\",\"columnid\":\"Device_Name\",\"columnType\":\"string\"},{\"path\":\"$.userPrincipalName\",\"columnid\":\"User_Principal_Name\",\"columnType\":\"string\"},{\"path\":\"$.usersLoggedOn[*].userId\",\"columnid\":\"Users_LoggedOn\",\"columnType\":\"string\"},{\"path\":\"$.usersLoggedOn[*].lastLogOnDateTime\",\"columnid\":\"User_Last_LogOn_DateTime\",\"columnType\":\"datetime\"},{\"path\":\"$.complianceState\",\"columnid\":\"Compliance_State\",\"columnType\":\"string\"},{\"path\":\"$.managementState\",\"columnid\":\"Management_State\",\"columnType\":\"string\"},{\"path\":\"$.ownerType\",\"columnid\":\"Owner_Type\",\"columnType\":\"string\"},{\"path\":\"$.lastSyncDateTime\",\"columnid\":\"Last_Sync_Date_Time\",\"columnType\":\"datetime\"},{\"path\":\"$.isSupervised\",\"columnid\":\"isSupervised\",\"columnType\":\"string\"}]}}]}",
                    "size": 1,
                    "title": "Jail Broken Devices ",
                    "noDataMessage": "No Jail Broken Devices found.",
                    "exportToExcelOptions": "all",
                    "queryType": 14,
                    "sortBy": [],
                    "tileSettings": {
                      "titleContent": {},
                      "leftContent": {
                        "columnMatch": "JailBrokenCount",
                        "formatter": 8,
                        "formatOptions": {
                          "min": 0,
                          "max": 1,
                          "palette": "red",
                          "linkTarget": "GenericDetails",
                          "linkIsContextBlade": true
                        }
                      },
                      "showBorder": true,
                      "size": "auto",
                      "styleSettings": {
                        "borderStyle": "rounded"
                      }
                    },
                    "statSettings": {
                      "valueAggregation": "None",
                      "colorSettings": {
                        "type": "heatmap",
                        "mode": "foreground",
                        "heatmapPalette": "greenRed",
                        "heatmapMin": 0,
                        "heatmapMax": 1,
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": "==",
                            "thresholdValue": "0",
                            "representation": "success"
                          },
                          {
                            "operator": ">",
                            "thresholdValue": "0",
                            "representation": "4"
                          }
                        ]
                      },
                      "tagText": "",
                      "valueFontStyle": "auto",
                      "valueTooltipSettings": {
                        "tooltip": "The number of devices currently in intune flagged with JailBroken"
                      }
                    }
                  },
                  "name": "JailBrokenDevices"
                }
              ]
            },
            "name": "groupJailbrokenDevices"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "tab",
        "comparison": "isEqualTo",
        "value": "Compliance"
      },
      "name": "ComplianceGroup"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Application- & Patchmanagement  ",
        "items": [
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"1.0.0\",\"content\":\"{\\r\\n\\t\\\"id\\\" : \\\"0\\\"\\r\\n}\",\"transformers\":null}",
                    "size": 4,
                    "queryType": 8
                  },
                  "conditionalVisibility": {
                    "parameterName": "hide",
                    "comparison": "isEqualTo",
                    "value": "hide"
                  },
                  "name": "AppsIsNullJson"
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "parameters": [
                      {
                        "id": "5b796597-205c-4b14-9a7c-d9a88ec6eeae",
                        "version": "KqlParameterItem/1.0",
                        "name": "OverviewLast1h",
                        "label": "1h",
                        "type": 4,
                        "isRequired": true,
                        "isHiddenWhenLocked": true,
                        "typeSettings": {
                          "selectableValues": [
                            {
                              "durationMs": 3600000
                            }
                          ],
                          "allowCustom": false
                        },
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "value": {
                          "durationMs": 3600000
                        }
                      },
                      {
                        "version": "KqlParameterItem/1.0",
                        "name": "OverviewLast12h",
                        "label": "12h",
                        "type": 4,
                        "isRequired": true,
                        "isHiddenWhenLocked": true,
                        "typeSettings": {
                          "selectableValues": [
                            {
                              "durationMs": 43200000
                            }
                          ],
                          "allowCustom": false
                        },
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "value": {
                          "durationMs": 43200000
                        },
                        "id": "44263ba2-da58-4963-b49d-28a5b498a231"
                      },
                      {
                        "version": "KqlParameterItem/1.0",
                        "name": "OverviewLast7d",
                        "label": "7d",
                        "type": 4,
                        "isRequired": true,
                        "isHiddenWhenLocked": true,
                        "typeSettings": {
                          "selectableValues": [
                            {
                              "durationMs": 604800000
                            },
                            {
                              "durationMs": 7776000000
                            }
                          ],
                          "allowCustom": false
                        },
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "value": {
                          "durationMs": 604800000
                        },
                        "id": "4cf95ade-ed58-40b1-aef8-e90c25f7c63b"
                      }
                    ],
                    "style": "pills",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "name": "AppParameters"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsitencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceAppManagement/mobileApps\",\"urlParams\":[{\"key\":\"$select\",\"value\":\"id\"},{\"key\":\"$top\",\"value\":\"999\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$.id\",\"columnid\":\"id\",\"columnType\":\"long\",\"substringRegexMatch\":\".*\",\"substringReplace\":\"1\"}]}}]}",
                    "size": 4,
                    "title": "Intune Applications",
                    "exportToExcelOptions": "all",
                    "queryType": 14,
                    "visualization": "stat",
                    "sortBy": [],
                    "tileSettings": {
                      "titleContent": {},
                      "leftContent": {
                        "columnMatch": "JailBrokenCount",
                        "formatter": 8,
                        "formatOptions": {
                          "min": 0,
                          "max": 1,
                          "palette": "red",
                          "linkTarget": "GenericDetails",
                          "linkIsContextBlade": true
                        }
                      },
                      "showBorder": true,
                      "size": "auto",
                      "styleSettings": {
                        "borderStyle": "rounded"
                      }
                    },
                    "statSettings": {
                      "valueAggregation": "Count",
                      "colorSettings": {
                        "type": "static",
                        "mode": "foreground",
                        "heatmapPalette": "greenRed",
                        "heatmapMin": 0,
                        "heatmapMax": 1,
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": ">=",
                            "thresholdValue": "0",
                            "representation": "Capture"
                          }
                        ]
                      },
                      "tagText": "",
                      "valueFontStyle": "auto",
                      "valueTooltipSettings": {
                        "tooltip": "The number of all Intune Applications."
                      },
                      "valueField": "id"
                    }
                  },
                  "customWidth": "0",
                  "conditionalVisibility": {
                    "parameterName": "hide",
                    "comparison": "isEqualTo",
                    "value": "hide"
                  },
                  "showPin": false,
                  "name": "IntuneApps",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"6ecf3314-75c7-4572-a296-1ff1f09c529a\",\"mergeType\":\"union\",\"leftTable\":\"AppsIsNullJson\",\"rightTable\":\"IntuneApps\"}],\"projectRename\":[{\"originalName\":\"id\",\"mergedName\":\"id\",\"fromId\":\"unknown\"},{\"originalName\":\"[AppsIsNullJson].id\",\"mergedName\":\"id1\",\"fromId\":\"6ecf3314-75c7-4572-a296-1ff1f09c529a\"}]}",
                    "size": 4,
                    "title": "Intune Applications",
                    "queryType": 7,
                    "visualization": "stat",
                    "statSettings": {
                      "valueField": "id",
                      "valueAggregation": "Sum",
                      "valueTooltipSettings": {
                        "tooltip": "The number of all Apps in Intune."
                      },
                      "colorSettings": {
                        "type": "static",
                        "mode": "background",
                        "heatmapPalette": "greenRed",
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": "==",
                            "thresholdValue": "0",
                            "representation": "ResourceFlat"
                          },
                          {
                            "operator": ">",
                            "thresholdValue": "0",
                            "representation": "ResourceFlat"
                          }
                        ]
                      },
                      "tagText": "",
                      "valueFontStyle": "auto"
                    }
                  },
                  "customWidth": "0",
                  "showPin": false,
                  "name": "cardIntuneApps",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsitencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceAppManagement/mobileApps\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"isof('microsoft.graph.win32CatalogApp')\"},{\"key\":\"$select\",\"value\":\"id\"},{\"key\":\"$top\",\"value\":\"999\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$.id\",\"columnid\":\"id\",\"columnType\":\"long\",\"substringRegexMatch\":\".*\",\"substringReplace\":\"1\"}]}}]}",
                    "size": 4,
                    "title": "EAM Catalog Apps",
                    "exportToExcelOptions": "all",
                    "queryType": 14,
                    "visualization": "stat",
                    "sortBy": [],
                    "tileSettings": {
                      "titleContent": {},
                      "leftContent": {
                        "columnMatch": "JailBrokenCount",
                        "formatter": 8,
                        "formatOptions": {
                          "min": 0,
                          "max": 1,
                          "palette": "red",
                          "linkTarget": "GenericDetails",
                          "linkIsContextBlade": true
                        }
                      },
                      "showBorder": true,
                      "size": "auto",
                      "styleSettings": {
                        "borderStyle": "rounded"
                      }
                    },
                    "statSettings": {
                      "valueAggregation": "Count",
                      "colorSettings": {
                        "type": "static",
                        "mode": "foreground",
                        "heatmapPalette": "greenRed",
                        "heatmapMin": 0,
                        "heatmapMax": 1,
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": ">=",
                            "thresholdValue": "0",
                            "representation": "Capture"
                          }
                        ]
                      },
                      "tagText": "",
                      "valueFontStyle": "auto",
                      "valueTooltipSettings": {
                        "tooltip": "The number of all Enterprise App Catalog Applications."
                      },
                      "valueField": "id"
                    }
                  },
                  "customWidth": "0",
                  "conditionalVisibility": {
                    "parameterName": "hide",
                    "comparison": "isEqualTo",
                    "value": "hide"
                  },
                  "showPin": false,
                  "name": "EAMApps",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsitencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceAppManagement/mobileApps\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"isAssigned eq false\"},{\"key\":\"$select\",\"value\":\"id\"},{\"key\":\"$top\",\"value\":\"999\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$.id\",\"columnid\":\"id\",\"columnType\":\"long\",\"substringRegexMatch\":\".*\",\"substringReplace\":\"1\"}]}}]}",
                    "size": 4,
                    "title": "Not Assigned Apps",
                    "exportToExcelOptions": "all",
                    "queryType": 14,
                    "visualization": "stat",
                    "sortBy": [],
                    "tileSettings": {
                      "titleContent": {},
                      "leftContent": {
                        "columnMatch": "JailBrokenCount",
                        "formatter": 8,
                        "formatOptions": {
                          "min": 0,
                          "max": 1,
                          "palette": "red",
                          "linkTarget": "GenericDetails",
                          "linkIsContextBlade": true
                        }
                      },
                      "showBorder": true,
                      "size": "auto",
                      "styleSettings": {
                        "borderStyle": "rounded"
                      }
                    },
                    "statSettings": {
                      "valueAggregation": "Count",
                      "colorSettings": {
                        "type": "static",
                        "mode": "foreground",
                        "heatmapPalette": "greenRed",
                        "heatmapMin": 0,
                        "heatmapMax": 1,
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": ">=",
                            "thresholdValue": "0",
                            "representation": "Canceled"
                          }
                        ]
                      },
                      "tagText": "",
                      "valueFontStyle": "auto",
                      "valueTooltipSettings": {
                        "tooltip": "The number of all Applications which are not assigned."
                      },
                      "valueField": "id"
                    }
                  },
                  "customWidth": "0",
                  "conditionalVisibility": {
                    "parameterName": "hide",
                    "comparison": "isEqualTo",
                    "value": "hide"
                  },
                  "name": "queryNotAssignedApps",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"6ecf3314-75c7-4572-a296-1ff1f09c5291\",\"mergeType\":\"union\",\"leftTable\":\"AppsIsNullJson\",\"rightTable\":\"queryNotAssignedApps\"}],\"projectRename\":[{\"originalName\":\"id\",\"mergedName\":\"id\",\"fromId\":\"unknown\"},{\"originalName\":\"[AppsIsNullJson].id\",\"mergedName\":\"id1\",\"fromId\":\"6ecf3314-75c7-4572-a296-1ff1f09c5291\"}]}",
                    "size": 4,
                    "title": "Not Assigned Apps",
                    "queryType": 7,
                    "visualization": "stat",
                    "statSettings": {
                      "valueField": "id",
                      "valueAggregation": "Sum",
                      "valueTooltipSettings": {
                        "tooltip": "The number of Apps not assigned to any group."
                      },
                      "colorSettings": {
                        "type": "static",
                        "mode": "background",
                        "heatmapPalette": "greenRed",
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": "==",
                            "thresholdValue": "0",
                            "representation": "Canceled"
                          },
                          {
                            "operator": ">",
                            "thresholdValue": "0",
                            "representation": "Canceled"
                          }
                        ]
                      },
                      "tagText": "",
                      "valueFontStyle": "auto"
                    }
                  },
                  "customWidth": "0",
                  "name": "cardNotAssignedApps",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsitencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceAppManagement/mobileApps\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"createdDateTime ge {OverviewLast7d:startISO} and createdDateTime le {OverviewLast7d:endISO}\"},{\"key\":\"$select\",\"value\":\"id, createdDateTime\"},{\"key\":\"$top\",\"value\":\"999\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$.id\",\"columnid\":\"id\",\"columnType\":\"long\",\"substringRegexMatch\":\".*\",\"substringReplace\":\"1\"}]}}]}",
                    "size": 4,
                    "title": "Created Apps < 7d",
                    "exportToExcelOptions": "all",
                    "queryType": 14,
                    "visualization": "stat",
                    "sortBy": [],
                    "tileSettings": {
                      "titleContent": {},
                      "leftContent": {
                        "columnMatch": "JailBrokenCount",
                        "formatter": 8,
                        "formatOptions": {
                          "min": 0,
                          "max": 1,
                          "palette": "red",
                          "linkTarget": "GenericDetails",
                          "linkIsContextBlade": true
                        }
                      },
                      "showBorder": true,
                      "size": "auto",
                      "styleSettings": {
                        "borderStyle": "rounded"
                      }
                    },
                    "statSettings": {
                      "valueAggregation": "Count",
                      "colorSettings": {
                        "type": "static",
                        "mode": "foreground",
                        "heatmapPalette": "greenRed",
                        "heatmapMin": 0,
                        "heatmapMax": 1,
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": ">=",
                            "thresholdValue": "0",
                            "representation": "AddTile"
                          }
                        ]
                      },
                      "tagText": "",
                      "valueFontStyle": "auto",
                      "valueTooltipSettings": {
                        "tooltip": "The number of all Applications which are not assigned."
                      },
                      "valueField": "id"
                    }
                  },
                  "customWidth": "0",
                  "conditionalVisibility": {
                    "parameterName": "hide",
                    "comparison": "isEqualTo",
                    "value": "hide"
                  },
                  "name": "CreatedAppsLast7d",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"6ecf3314-75c7-4572-a296-1ff1f09c526e\",\"mergeType\":\"union\",\"leftTable\":\"AppsIsNullJson\",\"rightTable\":\"CreatedAppsLast7d\"}],\"projectRename\":[{\"originalName\":\"id\",\"mergedName\":\"id\",\"fromId\":\"unknown\"},{\"originalName\":\"[AppsIsNullJson].id\",\"mergedName\":\"id1\",\"fromId\":\"6ecf3314-75c7-4572-a296-1ff1f09c526e\"}]}",
                    "size": 4,
                    "title": "Created Apps < 7d",
                    "queryType": 7,
                    "visualization": "stat",
                    "statSettings": {
                      "valueField": "id",
                      "valueAggregation": "Sum",
                      "valueTooltipSettings": {
                        "tooltip": "The number of Apps Created in the Last 7 Days."
                      },
                      "colorSettings": {
                        "type": "static",
                        "mode": "background",
                        "heatmapPalette": "greenRed",
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": "==",
                            "thresholdValue": "0",
                            "representation": "AddTile"
                          },
                          {
                            "operator": ">",
                            "thresholdValue": "0",
                            "representation": "AddTile"
                          }
                        ]
                      },
                      "tagText": "",
                      "valueFontStyle": "auto"
                    }
                  },
                  "customWidth": "0",
                  "showPin": false,
                  "name": "cardCreatedAppsLast7d",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsitencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceAppManagement/mobileApps\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"createdDateTime ge {OverviewLast12h:startISO} and createdDateTime le {OverviewLast12h:endISO}\"},{\"key\":\"$select\",\"value\":\"id, createdDateTime\"},{\"key\":\"$top\",\"value\":\"999\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$.id\",\"columnid\":\"id\",\"columnType\":\"long\",\"substringRegexMatch\":\".*\",\"substringReplace\":\"1\"}]}}]}",
                    "size": 4,
                    "title": "Created Apps < 12h",
                    "exportToExcelOptions": "all",
                    "queryType": 14,
                    "visualization": "stat",
                    "sortBy": [],
                    "tileSettings": {
                      "titleContent": {},
                      "leftContent": {
                        "columnMatch": "JailBrokenCount",
                        "formatter": 8,
                        "formatOptions": {
                          "min": 0,
                          "max": 1,
                          "palette": "red",
                          "linkTarget": "GenericDetails",
                          "linkIsContextBlade": true
                        }
                      },
                      "showBorder": true,
                      "size": "auto",
                      "styleSettings": {
                        "borderStyle": "rounded"
                      }
                    },
                    "statSettings": {
                      "valueAggregation": "Count",
                      "colorSettings": {
                        "type": "static",
                        "mode": "foreground",
                        "heatmapPalette": "greenRed",
                        "heatmapMin": 0,
                        "heatmapMax": 1,
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": ">=",
                            "thresholdValue": "0",
                            "representation": "AddTile"
                          }
                        ]
                      },
                      "tagText": "",
                      "valueFontStyle": "auto",
                      "valueTooltipSettings": {
                        "tooltip": "The number of all Applications which are not assigned."
                      },
                      "valueField": "id"
                    }
                  },
                  "customWidth": "0",
                  "conditionalVisibility": {
                    "parameterName": "hide",
                    "comparison": "isEqualTo",
                    "value": "hide"
                  },
                  "name": "queryCreatedAppsLast12h",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"6ecf3314-75c7-4572-a296-1ff1f09c525d\",\"mergeType\":\"union\",\"leftTable\":\"AppsIsNullJson\",\"rightTable\":\"queryCreatedAppsLast12h\"}],\"projectRename\":[{\"originalName\":\"[AppsIsNullJson].id\",\"mergedName\":\"id\",\"fromId\":\"6ecf3314-75c7-4572-a296-1ff1f09c525d\"},{\"originalName\":\"id\",\"mergedName\":\"id\",\"fromId\":\"unknown\"}]}",
                    "size": 4,
                    "title": "Created Apps < 12h",
                    "queryType": 7,
                    "visualization": "stat",
                    "statSettings": {
                      "valueField": "id",
                      "valueAggregation": "Sum",
                      "valueTooltipSettings": {
                        "tooltip": "The number of Apps Created in the Last 12 hours."
                      },
                      "colorSettings": {
                        "type": "static",
                        "mode": "background",
                        "heatmapPalette": "greenRed",
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": "==",
                            "thresholdValue": "0",
                            "representation": "AddTile"
                          },
                          {
                            "operator": ">",
                            "thresholdValue": "0",
                            "representation": "AddTile"
                          }
                        ]
                      },
                      "tagText": "",
                      "valueFontStyle": "auto"
                    }
                  },
                  "customWidth": "0",
                  "showPin": false,
                  "name": "cardCreatedAppsLast12h",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsitencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceAppManagement/mobileApps\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"createdDateTime ge {OverviewLast1h:startISO} and createdDateTime le {OverviewLast1h:endISO}\"},{\"key\":\"$select\",\"value\":\"id, createdDateTime\"},{\"key\":\"$top\",\"value\":\"999\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$.id\",\"columnid\":\"id\",\"columnType\":\"long\",\"substringRegexMatch\":\".*\",\"substringReplace\":\"1\"}]}}]}",
                    "size": 4,
                    "title": "Created Apps < 1h",
                    "exportToExcelOptions": "all",
                    "queryType": 14,
                    "visualization": "stat",
                    "sortBy": [],
                    "tileSettings": {
                      "titleContent": {},
                      "leftContent": {
                        "columnMatch": "JailBrokenCount",
                        "formatter": 8,
                        "formatOptions": {
                          "min": 0,
                          "max": 1,
                          "palette": "red",
                          "linkTarget": "GenericDetails",
                          "linkIsContextBlade": true
                        }
                      },
                      "showBorder": true,
                      "size": "auto",
                      "styleSettings": {
                        "borderStyle": "rounded"
                      }
                    },
                    "statSettings": {
                      "valueAggregation": "Count",
                      "colorSettings": {
                        "type": "static",
                        "mode": "foreground",
                        "heatmapPalette": "greenRed",
                        "heatmapMin": 0,
                        "heatmapMax": 1,
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": ">=",
                            "thresholdValue": "0",
                            "representation": "AddTile"
                          }
                        ]
                      },
                      "tagText": "",
                      "valueFontStyle": "auto",
                      "valueTooltipSettings": {
                        "tooltip": "The number of all Applications which are not assigned."
                      },
                      "valueField": "id"
                    }
                  },
                  "customWidth": "0",
                  "conditionalVisibility": {
                    "parameterName": "hide",
                    "comparison": "isEqualTo",
                    "value": "hide"
                  },
                  "name": "CreatedAppsLast1h",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"6ecf3314-75c7-4572-a296-1ff1f09c5277\",\"mergeType\":\"union\",\"leftTable\":\"AppsIsNullJson\",\"rightTable\":\"CreatedAppsLast1h\"}],\"projectRename\":[{\"originalName\":\"id\",\"mergedName\":\"id\",\"fromId\":\"unknown\"},{\"originalName\":\"[AppsIsNullJson].id\",\"mergedName\":\"id1\",\"fromId\":\"6ecf3314-75c7-4572-a296-1ff1f09c5277\"}]}",
                    "size": 4,
                    "title": "Created Apps < 1h",
                    "queryType": 7,
                    "visualization": "stat",
                    "statSettings": {
                      "valueField": "id",
                      "valueAggregation": "Sum",
                      "valueTooltipSettings": {
                        "tooltip": "The number of Apps Created in the Last 1 hours."
                      },
                      "colorSettings": {
                        "type": "static",
                        "mode": "background",
                        "heatmapPalette": "greenRed",
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": "==",
                            "thresholdValue": "0",
                            "representation": "AddTile"
                          },
                          {
                            "operator": ">",
                            "thresholdValue": "0",
                            "representation": "AddTile"
                          }
                        ]
                      },
                      "tagText": "",
                      "valueFontStyle": "auto"
                    }
                  },
                  "customWidth": "0",
                  "showPin": false,
                  "name": "cardCreatedAppsLast1h",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsitencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceAppManagement/mobileApps\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"lastModifiedDateTime ge {OverviewLast7d:startISO} and lastModifiedDateTime le {OverviewLast7d:endISO}\"},{\"key\":\"$select\",\"value\":\"id, lastModifiedDateTime\"},{\"key\":\"$top\",\"value\":\"999\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$.id\",\"columnid\":\"id\",\"columnType\":\"long\",\"substringRegexMatch\":\".*\",\"substringReplace\":\"1\"}]}}]}",
                    "size": 4,
                    "title": "Modified Apps < 7d",
                    "exportToExcelOptions": "all",
                    "queryType": 14,
                    "visualization": "stat",
                    "sortBy": [],
                    "tileSettings": {
                      "titleContent": {},
                      "leftContent": {
                        "columnMatch": "JailBrokenCount",
                        "formatter": 8,
                        "formatOptions": {
                          "min": 0,
                          "max": 1,
                          "palette": "red",
                          "linkTarget": "GenericDetails",
                          "linkIsContextBlade": true
                        }
                      },
                      "showBorder": true,
                      "size": "auto",
                      "styleSettings": {
                        "borderStyle": "rounded"
                      }
                    },
                    "statSettings": {
                      "valueAggregation": "Count",
                      "colorSettings": {
                        "type": "static",
                        "mode": "foreground",
                        "heatmapPalette": "greenRed",
                        "heatmapMin": 0,
                        "heatmapMax": 1,
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": ">=",
                            "thresholdValue": "0",
                            "representation": "AddTile"
                          }
                        ]
                      },
                      "tagText": "",
                      "valueFontStyle": "auto",
                      "valueTooltipSettings": {
                        "tooltip": "The number of all Applications which are not assigned."
                      },
                      "valueField": "id"
                    }
                  },
                  "customWidth": "0",
                  "conditionalVisibility": {
                    "parameterName": "hide",
                    "comparison": "isEqualTo",
                    "value": "hide"
                  },
                  "name": "ModifiedAppsLast7d",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"6ecf3314-75c7-4572-a296-1ff1f09c52b7\",\"mergeType\":\"union\",\"leftTable\":\"AppsIsNullJson\",\"rightTable\":\"ModifiedAppsLast7d\"}],\"projectRename\":[{\"originalName\":\"id\",\"mergedName\":\"id\",\"fromId\":\"unknown\"}]}",
                    "size": 4,
                    "title": "Modified Apps < 7d",
                    "queryType": 7,
                    "visualization": "stat",
                    "statSettings": {
                      "valueField": "id",
                      "valueAggregation": "Sum",
                      "valueTooltipSettings": {
                        "tooltip": "The number of Apps Modified in the Last 7 days."
                      },
                      "colorSettings": {
                        "type": "static",
                        "mode": "background",
                        "heatmapPalette": "greenRed",
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": "==",
                            "thresholdValue": "0",
                            "representation": "Wrench"
                          },
                          {
                            "operator": ">",
                            "thresholdValue": "0",
                            "representation": "Wrench"
                          }
                        ]
                      },
                      "tagText": "",
                      "valueFontStyle": "auto"
                    }
                  },
                  "customWidth": "0",
                  "showPin": false,
                  "name": "cardModifiedAppsLast7d",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsitencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceAppManagement/mobileApps\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"lastModifiedDateTime ge {OverviewLast12h:startISO} and lastModifiedDateTime le {OverviewLast12h:endISO}\"},{\"key\":\"$select\",\"value\":\"id, lastModifiedDateTime\"},{\"key\":\"$top\",\"value\":\"999\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$.id\",\"columnid\":\"id\",\"columnType\":\"long\",\"substringRegexMatch\":\".*\",\"substringReplace\":\"1\"}]}}]}",
                    "size": 4,
                    "title": "Modified Apps < 12h",
                    "exportToExcelOptions": "all",
                    "queryType": 14,
                    "visualization": "stat",
                    "sortBy": [],
                    "tileSettings": {
                      "titleContent": {},
                      "leftContent": {
                        "columnMatch": "JailBrokenCount",
                        "formatter": 8,
                        "formatOptions": {
                          "min": 0,
                          "max": 1,
                          "palette": "red",
                          "linkTarget": "GenericDetails",
                          "linkIsContextBlade": true
                        }
                      },
                      "showBorder": true,
                      "size": "auto",
                      "styleSettings": {
                        "borderStyle": "rounded"
                      }
                    },
                    "statSettings": {
                      "valueAggregation": "Count",
                      "colorSettings": {
                        "type": "static",
                        "mode": "foreground",
                        "heatmapPalette": "greenRed",
                        "heatmapMin": 0,
                        "heatmapMax": 1,
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": ">=",
                            "thresholdValue": "0",
                            "representation": "AddTile"
                          }
                        ]
                      },
                      "tagText": "",
                      "valueFontStyle": "auto",
                      "valueTooltipSettings": {
                        "tooltip": "The number of all Applications which are not assigned."
                      },
                      "valueField": "id"
                    }
                  },
                  "customWidth": "0",
                  "conditionalVisibility": {
                    "parameterName": "hide",
                    "comparison": "isEqualTo",
                    "value": "hide"
                  },
                  "name": "ModifiedAppsLast12h",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"6ecf3314-75c7-4572-a296-1ff1f09c52b7\",\"mergeType\":\"union\",\"leftTable\":\"AppsIsNullJson\",\"rightTable\":\"ModifiedAppsLast12h\"}],\"projectRename\":[{\"originalName\":\"id\",\"mergedName\":\"id\",\"fromId\":\"unknown\"},{\"originalName\":\"[AppsIsNullJson].id\",\"mergedName\":\"id1\",\"fromId\":\"6ecf3314-75c7-4572-a296-1ff1f09c52b7\"}]}",
                    "size": 4,
                    "title": "Modified Apps < 12h",
                    "queryType": 7,
                    "visualization": "stat",
                    "statSettings": {
                      "valueField": "id",
                      "valueAggregation": "Sum",
                      "valueTooltipSettings": {
                        "tooltip": "The number of Apps Modified in the Last 12 hours."
                      },
                      "colorSettings": {
                        "type": "static",
                        "mode": "background",
                        "heatmapPalette": "greenRed",
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": "==",
                            "thresholdValue": "0",
                            "representation": "Wrench"
                          },
                          {
                            "operator": ">",
                            "thresholdValue": "0",
                            "representation": "Wrench"
                          }
                        ]
                      },
                      "tagText": "",
                      "valueFontStyle": "auto"
                    }
                  },
                  "customWidth": "0",
                  "showPin": false,
                  "name": "cardModifiedAppsLast12h",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsitencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceAppManagement/mobileApps\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"lastModifiedDateTime ge {OverviewLast1h:startISO} and lastModifiedDateTime le {OverviewLast1h:endISO}\"},{\"key\":\"$select\",\"value\":\"id, lastModifiedDateTime\"},{\"key\":\"$top\",\"value\":\"999\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$.id\",\"columnid\":\"id\",\"columnType\":\"long\",\"substringRegexMatch\":\".*\",\"substringReplace\":\"1\"}]}}]}",
                    "size": 4,
                    "title": "Modified Apps < 1h",
                    "exportToExcelOptions": "all",
                    "queryType": 14,
                    "visualization": "stat",
                    "sortBy": [],
                    "tileSettings": {
                      "titleContent": {},
                      "leftContent": {
                        "columnMatch": "JailBrokenCount",
                        "formatter": 8,
                        "formatOptions": {
                          "min": 0,
                          "max": 1,
                          "palette": "red",
                          "linkTarget": "GenericDetails",
                          "linkIsContextBlade": true
                        }
                      },
                      "showBorder": true,
                      "size": "auto",
                      "styleSettings": {
                        "borderStyle": "rounded"
                      }
                    },
                    "statSettings": {
                      "valueAggregation": "Count",
                      "colorSettings": {
                        "type": "static",
                        "mode": "foreground",
                        "heatmapPalette": "greenRed",
                        "heatmapMin": 0,
                        "heatmapMax": 1,
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": ">=",
                            "thresholdValue": "0",
                            "representation": "AddTile"
                          }
                        ]
                      },
                      "tagText": "",
                      "valueFontStyle": "auto",
                      "valueTooltipSettings": {
                        "tooltip": "The number of all Applications which are not assigned."
                      },
                      "valueField": "id"
                    }
                  },
                  "customWidth": "0",
                  "conditionalVisibility": {
                    "parameterName": "hide",
                    "comparison": "isEqualTo",
                    "value": "hide"
                  },
                  "name": "ModifiedAppsLast1h",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"6ecf3314-75c7-4572-a296-1ff1f09c52a9\",\"mergeType\":\"union\",\"leftTable\":\"AppsIsNullJson\",\"rightTable\":\"ModifiedAppsLast1h\"}],\"projectRename\":[{\"originalName\":\"id\",\"mergedName\":\"id\",\"fromId\":\"unknown\"},{\"originalName\":\"[AppsIsNullJson].id\",\"mergedName\":\"id1\",\"fromId\":\"6ecf3314-75c7-4572-a296-1ff1f09c52a9\"}]}",
                    "size": 4,
                    "title": "Modified Apps < 1h",
                    "queryType": 7,
                    "visualization": "stat",
                    "statSettings": {
                      "valueField": "id",
                      "valueAggregation": "Sum",
                      "valueTooltipSettings": {
                        "tooltip": "The number of Apps Modified in the Last 1 hours."
                      },
                      "colorSettings": {
                        "type": "static",
                        "mode": "background",
                        "heatmapPalette": "greenRed",
                        "thresholdsGrid": []
                      },
                      "iconSettings": {
                        "thresholdsGrid": [
                          {
                            "operator": "==",
                            "thresholdValue": "0",
                            "representation": "Wrench"
                          },
                          {
                            "operator": ">",
                            "thresholdValue": "0",
                            "representation": "Wrench"
                          }
                        ]
                      },
                      "tagText": "",
                      "valueFontStyle": "auto"
                    }
                  },
                  "customWidth": "0",
                  "showPin": false,
                  "name": "cardModifiedAppsLast1h",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                }
              ]
            },
            "name": "AppStatGroup"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Search by App Name",
              "expandable": true,
              "expanded": true,
              "items": [
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "parameters": [
                      {
                        "id": "4915333b-298d-4d4f-b508-930259de3ed5",
                        "version": "KqlParameterItem/1.0",
                        "name": "ParameterAppNameSearch",
                        "label": "App Name Search",
                        "type": 1,
                        "description": "Enter the name (or partial name) of the application you want to search for. (case sensitive)",
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "value": ""
                      },
                      {
                        "id": "6d0a9d93-6513-4e60-8f28-928dbae763cb",
                        "version": "KqlParameterItem/1.0",
                        "name": "ParameterAppAssigned",
                        "label": "App Assigned",
                        "type": 2,
                        "typeSettings": {
                          "additionalResourceOptions": [],
                          "showDefault": false
                        },
                        "jsonData": "[\r\n    {\r\n         \"value\": \"\",\r\n         \"label\": \"Any\",\r\n         \"selected\": \"true\"\r\n    },\r\n    {\r\n         \"value\": \"and isAssigned eq true\",\r\n         \"label\": \"Assigned\"\r\n    },\r\n    {\r\n         \"value\": \"and isAssigned eq false\",\r\n         \"label\": \"Not Assigned\"\r\n    }\r\n]",
                        "description": "Filter apps based on whether they are assigned to users/devices or not.",
                        "timeContext": {
                          "durationMs": 86400000
                        }
                      },
                      {
                        "id": "61430e06-c61f-465a-8294-5f8e133d40d0",
                        "version": "KqlParameterItem/1.0",
                        "name": "ParameterAppPublished",
                        "label": "App Published",
                        "type": 2,
                        "typeSettings": {
                          "additionalResourceOptions": [],
                          "showDefault": false
                        },
                        "jsonData": "[\r\n    {\r\n         \"value\": \"\",\r\n         \"label\": \"Any\",\r\n         \"selected\": \"true\"\r\n    },\r\n    {\r\n         \"value\": \"and publishingState eq 'published'\",\r\n         \"label\": \"Published\"\r\n    },\r\n    {\r\n         \"value\": \"and publishingState eq 'notPublished'\",\r\n         \"label\": \"Not Published\"\r\n    },\r\n    {\r\n         \"value\": \"and publishingState eq 'processing'\",\r\n         \"label\": \"Processing\"\r\n    }\r\n]",
                        "description": "Filter apps based on their publishing status: published, not published, or still being processed.",
                        "timeContext": {
                          "durationMs": 86400000
                        }
                      },
                      {
                        "version": "KqlParameterItem/1.0",
                        "name": "ParameterAppUploadState",
                        "label": "App Upload State",
                        "type": 2,
                        "typeSettings": {
                          "additionalResourceOptions": [],
                          "showDefault": false
                        },
                        "jsonData": "[\r\n    {\r\n         \"value\": \"\",\r\n         \"label\": \"Any\",\r\n         \"selected\": \"true\"\r\n    },\r\n    {\r\n         \"value\": \"and uploadState eq 0\",\r\n         \"label\": \"Not Ready\"\r\n    },\r\n    {\r\n         \"value\": \"and uploadState eq 1\",\r\n         \"label\": \"Ready\"\r\n    },\r\n    {\r\n         \"value\": \"and uploadState eq 2\",\r\n         \"label\": \"Processing\"\r\n    }\r\n]",
                        "description": "Filter apps based on their upload state: ready, not ready, or still processing.",
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "id": "26fc8f8e-0798-41ae-87aa-d9411790eca5"
                      },
                      {
                        "id": "19c09898-c724-42bc-8988-1aa28d8e54a9",
                        "version": "KqlParameterItem/1.0",
                        "name": "ParameterAppDependentAppCount",
                        "label": "Dependent App",
                        "type": 2,
                        "typeSettings": {
                          "additionalResourceOptions": [],
                          "showDefault": false
                        },
                        "jsonData": "[\r\n    {\r\n         \"value\": \"\",\r\n         \"label\": \"Any\",\r\n         \"selected\": \"true\"\r\n    },\r\n    {\r\n         \"value\": \"and dependentAppCount eq 0\",\r\n         \"label\": \"No Dependent App\"\r\n    },\r\n    {\r\n         \"value\": \"and dependentAppCount ne 0\",\r\n         \"label\": \"Has Dependent App\"\r\n    }\r\n]",
                        "description": "Filter apps based on whether they have any dependent applications. A dependent app is one that must be installed before this app.",
                        "timeContext": {
                          "durationMs": 86400000
                        }
                      },
                      {
                        "id": "380cd2a4-831f-444b-9f05-418d1e4793d6",
                        "version": "KqlParameterItem/1.0",
                        "name": "ParameterAppSupersedingAppCount",
                        "label": "Superseding App",
                        "type": 2,
                        "typeSettings": {
                          "additionalResourceOptions": [],
                          "showDefault": false
                        },
                        "jsonData": "[\r\n    {\r\n         \"value\": \"\",\r\n         \"label\": \"Any\",\r\n         \"selected\": \"true\"\r\n    },\r\n    {\r\n         \"value\": \"and supersedingAppCount eq 0\",\r\n         \"label\": \"No Superseding App\"\r\n    },\r\n    {\r\n         \"value\": \"and supersedingAppCount ne 0\",\r\n         \"label\": \"Has Superseding App\"\r\n    }\r\n]",
                        "description": "Filter apps based on whether they supersede other applications. A superseding app replaces or updates one or more other apps.",
                        "timeContext": {
                          "durationMs": 86400000
                        }
                      },
                      {
                        "id": "3ffaa544-291d-43dc-a31a-6b994aba7611",
                        "version": "KqlParameterItem/1.0",
                        "name": "ParameterAppSupersededAppCount",
                        "label": "Superseded App",
                        "type": 2,
                        "typeSettings": {
                          "additionalResourceOptions": [],
                          "showDefault": false
                        },
                        "jsonData": "[\r\n    {\r\n         \"value\": \"\",\r\n         \"label\": \"Any\",\r\n         \"selected\": \"true\"\r\n    },\r\n    {\r\n         \"value\": \"and supersededAppCount eq 0\",\r\n         \"label\": \"No Superseded App\"\r\n    },\r\n    {\r\n         \"value\": \"and supersededAppCount ne 0\",\r\n         \"label\": \"Has Superseded App\"\r\n    }\r\n]",
                        "description": "Filter apps based on whether they are superseded by other applications. A superseded app has been replaced by a newer version or alternative.",
                        "timeContext": {
                          "durationMs": 86400000
                        }
                      }
                    ],
                    "style": "pills",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "name": "parameters - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "Select an app to reveal detailed insights, which will be displayed in the lower section of the page.",
                    "style": "info"
                  },
                  "name": "text - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"ConsistencyLevel\",\"value\":\"eventual\"}],\"method\":\"GET\",\"path\":\"/beta/deviceAppManagement/mobileApps\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"contains(displayName,'{ParameterAppNameSearch}') {ParameterAppAssigned:value} {ParameterAppPublished:value} {ParameterAppUploadState:value} {ParameterAppDependentAppCount:value} {ParameterAppSupersedingAppCount:value} {ParameterAppSupersededAppCount:value}\"},{\"key\":\"$top\",\"value\":\"999\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$.id\",\"columnid\":\"ID\",\"columnType\":\"string\"},{\"path\":\"$.publisher\",\"columnid\":\"publisher\",\"columnType\":\"string\"},{\"path\":\"$.displayName\",\"columnid\":\"displayName\",\"columnType\":\"string\"},{\"path\":\"$.displayVersion\",\"columnid\":\"displayVersion\",\"columnType\":\"string\"},{\"path\":\"$.primaryBundleVersion\",\"columnid\":\"primaryBundleVersion\",\"columnType\":\"string\"},{\"path\":\"$.fileName\",\"columnid\":\"fileName\",\"columnType\":\"string\"},{\"path\":\"$.createdDateTime\",\"columnid\":\"createdDateTime\",\"columnType\":\"datetime\"},{\"path\":\"$.lastModifiedDateTime\",\"columnid\":\"lastModifiedDateTime\",\"columnType\":\"datetime\"},{\"path\":\"$.isAssigned\",\"columnid\":\"isAssigned\",\"columnType\":\"string\"},{\"path\":\"$.publishingState\",\"columnid\":\"PublishingState\",\"columnType\":\"string\"},{\"path\":\"$.uploadState\",\"columnid\":\"uploadState\",\"columnType\":\"long\"},{\"path\":\"$.roleScopeTagIds\",\"columnid\":\"roleScopeTagIds\",\"columnType\":\"string\"},{\"path\":\"$.dependentAppCount\",\"columnid\":\"dependentAppCount\",\"columnType\":\"long\"},{\"path\":\"$.supersedingAppCount\",\"columnid\":\"supersedingAppCount\",\"columnType\":\"long\"},{\"path\":\"$.supersededAppCount\",\"columnid\":\"supersededAppCount\",\"columnType\":\"long\"},{\"path\":\"$['@odata.type']\",\"columnid\":\"type\",\"columnType\":\"string\",\"substringRegexMatch\":\"^#microsoft.graph.\",\"substringReplace\":\"üßë‚Äçüíª\"},{\"path\":\"$['@odata.type']\",\"columnid\":\"AppType\",\"columnType\":\"string\",\"substringRegexMatch\":\"^#microsoft.graph.\",\"substringReplace\":\"microsoft.graph.\"}]}}]}",
                    "size": 0,
                    "exportedParameters": [
                      {
                        "fieldName": "ID",
                        "parameterName": "parameterAPPID"
                      },
                      {
                        "fieldName": "displayName",
                        "parameterName": "parameterAppDisplayName",
                        "parameterType": 1
                      },
                      {
                        "fieldName": "publisher",
                        "parameterName": "parameterAppPublisher",
                        "parameterType": 1
                      },
                      {
                        "fieldName": "primaryBundleVersion",
                        "parameterName": "parameterAppdisplayVersion",
                        "parameterType": 1,
                        "defaultValue": " "
                      },
                      {
                        "fieldName": "displayVersion",
                        "parameterName": "parameterAppdisplayVersion",
                        "parameterType": 1,
                        "defaultValue": " "
                      },
                      {
                        "fieldName": "dependentAppCount",
                        "parameterName": "parameterAppdependentAppCount",
                        "parameterType": 1
                      },
                      {
                        "fieldName": "supersedingAppCount",
                        "parameterName": "parameterAppsupersedingAppCount",
                        "parameterType": 1
                      },
                      {
                        "fieldName": "supersededAppCount",
                        "parameterName": "parameterAppsupersededAppCount",
                        "parameterType": 1
                      },
                      {
                        "fieldName": "createdDateTime",
                        "parameterName": "parameterAppcreatedDateTime",
                        "parameterType": 1
                      },
                      {
                        "fieldName": "lastModifiedDateTime",
                        "parameterName": "parameterApplastModifiedDateTime",
                        "parameterType": 1
                      },
                      {
                        "fieldName": "isAssigned",
                        "parameterName": "parameterAppisAssigned",
                        "parameterType": 1
                      },
                      {
                        "fieldName": "uploadState",
                        "parameterName": "parameterAppuploadState",
                        "parameterType": 1
                      },
                      {
                        "fieldName": "PublishingState",
                        "parameterName": "parameterApppublishingState",
                        "parameterType": 1
                      },
                      {
                        "fieldName": "AppType",
                        "parameterName": "parameterAppAppType",
                        "parameterType": 1
                      }
                    ],
                    "showExportToExcel": true,
                    "queryType": 14,
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "ID",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "GetMoreLicense",
                                "text": "...more"
                              }
                            ],
                            "customColumnWidthSetting": "13ch"
                          }
                        },
                        {
                          "columnMatch": "publisher",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "25ch"
                          }
                        },
                        {
                          "columnMatch": "displayName",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "45ch"
                          }
                        },
                        {
                          "columnMatch": "displayVersion",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "18ch"
                          }
                        },
                        {
                          "columnMatch": "primaryBundleVersion",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "25ch"
                          }
                        },
                        {
                          "columnMatch": "fileName",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "30ch"
                          }
                        },
                        {
                          "columnMatch": "createdDateTime",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "30ch"
                          }
                        },
                        {
                          "columnMatch": "lastModifiedDateTime",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "30ch"
                          }
                        },
                        {
                          "columnMatch": "isAssigned",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "15ch"
                          }
                        },
                        {
                          "columnMatch": "PublishingState",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "15ch"
                          }
                        },
                        {
                          "columnMatch": "uploadState",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "15ch"
                          }
                        },
                        {
                          "columnMatch": "type",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "id",
                          "formatter": 7,
                          "formatOptions": {
                            "linkTarget": "MsGraph",
                            "linkIsContextBlade": true,
                            "msGraphActionContext": {
                              "path": "/beta/deviceAppManagement/mobileApps/{8d88d01e-9e97-4593-8337-8d403e16afe0}/deviceStatuses",
                              "headers": [
                                {
                                  "key": "",
                                  "value": ""
                                }
                              ],
                              "params": [],
                              "httpMethod": "GET",
                              "description": "# Actions can potentially modify resources.\n## Please use caution and include a confirmation message in this description when authoring this command."
                            }
                          }
                        }
                      ],
                      "rowLimit": 1000,
                      "filter": true,
                      "hierarchySettings": {
                        "treeType": 1,
                        "groupBy": [
                          "type"
                        ],
                        "finalBy": "type"
                      },
                      "labelSettings": [
                        {
                          "columnId": "ID",
                          "label": "Link"
                        },
                        {
                          "columnId": "publisher",
                          "label": "Publisher"
                        },
                        {
                          "columnId": "displayName",
                          "label": "Display Name"
                        },
                        {
                          "columnId": "displayVersion",
                          "label": "Display Version"
                        },
                        {
                          "columnId": "primaryBundleVersion",
                          "label": "Primary Bundle Version"
                        },
                        {
                          "columnId": "fileName",
                          "label": "File Name"
                        },
                        {
                          "columnId": "createdDateTime",
                          "label": "Created Date Time"
                        },
                        {
                          "columnId": "lastModifiedDateTime",
                          "label": "Last Modified Date Time"
                        },
                        {
                          "columnId": "isAssigned",
                          "label": "isAssigned"
                        },
                        {
                          "columnId": "PublishingState",
                          "label": "Publishing State"
                        },
                        {
                          "columnId": "uploadState",
                          "label": "Upload State"
                        },
                        {
                          "columnId": "roleScopeTagIds",
                          "label": "Role Scope Tag Ids"
                        },
                        {
                          "columnId": "dependentAppCount",
                          "label": "Dependent App Count"
                        },
                        {
                          "columnId": "supersedingAppCount",
                          "label": "Superseding App Count"
                        },
                        {
                          "columnId": "supersededAppCount",
                          "label": "Superseded App Count"
                        },
                        {
                          "columnId": "type",
                          "label": "Type"
                        },
                        {
                          "columnId": "AppType",
                          "label": "App Type"
                        }
                      ]
                    }
                  },
                  "name": "Search by App Name"
                }
              ],
              "exportParameters": true
            },
            "name": "groupSearchbyAppName"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Advanced Application Inside",
              "expandable": true,
              "expanded": true,
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# App Informationen\r\n\r\n<div id=\"app-info-flex\" style=\"display: flex; gap: 40px; align-items: flex-start; margin-top: 24px;\">\r\n  <div class=\"app-info-box\" style=\"background: #f5f7fa; color: #222; padding: 24px 32px; border-radius: 12px; min-width: 260px; box-shadow: 0 2px 8px #0001;\">\r\n    <div style=\"font-size: 1.1em; margin-bottom: 18px;\">\r\n      <strong>Name:</strong><br>\r\n      {parameterAppDisplayName}\r\n    </div>\r\n    <div style=\"font-size: 1.1em; margin-bottom: 18px;\">\r\n      <strong>Version:</strong><br>\r\n      {parameterAppdisplayVersion}\r\n    </div>\r\n    <div style=\"font-size: 1.1em;\">\r\n      <strong>Publisher:</strong><br>\r\n      {parameterAppPublisher}\r\n    </div>\r\n  </div>\r\n  <div class=\"app-info-box\" style=\"background: #f5f7fa; color: #222; padding: 24px 32px; border-radius: 12px; min-width: 260px; box-shadow: 0 2px 8px #0001;\">\r\n    <div style=\"font-size: 1.1em; margin-bottom: 18px;\">\r\n      <strong>Is Assigned:</strong><br>\r\n      {parameterAppisAssigned}\r\n    </div>\r\n    <div style=\"font-size: 1.1em; margin-bottom: 18px;\">\r\n      <strong>Upload State:</strong><br>\r\n      {parameterAppuploadState}\r\n    </div>\r\n    <div style=\"font-size: 1.1em;\">\r\n      <strong>Publishing State:</strong><br>\r\n      {parameterApppublishingState}\r\n    </div>\r\n  </div>\r\n    <div class=\"app-info-box\" style=\"background: #f5f7fa; color: #222; padding: 24px 32px; border-radius: 12px; min-width: 260px; box-shadow: 0 2px 8px #0001;\">\r\n    <div style=\"font-size: 1.1em; margin-bottom: 18px;\">\r\n      <strong>Dependent Apps:</strong><br>\r\n      {parameterAppdependentAppCount}\r\n    </div>\r\n    <div style=\"font-size: 1.1em; margin-bottom: 18px;\">\r\n      <strong>Superseding Apps:</strong><br>\r\n      {parameterAppsupersedingAppCount}\r\n    </div>\r\n    <div style=\"font-size: 1.1em;\">\r\n      <strong>Superseded Apps:</strong><br>\r\n      {parameterAppsupersededAppCount}\r\n    </div>\r\n  </div>\r\n  <div class=\"app-info-box\" style=\"background: #f5f7fa; color: #222; padding: 24px 32px; border-radius: 12px; min-width: 260px; box-shadow: 0 2px 8px #0001;\">\r\n    <div style=\"font-size: 1.1em; margin-bottom: 18px;\">\r\n      <strong>App Type:</strong><br>\r\n      {parameterAppAppType}\r\n    </div>\r\n    <div style=\"font-size: 1.1em; margin-bottom: 18px;\">\r\n      <strong>Created:</strong><br>\r\n      {parameterAppcreatedDateTime}\r\n    </div>\r\n    <div style=\"font-size: 1.1em;\">\r\n      <strong>Last Modified:</strong><br>\r\n      {parameterApplastModifiedDateTime}\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<div style=\"margin-top: 32px;\">\r\n  <a href=\"https://intune.microsoft.com/#view/Microsoft_Intune_Apps/SettingsMenu/~/0/appId/{parameterAPPID}\" target=\"_blank\" style=\"display: inline-block; padding: 10px 28px; font-size: 1em; border-radius: 8px; border: none; background: #5cbbff; color: #fff; text-decoration: none; cursor: pointer; box-shadow: 0 1px 4px #0002;\">\r\n    Open in Intune\r\n  </a>\r\n</div>\r\n\r\n<script>\r\n  (function() {\r\n    const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;\r\n    if (prefersDark) {\r\n      document.querySelectorAll('.app-info-box').forEach(box => {\r\n        box.style.background = '#23272e';\r\n        box.style.color = '#f3f6fa';\r\n      });\r\n    }\r\n  })();\r\n</script>"
                  },
                  "name": "AppInformations"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "Basic App Informations",
                    "expandable": true,
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/beta/deviceAppManagement/mobileApps/{parameterAPPID}\",\"urlParams\":[],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$\",\"columns\":[]}}]}",
                          "size": 4,
                          "exportFieldName": "ID",
                          "exportParameterName": "parameterAPPID",
                          "showExportToExcel": true,
                          "exportToExcelOptions": "all",
                          "queryType": 14,
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "@odata.context",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "@odata.type",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "id",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "displayName",
                                "formatter": 1,
                                "formatOptions": {
                                  "linkTarget": "GenericDetails",
                                  "linkIsContextBlade": true
                                }
                              },
                              {
                                "columnMatch": "largeIcon",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "roleScopeTagIds",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "dependentAppCount",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "supersedingAppCount",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "supersededAppCount",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "ClientRequestId",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "channel",
                                "formatter": 5
                              }
                            ],
                            "rowLimit": 1000,
                            "filter": true,
                            "labelSettings": [
                              {
                                "columnId": "id",
                                "label": "id"
                              },
                              {
                                "columnId": "displayName",
                                "label": "Display Name"
                              },
                              {
                                "columnId": "description",
                                "label": "Description"
                              },
                              {
                                "columnId": "publisher",
                                "label": "Publisher"
                              },
                              {
                                "columnId": "createdDateTime",
                                "label": "Created Date Time"
                              },
                              {
                                "columnId": "lastModifiedDateTime",
                                "label": "Last Modified Date Time"
                              },
                              {
                                "columnId": "isFeatured",
                                "label": "isFeatured"
                              },
                              {
                                "columnId": "privacyInformationUrl",
                                "label": "Privacy Information Url"
                              },
                              {
                                "columnId": "informationUrl",
                                "label": "Information Url"
                              },
                              {
                                "columnId": "owner",
                                "label": "Owner"
                              },
                              {
                                "columnId": "developer",
                                "label": "Developer"
                              },
                              {
                                "columnId": "notes",
                                "label": "Notes"
                              },
                              {
                                "columnId": "uploadState",
                                "label": "Upload State"
                              },
                              {
                                "columnId": "publishingState",
                                "label": "Publishing State"
                              },
                              {
                                "columnId": "isAssigned",
                                "label": "isAssigned"
                              }
                            ]
                          }
                        },
                        "name": "QueryForApp"
                      }
                    ]
                  },
                  "name": "groupBasicAppInformations"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "App Assignments",
                    "expandable": true,
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/beta/deviceAppManagement/mobileApps/{parameterAPPID}/assignments\",\"urlParams\":[],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$.intent\",\"columnid\":\"intent\"},{\"path\":\"$.target..['@odata.type']\",\"columnid\":\"type\",\"columnType\":\"string\",\"substringRegexMatch\":\"^#microsoft.graph.\",\"substringReplace\":\" \"},{\"path\":\"$.target..groupId\",\"columnid\":\"groupId\"},{\"path\":\"$.target..deviceAndAppManagementAssignmentFilterId\",\"columnid\":\"deviceAndAppManagementAssignmentFilterId\"},{\"path\":\"$.target..deviceAndAppManagementAssignmentFilterType\",\"columnid\":\"deviceAndAppManagementAssignmentFilterType\"},{\"path\":\"$.settings..notifications\",\"columnid\":\"notifications\"},{\"path\":\"$.settings..restartSettings\",\"columnid\":\"restartSettings\"},{\"path\":\"$.settings..installTimeSettings\",\"columnid\":\"installTimeSettings\"},{\"path\":\"$.settings..deliveryOptimizationPriority\",\"columnid\":\"deliveryOptimizationPriority\"},{\"path\":\"$.settings..autoUpdateSettings\",\"columnid\":\"autoUpdateSettings\"},{\"path\":\"$.settings\",\"columnid\":\"settings\"}]}}]}",
                          "size": 0,
                          "exportFieldName": "ID",
                          "exportParameterName": "parameterAPPID",
                          "showExportToExcel": true,
                          "exportToExcelOptions": "all",
                          "queryType": 14,
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "settings",
                                "formatter": 1,
                                "formatOptions": {
                                  "linkTarget": "GenericDetails",
                                  "linkIsContextBlade": true
                                }
                              }
                            ],
                            "rowLimit": 1000,
                            "filter": true,
                            "sortBy": [
                              {
                                "itemKey": "intent",
                                "sortOrder": 2
                              }
                            ],
                            "labelSettings": [
                              {
                                "columnId": "intent",
                                "label": "Intent"
                              },
                              {
                                "columnId": "type",
                                "label": "Type"
                              },
                              {
                                "columnId": "groupId",
                                "label": "GroupId"
                              },
                              {
                                "columnId": "deviceAndAppManagementAssignmentFilterId",
                                "label": "DeviceAndAppManagementAssignmentFilterId"
                              },
                              {
                                "columnId": "deviceAndAppManagementAssignmentFilterType",
                                "label": "DeviceAndAppManagementAssignmentFilterType"
                              },
                              {
                                "columnId": "notifications",
                                "label": "Notifications"
                              },
                              {
                                "columnId": "restartSettings",
                                "label": "RestartSettings"
                              },
                              {
                                "columnId": "installTimeSettings",
                                "label": "InstallTimeSettings"
                              },
                              {
                                "columnId": "deliveryOptimizationPriority",
                                "label": "DeliveryOptimizationPriority"
                              },
                              {
                                "columnId": "autoUpdateSettings",
                                "label": "AutoUpdateSettings"
                              },
                              {
                                "columnId": "settings",
                                "label": "Settings"
                              }
                            ]
                          },
                          "sortBy": [
                            {
                              "itemKey": "intent",
                              "sortOrder": 2
                            }
                          ]
                        },
                        "name": "QueryForApp"
                      }
                    ]
                  },
                  "name": "groupAppAssignements"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "Apps with equal Display Name",
                    "expandable": true,
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/beta/deviceAppManagement/mobileApps\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"contains(displayName,'{parameterAppDisplayName}') and isof('{parameterAppAppType}')\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[]}}]}",
                          "size": 0,
                          "exportFieldName": "ID",
                          "exportParameterName": "parameterAPPID",
                          "showExportToExcel": true,
                          "exportToExcelOptions": "all",
                          "queryType": 14,
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "settings",
                                "formatter": 1,
                                "formatOptions": {
                                  "linkTarget": "GenericDetails",
                                  "linkIsContextBlade": true
                                }
                              }
                            ],
                            "rowLimit": 1000,
                            "filter": true,
                            "labelSettings": [
                              {
                                "columnId": "id",
                                "label": "Id"
                              },
                              {
                                "columnId": "displayName",
                                "label": "DisplayName"
                              },
                              {
                                "columnId": "description",
                                "label": "Description"
                              },
                              {
                                "columnId": "publisher",
                                "label": "Publisher"
                              },
                              {
                                "columnId": "largeIcon",
                                "label": "LargeIcon"
                              },
                              {
                                "columnId": "createdDateTime",
                                "label": "CreatedDateTime"
                              },
                              {
                                "columnId": "lastModifiedDateTime",
                                "label": "LastModifiedDateTime"
                              },
                              {
                                "columnId": "isFeatured",
                                "label": "isFeatured"
                              },
                              {
                                "columnId": "privacyInformationUrl",
                                "label": "PrivacyInformationUrl"
                              },
                              {
                                "columnId": "informationUrl",
                                "label": "InformationUrl"
                              },
                              {
                                "columnId": "owner",
                                "label": "Owner"
                              },
                              {
                                "columnId": "developer",
                                "label": "Developer"
                              },
                              {
                                "columnId": "notes",
                                "label": "Notes"
                              },
                              {
                                "columnId": "uploadState",
                                "label": "UploadState"
                              },
                              {
                                "columnId": "publishingState",
                                "label": "PublishingState"
                              },
                              {
                                "columnId": "isAssigned",
                                "label": "isAssigned"
                              },
                              {
                                "columnId": "roleScopeTagIds",
                                "label": "RoleScopeTagIds"
                              },
                              {
                                "columnId": "dependentAppCount",
                                "label": "DependentAppCount"
                              },
                              {
                                "columnId": "supersedingAppCount",
                                "label": "SupersedingAppCount"
                              },
                              {
                                "columnId": "supersededAppCount",
                                "label": "SupersededAppCount"
                              },
                              {
                                "columnId": "committedContentVersion",
                                "label": "CommittedContentVersion"
                              },
                              {
                                "columnId": "fileName",
                                "label": "FileName"
                              },
                              {
                                "columnId": "size",
                                "label": "Size"
                              },
                              {
                                "columnId": "primaryBundleId",
                                "label": "PrimaryBundleId"
                              },
                              {
                                "columnId": "primaryBundleVersion",
                                "label": "PrimaryBundleVersion"
                              },
                              {
                                "columnId": "ignoreVersionDetection",
                                "label": "IgnoreVersionDetection"
                              },
                              {
                                "columnId": "postInstallScript",
                                "label": "PostInstallScript"
                              },
                              {
                                "columnId": "includedApps",
                                "label": "IncludedApps"
                              },
                              {
                                "columnId": "minimumSupportedOperatingSystem",
                                "label": "MinimumSupportedOperatingSystem"
                              },
                              {
                                "columnId": "preInstallScript",
                                "label": "PreInstallScript"
                              }
                            ]
                          },
                          "sortBy": []
                        },
                        "name": "QueryForApp"
                      }
                    ]
                  },
                  "name": "groupAppEqualDisplayName"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "parameterAPPID",
              "comparison": "isNotEqualTo",
              "value": ""
            },
            "name": "GroupAdvancedAppInside",
            "styleSettings": {
              "margin": "10px 10px"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "tab",
        "comparison": "isEqualTo",
        "value": "Application"
      },
      "name": "ApplicationGroup"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "User Enrollment & Deployment ",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### üìä User Enrollment & Deployment \n\nüåê **Visit [IntuneMonitoring.com](https://intunemonitoring.com) for updates and to customize your dashboard**"
            },
            "name": "placeholder"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "tab",
        "comparison": "isEqualTo",
        "value": "Enrollment"
      },
      "name": "EnrollmentGroup"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Policies ",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### üìä Policies \n\nüåê **Visit [IntuneMonitoring.com](https://intunemonitoring.com) for updates and to customize your dashboard**"
            },
            "name": "placeholder"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "tab",
        "comparison": "isEqualTo",
        "value": "Policies"
      },
      "name": "PoliciesGroup"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Intune Audit Monitoring",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### üîç Intune Audit & Security Monitoring\n\n**Comprehensive audit trail analysis for Microsoft Intune operations with risk-based monitoring and alerting.**\n\n#### üìä Coverage Areas:\n- **üîê Security Operations**: Certificate management, privileged actions, anomaly detection\n- **üì± Application Management**: App assignments, deployments, policy changes\n- **üõ°Ô∏è Compliance Monitoring**: User access patterns, administrative activities\n- **‚ö†Ô∏è Real-time Alerting**: Suspicious activities, bulk operations, security violations\n\n---"
            },
            "name": "AuditIntro"
          },
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "tabs",
              "links": [
                {
                  "id": "audit-executive",
                  "cellValue": "auditTab",
                  "linkTarget": "parameter",
                  "linkLabel": "üìà Executive",
                  "subTarget": "Executive",
                  "style": "link"
                },
                {
                  "id": "audit-security",
                  "cellValue": "auditTab",
                  "linkTarget": "parameter",
                  "linkLabel": "üîê Security",
                  "subTarget": "Security",
                  "style": "link"
                },
                {
                  "id": "audit-operations",
                  "cellValue": "auditTab",
                  "linkTarget": "parameter",
                  "linkLabel": "‚öôÔ∏è Operations",
                  "subTarget": "Operations",
                  "style": "link"
                },
                {
                  "id": "audit-compliance",
                  "cellValue": "auditTab",
                  "linkTarget": "parameter",
                  "linkLabel": "üìã Compliance",
                  "subTarget": "Compliance",
                  "style": "link"
                },
                {
                  "id": "audit-alerts",
                  "cellValue": "auditTab",
                  "linkTarget": "parameter",
                  "linkLabel": "üö® Alerts",
                  "subTarget": "Alerts",
                  "style": "link"
                }
              ]
            },
            "name": "AuditTabs"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "audit-timerange",
                  "version": "KqlParameterItem/1.0",
                  "name": "AuditTimeRange",
                  "label": "Time Range",
                  "type": 4,
                  "description": "Select time range for audit analysis",
                  "value": {
                    "durationMs": 172800000
                  },
                  "typeSettings": {
                    "selectableValues": [
                      {
                        "durationMs": 1800000
                      },
                      {
                        "durationMs": 3600000
                      },
                      {
                        "durationMs": 14400000
                      },
                      {
                        "durationMs": 43200000
                      },
                      {
                        "durationMs": 86400000
                      },
                      {
                        "durationMs": 172800000
                      },
                      {
                        "durationMs": 259200000
                      },
                      {
                        "durationMs": 604800000
                      },
                      {
                        "durationMs": 1209600000
                      },
                      {
                        "durationMs": 2592000000
                      },
                      {
                        "durationMs": 5184000000
                      },
                      {
                        "durationMs": 7776000000
                      }
                    ],
                    "allowCustom": true
                  }
                },
                {
                  "id": "audit-actor-filter",
                  "version": "KqlParameterItem/1.0",
                  "name": "ActorFilter",
                  "label": "Actor (User)",
                  "type": 2,
                  "description": "Filter by specific user/actor",
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "query": "IntuneAuditLogs\n| where TimeGenerated {AuditTimeRange}\n| extend ActorUPN = tostring(parse_json(Properties).Actor.UPN)\n| where isnotempty(ActorUPN)\n| where OperationName !contains \"Create ClientCertificate\"\n| summarize Count = count() by ActorUPN\n| order by Count desc\n| project Value = ActorUPN, Label = strcat(ActorUPN, ' (', Count, ' operations)')\n| limit 50",
                  "value": [
                    "value::all"
                  ],
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::all"
                    ],
                    "selectAllValue": "*",
                    "showDefault": false
                  },
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces"
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "name": "AuditParameters"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Executive Dashboard",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "IntuneAuditLogs\n| where TimeGenerated {AuditTimeRange}\n| extend ActorUPN = tostring(parse_json(Properties).Actor.UPN)\n| where '*' in ({ActorFilter}) or ActorUPN in ({ActorFilter})\n| extend Category = tostring(Category), ActivityType = toint(parse_json(Properties).ActivityType)\n| where OperationName !contains \"Create ClientCertificate\"\n| extend \n    RiskLevel = case(\n        OperationName contains \"Delete\", \"High\",\n        OperationName contains \"Create\", \"Medium\",\n        OperationName contains \"Patch\", \"Low\",\n        \"Low\"\n    ),\n    OperationType = case(\n        ActivityType == 0, \"Create\",\n        ActivityType == 1, \"Delete\",\n        ActivityType == 2, \"Update\",\n        ActivityType == 3, \"Assign\",\n        \"Other\"\n    )\n| summarize \n    TotalOperations = count(),\n    UniqueActors = dcount(ActorUPN),\n    CriticalOps = countif(RiskLevel == \"Critical\"),\n    HighRiskOps = countif(RiskLevel == \"High\")\n| extend RiskScore = (CriticalOps * 4 + HighRiskOps * 2) * 100 / TotalOperations",
                    "size": 4,
                    "title": "Executive KPIs",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "TotalOperations",
                        "formatter": 1,
                        "formatOptions": {
                          "customDisplayName": "Total Operations"
                        }
                      },
                      "leftContent": {
                        "columnMatch": "TotalOperations",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "blue"
                        }
                      },
                      "secondaryContent": {
                        "columnMatch": "UniqueActors",
                        "formatter": 1,
                        "formatOptions": {
                          "customDisplayName": "Active Administrators"
                        }
                      },
                      "showBorder": false
                    }
                  },
                  "customWidth": "25",
                  "name": "ExecutiveKPI1"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "IntuneAuditLogs\n| where TimeGenerated {AuditTimeRange}\n| extend ActorUPN = tostring(parse_json(Properties).Actor.UPN)\n| where '*' in ({ActorFilter}) or ActorUPN in ({ActorFilter})\n| where OperationName !contains \"Create ClientCertificate\"\n| extend \n    RiskLevel = case(\n        OperationName contains \"Delete\", \"High\",\n        OperationName contains \"Create\", \"Medium\",\n        OperationName contains \"Patch\", \"Low\",\n        \"Low\"\n    )\n| summarize \n    TotalOperations = count(),\n    HighRiskOps = countif(RiskLevel == \"High\")\n| extend RiskScore = (HighRiskOps * 2) * 100 / TotalOperations\n| project RiskScore",
                    "size": 4,
                    "title": "Security Risk Score",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "RiskScore",
                        "formatter": 1,
                        "formatOptions": {
                          "customDisplayName": "Risk Score"
                        }
                      },
                      "leftContent": {
                        "columnMatch": "RiskScore",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "redBright",
                          "thresholdsOptions": "colors",
                          "thresholdsGrid": [
                            {
                              "operator": "<",
                              "thresholdValue": "25",
                              "representation": "green"
                            },
                            {
                              "operator": "<",
                              "thresholdValue": "50",
                              "representation": "yellow"
                            },
                            {
                              "operator": ">=",
                              "thresholdValue": "50",
                              "representation": "redBright"
                            }
                          ]
                        },
                        "numberFormat": {
                          "unit": 1,
                          "options": {
                            "style": "decimal",
                            "maximumFractionDigits": 1
                          }
                        }
                      },
                      "showBorder": false
                    }
                  },
                  "customWidth": "25",
                  "name": "RiskScore"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "IntuneAuditLogs\n| where TimeGenerated {AuditTimeRange}\n| extend ActorUPN = tostring(parse_json(Properties).Actor.UPN)\n| where '*' in ({ActorFilter}) or ActorUPN in ({ActorFilter})\n| where OperationName !contains \"Create ClientCertificate\"\n| extend ActivityType = toint(parse_json(Properties).ActivityType)\n| extend \n    OperationType = case(\n        ActivityType == 0, \"Create\",\n        ActivityType == 1, \"Delete\",\n        ActivityType == 2, \"Update\",\n        ActivityType == 3, \"Assign\",\n        \"Other\"\n    )\n| summarize Count = count() by TimeGenerated = bin(TimeGenerated, 1h), OperationType\n| render timechart",
                    "size": 0,
                    "title": "Operations Trend (Hourly)",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "areachart"
                  },
                  "customWidth": "50",
                  "name": "OperationsTrend"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "IntuneAuditLogs\n| where TimeGenerated {AuditTimeRange}\n| extend ActorUPN = tostring(parse_json(Properties).Actor.UPN)\n| where '*' in ({ActorFilter}) or ActorUPN in ({ActorFilter})\n| where OperationName !contains \"Create ClientCertificate\"\n| extend \n    RiskLevel = case(\n        OperationName contains \"Delete\", \"High\",\n        OperationName contains \"Create\", \"Medium\",\n        OperationName contains \"Patch\", \"Low\",\n        \"Low\"\n    )\n| summarize Count = count() by RiskLevel\n| extend Percentage = Count * 100.0 / toscalar(\n    IntuneAuditLogs\n    | where TimeGenerated {AuditTimeRange}\n    | extend ActorUPN = tostring(parse_json(Properties).Actor.UPN)\n    | where '*' in ({ActorFilter}) or ActorUPN in ({ActorFilter})\n    | where OperationName !contains \"Create ClientCertificate\"\n    | count\n)\n| project RiskLevel, Count, Percentage\n| order by \n    case(\n        RiskLevel == \"High\", 1,\n        RiskLevel == \"Medium\", 2,\n        RiskLevel == \"Low\", 3,\n        4\n    )",
                    "size": 0,
                    "title": "Risk Distribution",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "piechart"
                  },
                  "customWidth": "50",
                  "name": "RiskDistribution"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "auditTab",
              "comparison": "isEqualTo",
              "value": "Executive"
            },
            "name": "ExecutiveDashboard"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Security Operations Center",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "IntuneAuditLogs\n| where TimeGenerated {AuditTimeRange}\n| extend ActorUPN = tostring(parse_json(Properties).Actor.UPN)\n| where '*' in ({ActorFilter}) or ActorUPN in ({ActorFilter})\n| where OperationName !contains \"Create ClientCertificate\"\n| extend HourOfDay = hourofday(TimeGenerated)\n| where HourOfDay < 6 or HourOfDay > 20  // Outside business hours (6 AM - 8 PM)\n| extend \n    RiskLevel = case(\n        OperationName contains \"Delete\", \"High\",\n        OperationName contains \"Create\", \"Medium\",\n        \"Low\"\n    )\n| project \n    TimeGenerated,\n    ActorUPN,\n    OperationName,\n    RiskLevel,\n    HourOfDay,\n    ResultType\n| order by TimeGenerated desc",
                    "size": 0,
                    "title": "‚è∞ Off-Hours Activity",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "table",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RiskLevel",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "colors",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Critical",
                                "representation": "redBright"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "High",
                                "representation": "orange"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Medium",
                                "representation": "yellow"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "green"
                              }
                            ]
                          }
                        }
                      ]
                    }
                  },
                  "customWidth": "100",
                  "name": "OffHoursActivity"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "IntuneAuditLogs\n| where TimeGenerated {AuditTimeRange}\n| extend ActorUPN = tostring(parse_json(Properties).Actor.UPN)\n| where '*' in ({ActorFilter}) or ActorUPN in ({ActorFilter})\n| where OperationName !contains \"Create ClientCertificate\"\n| extend TargetCount = array_length(parse_json(Properties).TargetObjectIds)\n| where TargetCount >= 5  // Bulk operations (5+ targets)\n| project \n    TimeGenerated,\n    ActorUPN,\n    OperationName,\n    TargetCount,\n    CorrelationId,\n    ResultType\n| order by TargetCount desc, TimeGenerated desc",
                    "size": 0,
                    "title": "üì¶ Bulk Operations (5+ Targets)",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "table",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "TargetCount",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "redBright"
                          }
                        }
                      ]
                    }
                  },
                  "customWidth": "100",
                  "name": "BulkOperations"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "auditTab",
              "comparison": "isEqualTo",
              "value": "Security"
            },
            "name": "SecurityOperations"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "### ‚öôÔ∏è Operations Overview\n\nMonitor administrative operations that impact your Intune environment including policy changes, application management, and configuration updates."
                  },
                  "name": "OperationsIntro"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "IntuneAuditLogs\n| where TimeGenerated {AuditTimeRange}\n| extend ActorUPN = tostring(parse_json(Properties).Actor.UPN)\n| where '*' in ({ActorFilter}) or ActorUPN in ({ActorFilter})\n| where OperationName !contains \"Create ClientCertificate\"\n| where OperationName contains \"Policy\" or OperationName contains \"Configuration\" or OperationName contains \"Profile\"\n| extend \n    ChangeType = case(\n        OperationName contains \"Create\", \"Created\",\n        OperationName contains \"Delete\", \"Deleted\",\n        OperationName contains \"Patch\" or OperationName contains \"Update\", \"Modified\",\n        \"Other\"\n    ),\n    PolicyType = case(\n        OperationName contains \"DeviceConfiguration\", \"Device Configuration\",\n        OperationName contains \"DeviceCompliancePolicy\", \"Compliance Policy\",\n        OperationName contains \"DeviceManagementConfigurationPolicy\", \"Settings Catalog\",\n        OperationName contains \"WindowsAutopilotDeploymentProfile\", \"Autopilot Profile\",\n        OperationName contains \"DeviceEnrollmentConfiguration\", \"Enrollment Configuration\",\n        \"Other Policy\"\n    )\n| summarize OperationCount = count() by PolicyType, ChangeType, TimeGenerated = bin(TimeGenerated, 1h)\n| order by TimeGenerated desc, OperationCount desc",
                    "size": 0,
                    "title": "üìã Policy Changes Over Time",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "areachart",
                    "chartSettings": {
                      "xAxis": "TimeGenerated",
                      "yAxis": [
                        "OperationCount"
                      ],
                      "group": "PolicyType",
                      "xSettings": {
                        "numberFormatSettings": {
                          "unit": 17,
                          "options": {
                            "style": "decimal"
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "PolicyChangesChart"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "IntuneAuditLogs\n| where TimeGenerated {AuditTimeRange}\n| extend ActorUPN = tostring(parse_json(Properties).Actor.UPN)\n| where '*' in ({ActorFilter}) or ActorUPN in ({ActorFilter})\n| where OperationName !contains \"Create ClientCertificate\"\n| where OperationName contains \"MobileApp\" or OperationName contains \"Application\"\n| extend \n    AppOperation = case(\n        OperationName contains \"Create\", \"App Created\",\n        OperationName contains \"Delete\", \"App Deleted\",\n        OperationName contains \"Patch\", \"App Modified\",\n        OperationName contains \"Assignment\", \"Assignment Changed\",\n        \"Other\"\n    )\n| summarize Count = count() by AppOperation, TimeGenerated = bin(TimeGenerated, 1d)\n| order by TimeGenerated desc",
                    "size": 0,
                    "title": "üì± Application Management Activities",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "columnchart",
                    "chartSettings": {
                      "xAxis": "TimeGenerated",
                      "yAxis": [
                        "Count"
                      ],
                      "group": "AppOperation"
                    }
                  },
                  "customWidth": "50",
                  "name": "AppManagementChart"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "IntuneAuditLogs\n| where TimeGenerated {AuditTimeRange}\n| extend ActorUPN = tostring(parse_json(Properties).Actor.UPN)\n| where '*' in ({ActorFilter}) or ActorUPN in ({ActorFilter})\n| where OperationName !contains \"Create ClientCertificate\"\n| where OperationName contains \"Policy\" or OperationName contains \"Configuration\" or OperationName contains \"Profile\"\n| extend \n    TargetResource = tostring(parse_json(Properties).TargetDisplayNames[0]),\n    ChangeType = case(\n        OperationName contains \"Create\", \"‚úÖ Created\",\n        OperationName contains \"Delete\", \"‚ùå Deleted\", \n        OperationName contains \"Patch\", \"üìù Modified\",\n        \"üîÑ Other\"\n    ),\n    PolicyCategory = case(\n        OperationName contains \"DeviceConfiguration\", \"Device Configuration\",\n        OperationName contains \"DeviceCompliancePolicy\", \"Compliance Policy\",\n        OperationName contains \"DeviceManagementConfigurationPolicy\", \"Settings Catalog\",\n        OperationName contains \"WindowsAutopilotDeploymentProfile\", \"Autopilot Profile\",\n        \"Other Policy Type\"\n    )\n| project \n    TimeGenerated,\n    ActorUPN,\n    PolicyCategory,\n    ChangeType,\n    TargetResource,\n    OperationName,\n    ResultType\n| order by TimeGenerated desc\n| take 100",
                    "size": 0,
                    "title": "üìã Recent Policy Changes (Last 100)",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "table",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "ChangeType",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "contains",
                                "thresholdValue": "Created",
                                "representation": "success",
                                "text": "‚úÖ"
                              },
                              {
                                "operator": "contains",
                                "thresholdValue": "Deleted",
                                "representation": "critical",
                                "text": "‚ùå"
                              },
                              {
                                "operator": "contains",
                                "thresholdValue": "Modified",
                                "representation": "warning",
                                "text": "üìù"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "ResultType",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "colors",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Success",
                                "representation": "green"
                              },
                              {
                                "operator": "!=",
                                "thresholdValue": "Success",
                                "representation": "redBright"
                              }
                            ]
                          }
                        }
                      ]
                    }
                  },
                  "customWidth": "100",
                  "name": "PolicyChangesTable"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "IntuneAuditLogs\n| where TimeGenerated {AuditTimeRange}\n| extend ActorUPN = tostring(parse_json(Properties).Actor.UPN)\n| where '*' in ({ActorFilter}) or ActorUPN in ({ActorFilter})\n| where OperationName !contains \"Create ClientCertificate\"\n| where OperationName contains \"MobileApp\" or OperationName contains \"Application\"\n| extend \n    AppName = tostring(parse_json(Properties).TargetDisplayNames[0]),\n    AppAction = case(\n        OperationName contains \"Create\", \"üÜï Created\",\n        OperationName contains \"Delete\", \"üóëÔ∏è Deleted\",\n        OperationName contains \"Patch\", \"‚úèÔ∏è Modified\",\n        OperationName contains \"Assignment\", \"üéØ Assignment Changed\",\n        \"üîÑ Other\"\n    )\n| project \n    TimeGenerated,\n    ActorUPN,\n    AppAction,\n    AppName,\n    OperationName,\n    ResultType\n| order by TimeGenerated desc\n| take 50",
                    "size": 0,
                    "title": "üì± Recent Application Operations (Last 50)",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "table",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "AppAction",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "contains",
                                "thresholdValue": "Created",
                                "representation": "success",
                                "text": "üÜï"
                              },
                              {
                                "operator": "contains",
                                "thresholdValue": "Deleted",
                                "representation": "critical",
                                "text": "üóëÔ∏è"
                              },
                              {
                                "operator": "contains",
                                "thresholdValue": "Modified",
                                "representation": "warning",
                                "text": "‚úèÔ∏è"
                              },
                              {
                                "operator": "contains",
                                "thresholdValue": "Assignment",
                                "representation": "info",
                                "text": "üéØ"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "ResultType",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "colors",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Success",
                                "representation": "green"
                              },
                              {
                                "operator": "!=",
                                "thresholdValue": "Success",
                                "representation": "redBright"
                              }
                            ]
                          }
                        }
                      ]
                    }
                  },
                  "customWidth": "100",
                  "name": "ApplicationOperationsTable"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "auditTab",
              "comparison": "isEqualTo",
              "value": "Operations"
            },
            "name": "OperationsTab"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "### üìã Compliance Monitoring\n\nTrack device compliance operations, policy assignments, and enforcement actions across your Intune environment."
                  },
                  "name": "ComplianceIntro"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "IntuneAuditLogs\n| where TimeGenerated {AuditTimeRange}\n| extend ActorUPN = tostring(parse_json(Properties).Actor.UPN)\n| where '*' in ({ActorFilter}) or ActorUPN in ({ActorFilter})\n| where OperationName !contains \"Create ClientCertificate\"\n| where OperationName contains \"Compliance\" or OperationName contains \"DeviceHealthScript\" or OperationName contains \"RemediationScript\"\n| extend \n    ComplianceAction = case(\n        OperationName contains \"DeviceCompliancePolicy\", \"Policy Management\",\n        OperationName contains \"DeviceHealthScript\", \"Health Script\",\n        OperationName contains \"RemediationScript\", \"Remediation Script\",\n        OperationName contains \"Assignment\", \"Assignment Change\",\n        \"Other Compliance\"\n    ),\n    ActionType = case(\n        OperationName contains \"Create\", \"Created\",\n        OperationName contains \"Delete\", \"Deleted\",\n        OperationName contains \"Patch\", \"Modified\",\n        \"Other\"\n    )\n| summarize Count = count() by ComplianceAction, ActionType, TimeGenerated = bin(TimeGenerated, 1d)\n| order by TimeGenerated desc",
                    "size": 0,
                    "title": "üìä Compliance Activities Over Time",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "areachart",
                    "chartSettings": {
                      "xAxis": "TimeGenerated",
                      "yAxis": [
                        "Count"
                      ],
                      "group": "ComplianceAction"
                    }
                  },
                  "customWidth": "50",
                  "name": "ComplianceChart"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "IntuneAuditLogs\n| where TimeGenerated {AuditTimeRange}\n| extend ActorUPN = tostring(parse_json(Properties).Actor.UPN)\n| where '*' in ({ActorFilter}) or ActorUPN in ({ActorFilter})\n| where OperationName !contains \"Create ClientCertificate\"\n| where ResultType != \"Success\"\n| summarize FailedOperations = count() by OperationName, ResultType\n| order by FailedOperations desc\n| take 10",
                    "size": 0,
                    "title": "‚ö†Ô∏è Top Failed Operations",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "piechart"
                  },
                  "customWidth": "50",
                  "name": "FailedOperationsChart"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "IntuneAuditLogs\n| where TimeGenerated {AuditTimeRange}\n| extend ActorUPN = tostring(parse_json(Properties).Actor.UPN)\n| where '*' in ({ActorFilter}) or ActorUPN in ({ActorFilter})\n| where OperationName !contains \"Create ClientCertificate\"\n| where OperationName contains \"Compliance\" or OperationName contains \"DeviceHealthScript\"\n| extend \n    ResourceName = tostring(parse_json(Properties).TargetDisplayNames[0]),\n    ComplianceType = case(\n        OperationName contains \"DeviceCompliancePolicy\", \"üõ°Ô∏è Compliance Policy\",\n        OperationName contains \"DeviceHealthScript\", \"üíä Health Script\",\n        OperationName contains \"RemediationScript\", \"üîß Remediation Script\",\n        \"üìã Other\"\n    ),\n    Action = case(\n        OperationName contains \"Create\", \"‚ûï Created\",\n        OperationName contains \"Delete\", \"‚ùå Deleted\",\n        OperationName contains \"Patch\", \"üìù Modified\",\n        \"üîÑ Other\"\n    )\n| project \n    TimeGenerated,\n    ActorUPN,\n    ComplianceType,\n    Action,\n    ResourceName,\n    OperationName,\n    ResultType\n| order by TimeGenerated desc\n| take 50",
                    "size": 0,
                    "title": "üìã Recent Compliance Operations (Last 50)",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "table",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Action",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "contains",
                                "thresholdValue": "Created",
                                "representation": "success",
                                "text": "‚ûï"
                              },
                              {
                                "operator": "contains",
                                "thresholdValue": "Deleted",
                                "representation": "critical",
                                "text": "‚ùå"
                              },
                              {
                                "operator": "contains",
                                "thresholdValue": "Modified",
                                "representation": "warning",
                                "text": "üìù"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "ResultType",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "colors",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Success",
                                "representation": "green"
                              },
                              {
                                "operator": "!=",
                                "thresholdValue": "Success",
                                "representation": "redBright"
                              }
                            ]
                          }
                        }
                      ]
                    }
                  },
                  "customWidth": "100",
                  "name": "ComplianceOperationsTable"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "auditTab",
              "comparison": "isEqualTo",
              "value": "Compliance"
            },
            "name": "ComplianceTab"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "### üö® Security Alerts & Monitoring\n\nReal-time alerting for critical security events, suspicious activities, and administrative actions requiring attention."
                  },
                  "name": "AlertsIntro"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "IntuneAuditLogs\n| where TimeGenerated {AuditTimeRange}\n| extend ActorUPN = tostring(parse_json(Properties).Actor.UPN)\n| where '*' in ({ActorFilter}) or ActorUPN in ({ActorFilter})\n| where OperationName !contains \"Create ClientCertificate\"\n| extend \n    AlertLevel = case(\n        OperationName contains \"Delete\" and (OperationName contains \"Policy\" or OperationName contains \"Configuration\"), \"üî¥ Critical\",\n        ResultType != \"Success\" and OperationName contains \"Delete\", \"üü† High\",\n        OperationName contains \"Assignment\" and ResultType != \"Success\", \"üü° Medium\",\n        ResultType != \"Success\", \"üîµ Low\",\n        \"‚úÖ Normal\"\n    ),\n    AlertCategory = case(\n        OperationName contains \"Delete\", \"Deletion Alert\",\n        ResultType != \"Success\", \"Failure Alert\", \n        OperationName contains \"Assignment\", \"Assignment Alert\",\n        \"Information\"\n    )\n| where AlertLevel != \"‚úÖ Normal\"\n| summarize AlertCount = count() by AlertLevel, AlertCategory, TimeGenerated = bin(TimeGenerated, 1h)\n| order by TimeGenerated desc",
                    "size": 0,
                    "title": "üö® Security Alerts Timeline",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "areachart",
                    "chartSettings": {
                      "xAxis": "TimeGenerated",
                      "yAxis": [
                        "AlertCount"
                      ],
                      "group": "AlertLevel"
                    }
                  },
                  "customWidth": "60",
                  "name": "AlertsChart"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "IntuneAuditLogs\n| where TimeGenerated {AuditTimeRange}\n| extend ActorUPN = tostring(parse_json(Properties).Actor.UPN)\n| where '*' in ({ActorFilter}) or ActorUPN in ({ActorFilter})\n| where OperationName !contains \"Create ClientCertificate\"\n| extend \n    AlertLevel = case(\n        OperationName contains \"Delete\" and (OperationName contains \"Policy\" or OperationName contains \"Configuration\"), \"Critical\",\n        ResultType != \"Success\" and OperationName contains \"Delete\", \"High\",\n        OperationName contains \"Assignment\" and ResultType != \"Success\", \"Medium\",\n        ResultType != \"Success\", \"Low\",\n        \"Normal\"\n    )\n| where AlertLevel != \"Normal\"\n| summarize Count = count() by AlertLevel\n| order by \n    case(\n        AlertLevel == \"Critical\", 1,\n        AlertLevel == \"High\", 2,\n        AlertLevel == \"Medium\", 3,\n        AlertLevel == \"Low\", 4,\n        5\n    )",
                    "size": 3,
                    "title": "üéØ Alert Summary",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "AlertLevel",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "Count",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "maximumFractionDigits": 0
                          }
                        }
                      },
                      "secondaryContent": {
                        "columnMatch": "AlertLevel",
                        "formatter": 1
                      },
                      "showBorder": false
                    }
                  },
                  "customWidth": "40",
                  "name": "AlertSummaryTiles"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "IntuneAuditLogs\n| where TimeGenerated {AuditTimeRange}\n| extend ActorUPN = tostring(parse_json(Properties).Actor.UPN)\n| where '*' in ({ActorFilter}) or ActorUPN in ({ActorFilter})\n| where OperationName !contains \"Create ClientCertificate\"\n| extend \n    AlertLevel = case(\n        OperationName contains \"Delete\" and (OperationName contains \"Policy\" or OperationName contains \"Configuration\"), \"üî¥ Critical\",\n        ResultType != \"Success\" and OperationName contains \"Delete\", \"üü† High\",\n        OperationName contains \"Assignment\" and ResultType != \"Success\", \"üü° Medium\",\n        ResultType != \"Success\", \"üîµ Low\",\n        \"‚úÖ Normal\"\n    )\n| where AlertLevel != \"‚úÖ Normal\"\n| extend \n    ResourceName = iif(isnotnull(parse_json(Properties).TargetDisplayNames) and array_length(parse_json(Properties).TargetDisplayNames) > 0, tostring(parse_json(Properties).TargetDisplayNames[0]), \"N/A\"),\n    AlertDescription = case(\n        OperationName contains \"Delete\" and (OperationName contains \"Policy\" or OperationName contains \"Configuration\"), strcat(\"Policy/Configuration deleted: \", ResourceName),\n        ResultType != \"Success\", strcat(\"Operation failed: \", OperationName, \" - \", ResultType),\n        strcat(\"Operation: \", OperationName)\n    )\n| project \n    TimeGenerated,\n    AlertLevel,\n    ActorUPN,\n    AlertDescription,\n    ResourceName,\n    OperationName,\n    ResultType,\n    CorrelationId\n| order by \n    case(\n        AlertLevel == \"üî¥ Critical\", 1,\n        AlertLevel == \"üü† High\", 2,\n        AlertLevel == \"üü° Medium\", 3,\n        AlertLevel == \"üîµ Low\", 4,\n        5\n    ), TimeGenerated desc\n| take 100",
                    "size": 0,
                    "title": "üö® Active Security Alerts (Last 100)",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "table",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "AlertLevel",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "colors",
                            "thresholdsGrid": [
                              {
                                "operator": "contains",
                                "thresholdValue": "Critical",
                                "representation": "redBright"
                              },
                              {
                                "operator": "contains",
                                "thresholdValue": "High",
                                "representation": "orange"
                              },
                              {
                                "operator": "contains",
                                "thresholdValue": "Medium",
                                "representation": "yellow"
                              },
                              {
                                "operator": "contains",
                                "thresholdValue": "Low",
                                "representation": "blue"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "ResultType",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "colors",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Success",
                                "representation": "green"
                              },
                              {
                                "operator": "!=",
                                "thresholdValue": "Success",
                                "representation": "redBright"
                              }
                            ]
                          }
                        }
                      ]
                    }
                  },
                  "customWidth": "100",
                  "name": "SecurityAlertsTable"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "IntuneAuditLogs\n| where TimeGenerated {AuditTimeRange}\n| extend ActorUPN = tostring(parse_json(Properties).Actor.UPN)\n| where '*' in ({ActorFilter}) or ActorUPN in ({ActorFilter})\n| where OperationName !contains \"Create ClientCertificate\"\n| extend BusinessHour = hourofday(TimeGenerated)\n| where BusinessHour < 6 or BusinessHour > 20  // Off-hours: before 6 AM or after 8 PM\n| extend \n    RiskLevel = case(\n        OperationName contains \"Delete\", \"High Risk\",\n        OperationName contains \"Create\" or OperationName contains \"Patch\", \"Medium Risk\",\n        \"Low Risk\"\n    )\n| summarize \n    OffHoursCount = count(),\n    UniqueUsers = dcount(ActorUPN),\n    Operations = make_set(OperationName, 5)\n by ActorUPN, RiskLevel, TimeGenerated = bin(TimeGenerated, 1d)\n| order by OffHoursCount desc, TimeGenerated desc\n| take 20",
                    "size": 0,
                    "title": "üåô Off-Hours Activity Monitoring",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "table",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RiskLevel",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "colors",
                            "thresholdsGrid": [
                              {
                                "operator": "contains",
                                "thresholdValue": "High",
                                "representation": "redBright"
                              },
                              {
                                "operator": "contains",
                                "thresholdValue": "Medium",
                                "representation": "yellow"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "green"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "OffHoursCount",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "redBright"
                          }
                        }
                      ]
                    }
                  },
                  "customWidth": "100",
                  "name": "OffHoursActivityTable"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "auditTab",
              "comparison": "isEqualTo",
              "value": "Alerts"
            },
            "name": "AlertsTab"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "tab",
        "comparison": "isEqualTo",
        "value": "Audit"
      },
      "name": "AuditGroup"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Browser Extensions",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### üåê Browser Extensions Inventory\n\nThis dashboard provides comprehensive monitoring of browser extensions across your managed devices. Data is collected from Chrome, Edge, and Firefox browsers using the PowerShell script that uploads extension information to the `DevicesBrowserExtensionsInventory_CL` table.\n\n**Data Collection Scope:**\n- **Chrome** and **Microsoft Edge** extensions from user profiles\n- **Firefox** add-ons from user profiles\n- Extension details including name, version, and installation status\n- User and device association information"
            },
            "name": "ExtensionsIntro"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "DevicesBrowserExtensionsInventory_CL\n| summarize DeviceCount = dcount(DeviceName_s), ExtensionCount = dcount(ExtensionID_s), TotalInstallations = count() by TimeGenerated_t = bin(TimeGenerated, 1d)\n| order by TimeGenerated_t desc\n| take 1\n| project DeviceCount, ExtensionCount, TotalInstallations",
              "size": 4,
              "title": "Extension Statistics Overview",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "tiles",
              "tileSettings": {
                "titleContent": {
                  "columnMatch": "DeviceCount",
                  "formatter": 1,
                  "formatOptions": {
                    "customDisplayName": "Devices with Extensions"
                  }
                },
                "leftContent": {
                  "columnMatch": "DeviceCount",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "blue"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "style": "decimal",
                      "useGrouping": false,
                      "maximumFractionDigits": 2,
                      "maximumSignificantDigits": 3
                    }
                  }
                },
                "secondaryContent": {
                  "columnMatch": "ExtensionCount",
                  "formatter": 1,
                  "formatOptions": {
                    "customDisplayName": "Unique Extensions"
                  }
                },
                "showBorder": false
              }
            },
            "customWidth": "33",
            "name": "ExtensionStats1"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "DevicesBrowserExtensionsInventory_CL\n| summarize DeviceCount = dcount(DeviceName_s), ExtensionCount = dcount(ExtensionID_s), TotalInstallations = count() by TimeGenerated_t = bin(TimeGenerated, 1d)\n| order by TimeGenerated_t desc\n| take 1\n| project DeviceCount, ExtensionCount, TotalInstallations",
              "size": 4,
              "title": "Extension Statistics Overview",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "tiles",
              "tileSettings": {
                "titleContent": {
                  "columnMatch": "ExtensionCount",
                  "formatter": 1,
                  "formatOptions": {
                    "customDisplayName": "Unique Extensions"
                  }
                },
                "leftContent": {
                  "columnMatch": "ExtensionCount",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "green"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "style": "decimal",
                      "useGrouping": false,
                      "maximumFractionDigits": 2,
                      "maximumSignificantDigits": 3
                    }
                  }
                },
                "secondaryContent": {
                  "columnMatch": "TotalInstallations",
                  "formatter": 1,
                  "formatOptions": {
                    "customDisplayName": "Total Installations"
                  }
                },
                "showBorder": false
              }
            },
            "customWidth": "33",
            "name": "ExtensionStats2"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "DevicesBrowserExtensionsInventory_CL\n| summarize DeviceCount = dcount(DeviceName_s), ExtensionCount = dcount(ExtensionID_s), TotalInstallations = count() by TimeGenerated_t = bin(TimeGenerated, 1d)\n| order by TimeGenerated_t desc\n| take 1\n| project DeviceCount, ExtensionCount, TotalInstallations",
              "size": 4,
              "title": "Extension Statistics Overview",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "tiles",
              "tileSettings": {
                "titleContent": {
                  "columnMatch": "TotalInstallations",
                  "formatter": 1,
                  "formatOptions": {
                    "customDisplayName": "Total Installations"
                  }
                },
                "leftContent": {
                  "columnMatch": "TotalInstallations",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "orange"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "style": "decimal",
                      "useGrouping": false,
                      "maximumFractionDigits": 2,
                      "maximumSignificantDigits": 3
                    }
                  }
                },
                "showBorder": false
              }
            },
            "customWidth": "33",
            "name": "ExtensionStats3"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "DevicesBrowserExtensionsInventory_CL\n| summarize InstallCount = count() by Browser_s\n| order by InstallCount desc",
              "size": 1,
              "title": "Extensions by Browser",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "piechart",
              "chartSettings": {
                "showLegend": true,
                "showDataLabels": true
              }
            },
            "customWidth": "50",
            "name": "ExtensionsByBrowser"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "DevicesBrowserExtensionsInventory_CL\n| summarize InstallCount = count() by ExtensionName_s\n| top 10 by InstallCount desc\n| order by InstallCount desc",
              "size": 1,
              "title": "Top 10 Most Installed Extensions",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "barchart",
              "chartSettings": {
                "xAxis": "ExtensionName_s",
                "yAxis": [
                  "InstallCount"
                ],
                "showDataLabels": true,
                "ySettings": {
                  "isLogarithmic": false,
                  "min": 0
                }
              }
            },
            "customWidth": "50",
            "name": "TopExtensions"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "DevicesBrowserExtensionsInventory_CL\n| summarize DevicesWithExtensions = dcount(DeviceName_s) by d = bin(TimeGenerated, 1d)\n| order by d desc\n| take 30\n| render timechart",
              "size": 0,
              "title": "Device Extension Activity Trend (Last 30 Days)",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "linechart"
            },
            "name": "ExtensionTrend"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "DevicesBrowserExtensionsInventory_CL\n| where TimeGenerated >= ago(7d)\n| summarize \n    Devices = dcount(DeviceName_s),\n    UniqueExtensions = dcount(ExtensionID_s),\n    TotalInstallations = count(),\n    LastSeen = max(TimeGenerated)\n    by ExtensionName_s, Browser_s\n| order by TotalInstallations desc\n| project \n    ['Extension Name'] = ExtensionName_s,\n    Browser = Browser_s,\n    ['Devices'] = Devices,\n    ['Installations'] = TotalInstallations,\n    ['Last Seen'] = LastSeen",
              "size": 0,
              "title": "Detailed Extension Inventory (Last 7 Days)",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Devices",
                    "formatter": 4,
                    "formatOptions": {
                      "palette": "blue"
                    }
                  },
                  {
                    "columnMatch": "Installations",
                    "formatter": 4,
                    "formatOptions": {
                      "palette": "green"
                    }
                  },
                  {
                    "columnMatch": "Last Seen",
                    "formatter": 6
                  }
                ],
                "filter": true
              },
              "sortBy": []
            },
            "name": "DetailedExtensionInventory"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "DevicesBrowserExtensionsInventory_CL\n| where TimeGenerated >= ago(7d)\n| summarize \n    Extensions = dcount(ExtensionID_s),\n    TotalInstallations = count(),\n    LastActivity = max(TimeGenerated),\n    Browsers = make_set(Browser_s)\n    by DeviceName_s, Username_s\n| order by Extensions desc\n| project \n    ['Device Name'] = DeviceName_s,\n    ['Username'] = Username_s,\n    ['Extensions'] = Extensions,\n    ['Total Installations'] = TotalInstallations,\n    ['Browsers'] = Browsers,\n    ['Last Activity'] = LastActivity",
              "size": 0,
              "title": "Extensions by Device and User (Last 7 Days)",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Extensions",
                    "formatter": 4,
                    "formatOptions": {
                      "palette": "blue"
                    }
                  },
                  {
                    "columnMatch": "Total Installations",
                    "formatter": 4,
                    "formatOptions": {
                      "palette": "green"
                    }
                  },
                  {
                    "columnMatch": "Last Activity",
                    "formatter": 6
                  }
                ],
                "filter": true
              },
              "sortBy": []
            },
            "name": "ExtensionsByDevice"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "DevicesBrowserExtensionsInventory_CL\n| where TimeGenerated >= ago(7d)\n| extend SecurityCategory = case(\n    ExtensionName_s has \"ublock\" or ExtensionName_s has \"adblock\" or ExtensionName_s has \"adguard\", \"Ad Blocker\",\n    ExtensionName_s has \"lastpass\" or ExtensionName_s has \"1password\" or ExtensionName_s has \"bitwarden\" or ExtensionName_s has \"dashlane\", \"Password Manager\",\n    ExtensionName_s has \"antivirus\" or ExtensionName_s has \"security\" or ExtensionName_s has \"malware\", \"Security\",\n    ExtensionName_s has \"vpn\" or ExtensionName_s has \"proxy\", \"VPN/Proxy\",\n    ExtensionName_s has \"downloader\" or ExtensionName_s has \"torrent\", \"Downloader\",\n    \"Other\"\n)\n| summarize Count = count(), Devices = dcount(DeviceName_s) by SecurityCategory\n| order by Count desc",
              "size": 1,
              "title": "Extensions by Security Category",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Count",
                    "formatter": 4,
                    "formatOptions": {
                      "palette": "blue"
                    }
                  },
                  {
                    "columnMatch": "Devices",
                    "formatter": 4,
                    "formatOptions": {
                      "palette": "green"
                    }
                  }
                ]
              }
            },
            "customWidth": "50",
            "name": "SecurityCategories"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "DevicesBrowserExtensionsInventory_CL\n| where TimeGenerated >= ago(30d)\n| extend DaysOld = datetime_diff('day', now(), TimeGenerated)\n| summarize \n    UniqueExtensions = dcount(ExtensionID_s),\n    TotalInstallations = count()\n    by AgeGroup = case(\n        DaysOld <= 1, 'Last 24 hours',\n        DaysOld <= 7, 'Last week',\n        DaysOld <= 30, 'Last month',\n        'Older'\n    )\n| extend SortOrder = case(\n        AgeGroup == 'Last 24 hours', 1,\n        AgeGroup == 'Last week', 2,\n        AgeGroup == 'Last month', 3,\n        4\n    )\n| order by SortOrder asc\n| project-away SortOrder",
              "size": 1,
              "title": "Extension Data Freshness",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "UniqueExtensions",
                    "formatter": 4,
                    "formatOptions": {
                      "palette": "blue"
                    }
                  },
                  {
                    "columnMatch": "TotalInstallations",
                    "formatter": 4,
                    "formatOptions": {
                      "palette": "green"
                    }
                  }
                ]
              }
            },
            "customWidth": "50",
            "name": "DataFreshness"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "tab",
        "comparison": "isEqualTo",
        "value": "BrowserExtensions"
      },
      "name": "BrowserExtensionsGroup"
    }
  ],
  "fallbackResourceIds": [
    "/subscriptions/3f66ecfd-c011-4956-bcea-d431a322eb15/resourceGroups/csg-audit/providers/Microsoft.OperationalInsights/workspaces/csg-auditlogs"
  ],
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}